
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://altescy.github.io/formed/reference/integrations/ml/">
      
      
        <link rel="prev" href="../flax/">
      
      
        <link rel="next" href="../mlflow/">
      
      
        
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>ML - Formed</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.484c7ddc.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#ml" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Formed" class="md-header__button md-logo" aria-label="Formed" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Formed
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              ML
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/altescy/formed" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    altescy/formed
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../quick_start/" class="md-tabs__link">
        
  
  
    
  
  Quick Start

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../tutorials/" class="md-tabs__link">
          
  
  
  Tutorials

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../guides/" class="md-tabs__link">
          
  
  
  Guides

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../" class="md-tabs__link">
          
  
  
  API Reference

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Formed" class="md-nav__button md-logo" aria-label="Formed" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Formed
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/altescy/formed" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    altescy/formed
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../quick_start/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Quick Start
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Tutorials
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Tutorials
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tutorials/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tutorials/text_classification/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Text Classification
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tutorials/causal_lm_finetuning/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Causal LM Finetuning
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Guides
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Guides
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../guides/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../guides/workflow/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Workflow
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_3" >
        
          
          <label class="md-nav__link" for="__nav_4_3" id="__nav_4_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Integrations
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Integrations
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../guides/integrations/ml/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ML
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../guides/integrations/torch/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Torch
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" checked>
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    API Reference
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    API Reference
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../workflow/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Workflow
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_3" checked>
        
          
          <label class="md-nav__link" for="__nav_5_3" id="__nav_5_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Integrations
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Integrations
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../datasets/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Datasets
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../flax/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Flax
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    ML
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    ML
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#formed.integrations.ml.dataloader" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;dataloader
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" dataloader">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.dataloader.BaseBatchSampler" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;BaseBatchSampler
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.dataloader.BasicBatchSampler" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;BasicBatchSampler
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.dataloader.SizeOrderedBucketBatchSampler" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;SizeOrderedBucketBatchSampler
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.dataloader.BatchIterator" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;BatchIterator
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.dataloader.DataLoader" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;DataLoader
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;metrics
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" metrics">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.BaseMetric" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;BaseMetric
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" BaseMetric">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.BaseMetric.reset" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;reset
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.BaseMetric.update" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;update
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.BaseMetric.compute" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;compute
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.EmptyMetric" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;EmptyMetric
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" EmptyMetric">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.EmptyMetric.reset" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;reset
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.EmptyMetric.update" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;update
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.EmptyMetric.compute" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;compute
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.Average" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;Average
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" Average">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.Average.reset" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;reset
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.Average.update" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;update
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.Average.compute" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;compute
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.ClassificationInput" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;ClassificationInput
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" ClassificationInput">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.ClassificationInput.predictions" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;predictions
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.ClassificationInput.targets" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;targets
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.BinaryClassificationInput" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;BinaryClassificationInput
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" BinaryClassificationInput">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.BinaryClassificationInput.predictions" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;predictions
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.BinaryClassificationInput.targets" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;targets
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.BinaryClassificationInput.scores" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;scores
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.BinaryClassificationMetric" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;BinaryClassificationMetric
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" BinaryClassificationMetric">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.BinaryClassificationMetric.Input" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;Input
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.BinaryClassificationMetric.reset" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;reset
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.BinaryClassificationMetric.update" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;update
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.BinaryClassificationMetric.compute" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;compute
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.BinaryAccuracy" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;BinaryAccuracy
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" BinaryAccuracy">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.BinaryAccuracy.Input" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;Input
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.BinaryAccuracy.reset" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;reset
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.BinaryAccuracy.update" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;update
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.BinaryAccuracy.compute" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;compute
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.BinaryFBeta" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;BinaryFBeta
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" BinaryFBeta">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.BinaryFBeta.Input" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;Input
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.BinaryFBeta.reset" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;reset
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.BinaryFBeta.update" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;update
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.BinaryFBeta.compute" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;compute
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.BinaryROCAUC" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;BinaryROCAUC
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" BinaryROCAUC">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.BinaryROCAUC.Input" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;Input
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.BinaryROCAUC.reset" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;reset
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.BinaryROCAUC.update" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;update
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.BinaryROCAUC.compute" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;compute
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.BinaryPRAUC" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;BinaryPRAUC
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" BinaryPRAUC">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.BinaryPRAUC.Input" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;Input
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.BinaryPRAUC.reset" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;reset
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.BinaryPRAUC.update" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;update
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.BinaryPRAUC.compute" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;compute
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.MulticlassClassificationMetric" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;MulticlassClassificationMetric
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" MulticlassClassificationMetric">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.MulticlassClassificationMetric.Input" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;Input
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.MulticlassClassificationMetric.reset" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;reset
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.MulticlassClassificationMetric.update" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;update
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.MulticlassClassificationMetric.compute" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;compute
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.MulticlassAccuracy" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;MulticlassAccuracy
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" MulticlassAccuracy">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.MulticlassAccuracy.Input" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;Input
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.MulticlassAccuracy.reset" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;reset
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.MulticlassAccuracy.update" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;update
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.MulticlassAccuracy.compute" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;compute
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.MulticlassFBeta" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;MulticlassFBeta
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" MulticlassFBeta">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.MulticlassFBeta.Input" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;Input
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.MulticlassFBeta.reset" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;reset
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.MulticlassFBeta.update" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;update
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.MulticlassFBeta.compute" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;compute
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.MultilabelClassificationMetric" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;MultilabelClassificationMetric
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" MultilabelClassificationMetric">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.MultilabelClassificationMetric.Input" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;Input
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.MultilabelClassificationMetric.reset" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;reset
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.MultilabelClassificationMetric.update" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;update
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.MultilabelClassificationMetric.compute" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;compute
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.MultilabelAccuracy" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;MultilabelAccuracy
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" MultilabelAccuracy">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.MultilabelAccuracy.Input" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;Input
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.MultilabelAccuracy.reset" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;reset
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.MultilabelAccuracy.update" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;update
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.MultilabelAccuracy.compute" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;compute
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.MultilabelFBeta" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;MultilabelFBeta
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" MultilabelFBeta">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.MultilabelFBeta.Input" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;Input
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.MultilabelFBeta.reset" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;reset
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.MultilabelFBeta.update" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;update
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.MultilabelFBeta.compute" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;compute
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.RegressionInput" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;RegressionInput
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" RegressionInput">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.RegressionInput.predictions" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;predictions
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.RegressionInput.targets" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;targets
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.RegressionMetric" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;RegressionMetric
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" RegressionMetric">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.RegressionMetric.Input" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;Input
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.RegressionMetric.reset" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;reset
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.RegressionMetric.update" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;update
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.RegressionMetric.compute" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;compute
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.MeanSquaredError" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;MeanSquaredError
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" MeanSquaredError">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.MeanSquaredError.Input" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;Input
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.MeanSquaredError.reset" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;reset
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.MeanSquaredError.update" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;update
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.MeanSquaredError.compute" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;compute
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.MeanAbsoluteError" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;MeanAbsoluteError
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" MeanAbsoluteError">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.MeanAbsoluteError.Input" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;Input
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.MeanAbsoluteError.reset" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;reset
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.MeanAbsoluteError.update" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;update
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.MeanAbsoluteError.compute" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;compute
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.RankingInput" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;RankingInput
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" RankingInput">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.RankingInput.predictions" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;predictions
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.RankingInput.targets" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;targets
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.RankingMetric" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;RankingMetric
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" RankingMetric">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.RankingMetric.Input" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;Input
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.RankingMetric.reset" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;reset
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.RankingMetric.update" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;update
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.RankingMetric.compute" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;compute
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.MeanAveragePrecision" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;MeanAveragePrecision
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" MeanAveragePrecision">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.MeanAveragePrecision.Input" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;Input
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.MeanAveragePrecision.reset" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;reset
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.MeanAveragePrecision.update" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;update
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.MeanAveragePrecision.compute" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;compute
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.NDCG" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;NDCG
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" NDCG">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.NDCG.Input" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;Input
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.NDCG.reset" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;reset
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.NDCG.update" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;update
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.NDCG.compute" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;compute
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.base" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;base
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" base">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.base.logger" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;logger
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.base.Extra" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;Extra
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" Extra">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.base.Extra.default" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;default
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.base.Extra.default_factory" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;default_factory
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.base.Param" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;Param
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" Param">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.base.Param.default" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;default
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.base.Param.cast" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;cast
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.base.Param.default_factory" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;default_factory
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.base.BaseTransformMeta" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;BaseTransformMeta
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.base.BaseTransform" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;BaseTransform
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" BaseTransform">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.base.BaseTransform.accessor" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;accessor
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.base.BaseTransform.instance" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;instance
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.base.BaseTransform.batch" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;batch
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.base.BaseTransform.train" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;train
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.base.BaseTransform.save" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;save
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.base.BaseTransform.load" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;load
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.base.DataModule" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;DataModule
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" DataModule">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.base.DataModule.accessor" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;accessor
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.base.DataModule.train" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;train
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.base.DataModule.instance" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;instance
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.base.DataModule.batch" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;batch
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.base.DataModule.save" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;save
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.base.DataModule.load" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;load
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.base.register_dataclass" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;register_dataclass
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.basic" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;basic
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" basic">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.basic.logger" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;logger
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.basic.MetadataTransform" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;MetadataTransform
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" MetadataTransform">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.basic.MetadataTransform.accessor" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;accessor
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.basic.MetadataTransform.instance" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;instance
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.basic.MetadataTransform.batch" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;batch
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.basic.MetadataTransform.train" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;train
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.basic.MetadataTransform.save" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;save
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.basic.MetadataTransform.load" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;load
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.basic.LabelIndexer" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;LabelIndexer
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" LabelIndexer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.basic.LabelIndexer.label2id" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;label2id
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.basic.LabelIndexer.freeze" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;freeze
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.basic.LabelIndexer.num_labels" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;num_labels
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.basic.LabelIndexer.labels" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;labels
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.basic.LabelIndexer.occurrences" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;occurrences
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.basic.LabelIndexer.distribution" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;distribution
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.basic.LabelIndexer.accessor" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;accessor
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.basic.LabelIndexer.get_index" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_index
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.basic.LabelIndexer.get_value" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_value
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.basic.LabelIndexer.ingest" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;ingest
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.basic.LabelIndexer.instance" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;instance
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.basic.LabelIndexer.batch" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;batch
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.basic.LabelIndexer.reconstruct" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;reconstruct
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.basic.LabelIndexer.train" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;train
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.basic.LabelIndexer.save" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;save
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.basic.LabelIndexer.load" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;load
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.basic.ScalarTransform" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;ScalarTransform
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" ScalarTransform">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.basic.ScalarTransform.accessor" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;accessor
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.basic.ScalarTransform.instance" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;instance
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.basic.ScalarTransform.batch" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;batch
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.basic.ScalarTransform.train" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;train
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.basic.ScalarTransform.save" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;save
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.basic.ScalarTransform.load" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;load
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.basic.TensorTransform" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;TensorTransform
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" TensorTransform">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.basic.TensorTransform.accessor" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;accessor
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.basic.TensorTransform.instance" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;instance
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.basic.TensorTransform.batch" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;batch
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.basic.TensorTransform.train" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;train
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.basic.TensorTransform.save" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;save
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.basic.TensorTransform.load" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;load
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.basic.VariableTensorTransform" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;VariableTensorTransform
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" VariableTensorTransform">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.basic.VariableTensorTransform.accessor" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;accessor
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.basic.VariableTensorTransform.instance" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;instance
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.basic.VariableTensorTransform.batch" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;batch
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.basic.VariableTensorTransform.train" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;train
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.basic.VariableTensorTransform.save" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;save
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.basic.VariableTensorTransform.load" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;load
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.basic.TensorSequenceTransform" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;TensorSequenceTransform
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" TensorSequenceTransform">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.basic.TensorSequenceTransform.accessor" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;accessor
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.basic.TensorSequenceTransform.instance" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;instance
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.basic.TensorSequenceTransform.batch" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;batch
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.basic.TensorSequenceTransform.train" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;train
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.basic.TensorSequenceTransform.save" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;save
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.basic.TensorSequenceTransform.load" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;load
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.nlp" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;nlp
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" nlp">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.nlp.logger" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;logger
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.nlp.TokenSequenceIndexer" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;TokenSequenceIndexer
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" TokenSequenceIndexer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.nlp.TokenSequenceIndexer.vocab" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;vocab
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.nlp.TokenSequenceIndexer.pad_token" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;pad_token
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.nlp.TokenSequenceIndexer.unk_token" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;unk_token
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.nlp.TokenSequenceIndexer.bos_token" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;bos_token
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.nlp.TokenSequenceIndexer.eos_token" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;eos_token
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.nlp.TokenSequenceIndexer.min_df" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;min_df
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.nlp.TokenSequenceIndexer.max_df" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;max_df
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.nlp.TokenSequenceIndexer.max_vocab_size" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;max_vocab_size
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.nlp.TokenSequenceIndexer.freeze" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;freeze
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.nlp.TokenSequenceIndexer.pad_index" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;pad_index
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.nlp.TokenSequenceIndexer.unk_index" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;unk_index
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.nlp.TokenSequenceIndexer.bos_index" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;bos_index
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.nlp.TokenSequenceIndexer.eos_index" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;eos_index
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.nlp.TokenSequenceIndexer.vocab_size" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;vocab_size
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.nlp.TokenSequenceIndexer.accessor" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;accessor
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.nlp.TokenSequenceIndexer.get_index" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_index
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.nlp.TokenSequenceIndexer.get_value" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_value
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.nlp.TokenSequenceIndexer.ingest" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;ingest
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.nlp.TokenSequenceIndexer.instance" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;instance
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.nlp.TokenSequenceIndexer.batch" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;batch
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.nlp.TokenSequenceIndexer.reconstruct" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;reconstruct
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.nlp.TokenSequenceIndexer.train" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;train
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.nlp.TokenSequenceIndexer.save" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;save
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.nlp.TokenSequenceIndexer.load" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;load
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.nlp.TokenCharactersIndexer" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;TokenCharactersIndexer
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" TokenCharactersIndexer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.nlp.TokenCharactersIndexer.min_characters" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;min_characters
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.nlp.TokenCharactersIndexer.accessor" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;accessor
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.nlp.TokenCharactersIndexer.vocab" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;vocab
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.nlp.TokenCharactersIndexer.pad_token" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;pad_token
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.nlp.TokenCharactersIndexer.unk_token" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;unk_token
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.nlp.TokenCharactersIndexer.bos_token" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;bos_token
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.nlp.TokenCharactersIndexer.eos_token" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;eos_token
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.nlp.TokenCharactersIndexer.min_df" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;min_df
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.nlp.TokenCharactersIndexer.max_df" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;max_df
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.nlp.TokenCharactersIndexer.max_vocab_size" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;max_vocab_size
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.nlp.TokenCharactersIndexer.freeze" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;freeze
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.nlp.TokenCharactersIndexer.pad_index" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;pad_index
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.nlp.TokenCharactersIndexer.unk_index" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;unk_index
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.nlp.TokenCharactersIndexer.bos_index" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;bos_index
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.nlp.TokenCharactersIndexer.eos_index" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;eos_index
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.nlp.TokenCharactersIndexer.vocab_size" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;vocab_size
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.nlp.TokenCharactersIndexer.ingest" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;ingest
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.nlp.TokenCharactersIndexer.batch" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;batch
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.nlp.TokenCharactersIndexer.reconstruct" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;reconstruct
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.nlp.TokenCharactersIndexer.instance" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;instance
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.nlp.TokenCharactersIndexer.train" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;train
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.nlp.TokenCharactersIndexer.save" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;save
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.nlp.TokenCharactersIndexer.load" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;load
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.nlp.TokenCharactersIndexer.get_index" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_index
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.nlp.TokenCharactersIndexer.get_value" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_value
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.nlp.Tokenizer" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;Tokenizer
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" Tokenizer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.nlp.Tokenizer.surfaces" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;surfaces
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.nlp.Tokenizer.postags" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;postags
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.nlp.Tokenizer.characters" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;characters
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.nlp.Tokenizer.text_vector" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;text_vector
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.nlp.Tokenizer.token_vectors" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;token_vectors
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.nlp.Tokenizer.analyzer" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;analyzer
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.nlp.Tokenizer.accessor" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;accessor
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.nlp.Tokenizer.instance" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;instance
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.nlp.Tokenizer.batch" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;batch
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.nlp.Tokenizer.train" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;train
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.nlp.Tokenizer.save" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;save
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.nlp.Tokenizer.load" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;load
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#formed.integrations.ml.workflow" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;workflow
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" workflow">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.workflow.DataModuleAndInstances" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;DataModuleAndInstances
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" DataModuleAndInstances">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.workflow.DataModuleAndInstances.datamodule" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;datamodule
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.workflow.DataModuleAndInstances.instances" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;instances
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.workflow.DataModuleAndInstancesFormat" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;DataModuleAndInstancesFormat
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" DataModuleAndInstancesFormat">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.workflow.DataModuleAndInstancesFormat.identifier" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;identifier
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.workflow.DataModuleAndInstancesFormat.write" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;write
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.workflow.DataModuleAndInstancesFormat.read" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;read
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.workflow.DataModuleAndInstancesFormat.is_default_of" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;is_default_of
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.workflow.train_datamodule" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;train_datamodule
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.workflow.train_datamodule_with_instances" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;train_datamodule_with_instances
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.workflow.generate_instances" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;generate_instances
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mlflow/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    MLflow
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sentence_transformers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    SentenceTransformers
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../torch/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Torch
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../transformers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Transformers
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#formed.integrations.ml.dataloader" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;dataloader
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" dataloader">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.dataloader.BaseBatchSampler" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;BaseBatchSampler
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.dataloader.BasicBatchSampler" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;BasicBatchSampler
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.dataloader.SizeOrderedBucketBatchSampler" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;SizeOrderedBucketBatchSampler
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.dataloader.BatchIterator" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;BatchIterator
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.dataloader.DataLoader" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;DataLoader
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;metrics
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" metrics">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.BaseMetric" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;BaseMetric
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" BaseMetric">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.BaseMetric.reset" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;reset
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.BaseMetric.update" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;update
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.BaseMetric.compute" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;compute
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.EmptyMetric" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;EmptyMetric
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" EmptyMetric">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.EmptyMetric.reset" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;reset
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.EmptyMetric.update" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;update
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.EmptyMetric.compute" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;compute
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.Average" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;Average
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" Average">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.Average.reset" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;reset
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.Average.update" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;update
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.Average.compute" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;compute
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.ClassificationInput" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;ClassificationInput
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" ClassificationInput">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.ClassificationInput.predictions" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;predictions
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.ClassificationInput.targets" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;targets
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.BinaryClassificationInput" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;BinaryClassificationInput
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" BinaryClassificationInput">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.BinaryClassificationInput.predictions" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;predictions
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.BinaryClassificationInput.targets" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;targets
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.BinaryClassificationInput.scores" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;scores
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.BinaryClassificationMetric" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;BinaryClassificationMetric
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" BinaryClassificationMetric">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.BinaryClassificationMetric.Input" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;Input
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.BinaryClassificationMetric.reset" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;reset
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.BinaryClassificationMetric.update" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;update
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.BinaryClassificationMetric.compute" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;compute
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.BinaryAccuracy" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;BinaryAccuracy
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" BinaryAccuracy">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.BinaryAccuracy.Input" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;Input
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.BinaryAccuracy.reset" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;reset
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.BinaryAccuracy.update" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;update
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.BinaryAccuracy.compute" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;compute
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.BinaryFBeta" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;BinaryFBeta
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" BinaryFBeta">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.BinaryFBeta.Input" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;Input
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.BinaryFBeta.reset" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;reset
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.BinaryFBeta.update" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;update
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.BinaryFBeta.compute" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;compute
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.BinaryROCAUC" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;BinaryROCAUC
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" BinaryROCAUC">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.BinaryROCAUC.Input" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;Input
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.BinaryROCAUC.reset" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;reset
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.BinaryROCAUC.update" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;update
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.BinaryROCAUC.compute" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;compute
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.BinaryPRAUC" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;BinaryPRAUC
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" BinaryPRAUC">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.BinaryPRAUC.Input" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;Input
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.BinaryPRAUC.reset" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;reset
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.BinaryPRAUC.update" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;update
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.BinaryPRAUC.compute" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;compute
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.MulticlassClassificationMetric" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;MulticlassClassificationMetric
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" MulticlassClassificationMetric">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.MulticlassClassificationMetric.Input" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;Input
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.MulticlassClassificationMetric.reset" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;reset
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.MulticlassClassificationMetric.update" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;update
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.MulticlassClassificationMetric.compute" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;compute
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.MulticlassAccuracy" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;MulticlassAccuracy
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" MulticlassAccuracy">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.MulticlassAccuracy.Input" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;Input
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.MulticlassAccuracy.reset" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;reset
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.MulticlassAccuracy.update" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;update
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.MulticlassAccuracy.compute" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;compute
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.MulticlassFBeta" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;MulticlassFBeta
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" MulticlassFBeta">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.MulticlassFBeta.Input" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;Input
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.MulticlassFBeta.reset" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;reset
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.MulticlassFBeta.update" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;update
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.MulticlassFBeta.compute" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;compute
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.MultilabelClassificationMetric" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;MultilabelClassificationMetric
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" MultilabelClassificationMetric">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.MultilabelClassificationMetric.Input" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;Input
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.MultilabelClassificationMetric.reset" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;reset
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.MultilabelClassificationMetric.update" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;update
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.MultilabelClassificationMetric.compute" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;compute
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.MultilabelAccuracy" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;MultilabelAccuracy
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" MultilabelAccuracy">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.MultilabelAccuracy.Input" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;Input
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.MultilabelAccuracy.reset" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;reset
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.MultilabelAccuracy.update" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;update
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.MultilabelAccuracy.compute" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;compute
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.MultilabelFBeta" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;MultilabelFBeta
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" MultilabelFBeta">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.MultilabelFBeta.Input" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;Input
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.MultilabelFBeta.reset" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;reset
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.MultilabelFBeta.update" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;update
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.MultilabelFBeta.compute" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;compute
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.RegressionInput" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;RegressionInput
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" RegressionInput">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.RegressionInput.predictions" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;predictions
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.RegressionInput.targets" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;targets
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.RegressionMetric" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;RegressionMetric
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" RegressionMetric">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.RegressionMetric.Input" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;Input
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.RegressionMetric.reset" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;reset
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.RegressionMetric.update" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;update
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.RegressionMetric.compute" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;compute
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.MeanSquaredError" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;MeanSquaredError
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" MeanSquaredError">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.MeanSquaredError.Input" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;Input
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.MeanSquaredError.reset" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;reset
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.MeanSquaredError.update" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;update
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.MeanSquaredError.compute" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;compute
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.MeanAbsoluteError" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;MeanAbsoluteError
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" MeanAbsoluteError">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.MeanAbsoluteError.Input" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;Input
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.MeanAbsoluteError.reset" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;reset
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.MeanAbsoluteError.update" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;update
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.MeanAbsoluteError.compute" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;compute
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.RankingInput" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;RankingInput
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" RankingInput">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.RankingInput.predictions" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;predictions
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.RankingInput.targets" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;targets
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.RankingMetric" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;RankingMetric
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" RankingMetric">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.RankingMetric.Input" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;Input
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.RankingMetric.reset" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;reset
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.RankingMetric.update" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;update
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.RankingMetric.compute" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;compute
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.MeanAveragePrecision" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;MeanAveragePrecision
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" MeanAveragePrecision">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.MeanAveragePrecision.Input" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;Input
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.MeanAveragePrecision.reset" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;reset
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.MeanAveragePrecision.update" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;update
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.MeanAveragePrecision.compute" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;compute
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.NDCG" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;NDCG
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" NDCG">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.NDCG.Input" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;Input
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.NDCG.reset" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;reset
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.NDCG.update" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;update
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.metrics.NDCG.compute" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;compute
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.base" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;base
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" base">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.base.logger" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;logger
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.base.Extra" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;Extra
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" Extra">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.base.Extra.default" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;default
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.base.Extra.default_factory" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;default_factory
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.base.Param" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;Param
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" Param">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.base.Param.default" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;default
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.base.Param.cast" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;cast
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.base.Param.default_factory" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;default_factory
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.base.BaseTransformMeta" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;BaseTransformMeta
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.base.BaseTransform" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;BaseTransform
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" BaseTransform">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.base.BaseTransform.accessor" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;accessor
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.base.BaseTransform.instance" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;instance
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.base.BaseTransform.batch" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;batch
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.base.BaseTransform.train" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;train
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.base.BaseTransform.save" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;save
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.base.BaseTransform.load" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;load
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.base.DataModule" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;DataModule
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" DataModule">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.base.DataModule.accessor" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;accessor
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.base.DataModule.train" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;train
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.base.DataModule.instance" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;instance
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.base.DataModule.batch" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;batch
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.base.DataModule.save" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;save
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.base.DataModule.load" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;load
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.base.register_dataclass" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;register_dataclass
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.basic" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;basic
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" basic">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.basic.logger" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;logger
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.basic.MetadataTransform" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;MetadataTransform
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" MetadataTransform">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.basic.MetadataTransform.accessor" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;accessor
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.basic.MetadataTransform.instance" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;instance
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.basic.MetadataTransform.batch" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;batch
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.basic.MetadataTransform.train" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;train
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.basic.MetadataTransform.save" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;save
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.basic.MetadataTransform.load" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;load
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.basic.LabelIndexer" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;LabelIndexer
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" LabelIndexer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.basic.LabelIndexer.label2id" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;label2id
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.basic.LabelIndexer.freeze" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;freeze
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.basic.LabelIndexer.num_labels" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;num_labels
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.basic.LabelIndexer.labels" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;labels
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.basic.LabelIndexer.occurrences" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;occurrences
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.basic.LabelIndexer.distribution" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;distribution
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.basic.LabelIndexer.accessor" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;accessor
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.basic.LabelIndexer.get_index" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_index
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.basic.LabelIndexer.get_value" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_value
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.basic.LabelIndexer.ingest" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;ingest
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.basic.LabelIndexer.instance" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;instance
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.basic.LabelIndexer.batch" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;batch
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.basic.LabelIndexer.reconstruct" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;reconstruct
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.basic.LabelIndexer.train" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;train
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.basic.LabelIndexer.save" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;save
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.basic.LabelIndexer.load" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;load
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.basic.ScalarTransform" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;ScalarTransform
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" ScalarTransform">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.basic.ScalarTransform.accessor" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;accessor
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.basic.ScalarTransform.instance" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;instance
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.basic.ScalarTransform.batch" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;batch
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.basic.ScalarTransform.train" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;train
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.basic.ScalarTransform.save" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;save
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.basic.ScalarTransform.load" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;load
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.basic.TensorTransform" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;TensorTransform
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" TensorTransform">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.basic.TensorTransform.accessor" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;accessor
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.basic.TensorTransform.instance" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;instance
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.basic.TensorTransform.batch" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;batch
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.basic.TensorTransform.train" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;train
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.basic.TensorTransform.save" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;save
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.basic.TensorTransform.load" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;load
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.basic.VariableTensorTransform" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;VariableTensorTransform
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" VariableTensorTransform">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.basic.VariableTensorTransform.accessor" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;accessor
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.basic.VariableTensorTransform.instance" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;instance
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.basic.VariableTensorTransform.batch" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;batch
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.basic.VariableTensorTransform.train" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;train
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.basic.VariableTensorTransform.save" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;save
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.basic.VariableTensorTransform.load" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;load
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.basic.TensorSequenceTransform" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;TensorSequenceTransform
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" TensorSequenceTransform">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.basic.TensorSequenceTransform.accessor" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;accessor
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.basic.TensorSequenceTransform.instance" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;instance
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.basic.TensorSequenceTransform.batch" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;batch
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.basic.TensorSequenceTransform.train" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;train
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.basic.TensorSequenceTransform.save" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;save
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.basic.TensorSequenceTransform.load" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;load
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.nlp" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;nlp
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" nlp">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.nlp.logger" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;logger
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.nlp.TokenSequenceIndexer" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;TokenSequenceIndexer
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" TokenSequenceIndexer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.nlp.TokenSequenceIndexer.vocab" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;vocab
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.nlp.TokenSequenceIndexer.pad_token" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;pad_token
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.nlp.TokenSequenceIndexer.unk_token" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;unk_token
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.nlp.TokenSequenceIndexer.bos_token" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;bos_token
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.nlp.TokenSequenceIndexer.eos_token" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;eos_token
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.nlp.TokenSequenceIndexer.min_df" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;min_df
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.nlp.TokenSequenceIndexer.max_df" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;max_df
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.nlp.TokenSequenceIndexer.max_vocab_size" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;max_vocab_size
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.nlp.TokenSequenceIndexer.freeze" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;freeze
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.nlp.TokenSequenceIndexer.pad_index" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;pad_index
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.nlp.TokenSequenceIndexer.unk_index" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;unk_index
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.nlp.TokenSequenceIndexer.bos_index" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;bos_index
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.nlp.TokenSequenceIndexer.eos_index" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;eos_index
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.nlp.TokenSequenceIndexer.vocab_size" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;vocab_size
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.nlp.TokenSequenceIndexer.accessor" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;accessor
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.nlp.TokenSequenceIndexer.get_index" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_index
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.nlp.TokenSequenceIndexer.get_value" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_value
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.nlp.TokenSequenceIndexer.ingest" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;ingest
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.nlp.TokenSequenceIndexer.instance" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;instance
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.nlp.TokenSequenceIndexer.batch" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;batch
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.nlp.TokenSequenceIndexer.reconstruct" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;reconstruct
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.nlp.TokenSequenceIndexer.train" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;train
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.nlp.TokenSequenceIndexer.save" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;save
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.nlp.TokenSequenceIndexer.load" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;load
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.nlp.TokenCharactersIndexer" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;TokenCharactersIndexer
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" TokenCharactersIndexer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.nlp.TokenCharactersIndexer.min_characters" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;min_characters
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.nlp.TokenCharactersIndexer.accessor" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;accessor
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.nlp.TokenCharactersIndexer.vocab" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;vocab
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.nlp.TokenCharactersIndexer.pad_token" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;pad_token
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.nlp.TokenCharactersIndexer.unk_token" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;unk_token
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.nlp.TokenCharactersIndexer.bos_token" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;bos_token
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.nlp.TokenCharactersIndexer.eos_token" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;eos_token
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.nlp.TokenCharactersIndexer.min_df" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;min_df
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.nlp.TokenCharactersIndexer.max_df" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;max_df
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.nlp.TokenCharactersIndexer.max_vocab_size" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;max_vocab_size
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.nlp.TokenCharactersIndexer.freeze" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;freeze
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.nlp.TokenCharactersIndexer.pad_index" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;pad_index
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.nlp.TokenCharactersIndexer.unk_index" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;unk_index
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.nlp.TokenCharactersIndexer.bos_index" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;bos_index
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.nlp.TokenCharactersIndexer.eos_index" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;eos_index
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.nlp.TokenCharactersIndexer.vocab_size" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;vocab_size
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.nlp.TokenCharactersIndexer.ingest" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;ingest
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.nlp.TokenCharactersIndexer.batch" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;batch
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.nlp.TokenCharactersIndexer.reconstruct" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;reconstruct
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.nlp.TokenCharactersIndexer.instance" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;instance
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.nlp.TokenCharactersIndexer.train" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;train
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.nlp.TokenCharactersIndexer.save" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;save
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.nlp.TokenCharactersIndexer.load" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;load
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.nlp.TokenCharactersIndexer.get_index" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_index
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.nlp.TokenCharactersIndexer.get_value" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_value
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.nlp.Tokenizer" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;Tokenizer
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" Tokenizer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.nlp.Tokenizer.surfaces" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;surfaces
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.nlp.Tokenizer.postags" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;postags
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.nlp.Tokenizer.characters" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;characters
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.nlp.Tokenizer.text_vector" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;text_vector
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.nlp.Tokenizer.token_vectors" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;token_vectors
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.nlp.Tokenizer.analyzer" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;analyzer
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.nlp.Tokenizer.accessor" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;accessor
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.nlp.Tokenizer.instance" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;instance
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.nlp.Tokenizer.batch" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;batch
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.nlp.Tokenizer.train" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;train
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.nlp.Tokenizer.save" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;save
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.transforms.nlp.Tokenizer.load" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;load
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#formed.integrations.ml.workflow" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;workflow
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" workflow">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.workflow.DataModuleAndInstances" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;DataModuleAndInstances
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" DataModuleAndInstances">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.workflow.DataModuleAndInstances.datamodule" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;datamodule
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.workflow.DataModuleAndInstances.instances" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;instances
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.workflow.DataModuleAndInstancesFormat" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;DataModuleAndInstancesFormat
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" DataModuleAndInstancesFormat">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.workflow.DataModuleAndInstancesFormat.identifier" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;identifier
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.workflow.DataModuleAndInstancesFormat.write" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;write
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.workflow.DataModuleAndInstancesFormat.read" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;read
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.workflow.DataModuleAndInstancesFormat.is_default_of" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;is_default_of
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.workflow.train_datamodule" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;train_datamodule
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.workflow.train_datamodule_with_instances" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;train_datamodule_with_instances
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formed.integrations.ml.workflow.generate_instances" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;generate_instances
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="ml">ML<a class="headerlink" data-preview="" href="#ml" title="Permanent link">&para;</a></h1>
<ul>
<li><a data-preview="" href="#formed.integrations.ml.dataloader">DataLoader</a></li>
<li><a data-preview="" href="#formed.integrations.ml.metrics">Metrics</a></li>
<li>Transforms<ul>
<li><a data-preview="" href="#formed.integrations.ml.transforms.base">Base</a></li>
<li><a data-preview="" href="#formed.integrations.ml.transforms.basic">Basic</a></li>
<li><a data-preview="" href="#formed.integrations.ml.transforms.nlp">NLP</a></li>
</ul>
</li>
<li><a data-preview="" href="#formed.integrations.ml.workflow">Workflow</a></li>
</ul>


<div class="doc doc-object doc-module">



<h2 id="formed.integrations.ml.dataloader" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">formed.integrations.ml.dataloader</span>


<a href="#formed.integrations.ml.dataloader" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents first">










<div class="doc doc-children">









<div class="doc doc-object doc-class">



<h3 id="formed.integrations.ml.dataloader.BaseBatchSampler" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">BaseBatchSampler</span>


<a href="#formed.integrations.ml.dataloader.BaseBatchSampler" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="colt.Registrable">Registrable</span></code>, <code><span title="abc.ABC">ABC</span></code>, <code><span title="typing.Generic">Generic</span>[<span title="formed.integrations.ml.dataloader._InputT">_InputT</span>]</code></p>



        <p>Abstract base class for batch samplers.</p>
<p>Batch samplers generate sequences of indices for batching data.</p>











<div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="formed.integrations.ml.dataloader.BasicBatchSampler" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">BasicBatchSampler</span>


<a href="#formed.integrations.ml.dataloader.BasicBatchSampler" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">BasicBatchSampler</span><span class="p">(</span>
</span><span id="__span-0-2">    <span class="n">batch_size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">drop_last</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">0</span>
</span><span id="__span-0-3"><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;BaseBatchSampler&lt;/span&gt; (&lt;code&gt;formed.integrations.ml.dataloader.BaseBatchSampler&lt;/code&gt;)" href="#formed.integrations.ml.dataloader.BaseBatchSampler">BaseBatchSampler</a>[<span title="formed.integrations.ml.dataloader._InputT">_InputT</span>]</code>, <code><span title="typing.Generic">Generic</span>[<span title="formed.integrations.ml.dataloader._InputT">_InputT</span>]</code></p>



        <p>Basic batch sampler that supports shuffling and dropping incomplete batches.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>batch_size</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Number of samples per batch. Defaults to 1.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="int">int</span></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>1</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>shuffle</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Whether to shuffle the data before batching. Defaults to False.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="bool">bool</span></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>False</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>drop_last</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Whether to drop the last incomplete batch. Defaults to False.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="bool">bool</span></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>False</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>seed</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Random seed for shuffling. Defaults to 0.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="int">int</span></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>0</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span id="__span-0-1"><span class="gp">&gt;&gt;&gt; </span><span class="n">sampler</span> <span class="o">=</span> <span class="n">BasicBatchSampler</span><span class="p">(</span><span class="n">batch_size</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-0-2"><span class="gp">&gt;&gt;&gt; </span><span class="n">dataset</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">))</span>
</span><span id="__span-0-3"><span class="gp">&gt;&gt;&gt; </span><span class="n">batches</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">sampler</span><span class="p">(</span><span class="n">dataset</span><span class="p">))</span>
</span><span id="__span-0-4"><span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">batches</span><span class="p">)</span>
</span><span id="__span-0-5"><span class="go">4</span>
</span></code></pre></div>








                  <details class="mkdocstrings-source">
                    <summary>Source code in <code>src/formed/integrations/ml/dataloader.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-55"><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="__span-0-56">    <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-57">    <span class="n">batch_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
</span><span id="__span-0-58">    <span class="n">shuffle</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="__span-0-59">    <span class="n">drop_last</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="__span-0-60">    <span class="n">seed</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
</span><span id="__span-0-61"><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-62">    <span class="bp">self</span><span class="o">.</span><span class="n">_batch_size</span> <span class="o">=</span> <span class="n">batch_size</span>
</span><span id="__span-0-63">    <span class="bp">self</span><span class="o">.</span><span class="n">_shuffle</span> <span class="o">=</span> <span class="n">shuffle</span>
</span><span id="__span-0-64">    <span class="bp">self</span><span class="o">.</span><span class="n">_drop_last</span> <span class="o">=</span> <span class="n">drop_last</span>
</span><span id="__span-0-65">    <span class="bp">self</span><span class="o">.</span><span class="n">_rng</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">Random</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
                  </details>



<div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="formed.integrations.ml.dataloader.SizeOrderedBucketBatchSampler" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">SizeOrderedBucketBatchSampler</span>


<a href="#formed.integrations.ml.dataloader.SizeOrderedBucketBatchSampler" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">SizeOrderedBucketBatchSampler</span><span class="p">(</span>
</span><span id="__span-0-2">    <span class="n">attribute</span><span class="p">,</span>
</span><span id="__span-0-3">    <span class="n">batch_size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="__span-0-4">    <span class="n">shuffle</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="__span-0-5">    <span class="n">drop_last</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="__span-0-6">    <span class="n">seed</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="__span-0-7"><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;BaseBatchSampler&lt;/span&gt; (&lt;code&gt;formed.integrations.ml.dataloader.BaseBatchSampler&lt;/code&gt;)" href="#formed.integrations.ml.dataloader.BaseBatchSampler">BaseBatchSampler</a>[<span title="formed.integrations.ml.dataloader._InputT">_InputT</span>]</code>, <code><span title="typing.Generic">Generic</span>[<span title="formed.integrations.ml.dataloader._InputT">_InputT</span>]</code></p>



        <p>Batch sampler that orders data by size before batching.</p>
<p>This sampler sorts the dataset based on a specified size attribute,
then creates batches of a given size. It can optionally shuffle the
batches after creation.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>attribute</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Attribute name or callable to determine the size of each item.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="str">str</span> | <span title="collections.abc.Callable">Callable</span>[[<span title="formed.integrations.ml.dataloader._InputT">_InputT</span>], <span title="collections.abc.Sized">Sized</span>]</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>batch_size</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Number of samples per batch. Defaults to 1.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="int">int</span></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>1</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>shuffle</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Whether to shuffle the batches after creation. Defaults to False.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="bool">bool</span></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>False</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>drop_last</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Whether to drop the last incomplete batch. Defaults to False.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="bool">bool</span></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>False</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>seed</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Random seed for shuffling. Defaults to 0.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="int">int</span></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>0</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span id="__span-0-1"><span class="gp">&gt;&gt;&gt; </span><span class="n">sampler</span> <span class="o">=</span> <span class="n">SizeOrderedBatchSampler</span><span class="p">(</span><span class="n">size_attr</span><span class="o">=</span><span class="s2">&quot;length&quot;</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-0-2"><span class="gp">&gt;&gt;&gt; </span><span class="n">dataset</span> <span class="o">=</span> <span class="p">[{</span><span class="s2">&quot;length&quot;</span><span class="p">:</span> <span class="n">i</span><span class="p">}</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">)]</span>
</span><span id="__span-0-3"><span class="gp">&gt;&gt;&gt; </span><span class="n">batches</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">sampler</span><span class="p">(</span><span class="n">dataset</span><span class="p">))</span>
</span><span id="__span-0-4"><span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">batches</span><span class="p">)</span>
</span><span id="__span-0-5"><span class="go">7</span>
</span></code></pre></div>








                  <details class="mkdocstrings-source">
                    <summary>Source code in <code>src/formed/integrations/ml/dataloader.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-115"><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="__span-0-116">    <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-117">    <span class="n">attribute</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">_InputT</span><span class="p">],</span> <span class="n">Sized</span><span class="p">],</span>
</span><span id="__span-0-118">    <span class="n">batch_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
</span><span id="__span-0-119">    <span class="n">shuffle</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="__span-0-120">    <span class="n">drop_last</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="__span-0-121">    <span class="n">seed</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
</span><span id="__span-0-122"><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-123">    <span class="bp">self</span><span class="o">.</span><span class="n">_attribute</span> <span class="o">=</span> <span class="n">attribute</span> <span class="k">if</span> <span class="nb">callable</span><span class="p">(</span><span class="n">attribute</span><span class="p">)</span> <span class="k">else</span> <span class="n">partial</span><span class="p">(</span><span class="n">xgetattr</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">attribute</span><span class="p">)</span>
</span><span id="__span-0-124">    <span class="bp">self</span><span class="o">.</span><span class="n">_batch_size</span> <span class="o">=</span> <span class="n">batch_size</span>
</span><span id="__span-0-125">    <span class="bp">self</span><span class="o">.</span><span class="n">_shuffle</span> <span class="o">=</span> <span class="n">shuffle</span>
</span><span id="__span-0-126">    <span class="bp">self</span><span class="o">.</span><span class="n">_drop_last</span> <span class="o">=</span> <span class="n">drop_last</span>
</span><span id="__span-0-127">    <span class="bp">self</span><span class="o">.</span><span class="n">_rng</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">Random</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
                  </details>



<div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="formed.integrations.ml.dataloader.BatchIterator" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">BatchIterator</span>


<a href="#formed.integrations.ml.dataloader.BatchIterator" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">BatchIterator</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">sampler</span><span class="p">,</span> <span class="n">collator</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="typing.Generic">Generic</span>[<span title="formed.integrations.ml.dataloader._InputT">_InputT</span>, <span title="formed.integrations.ml.dataloader._BatchT">_BatchT</span>]</code></p>



        <p>Iterator that generates batches from a dataset using a sampler and collator.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>data</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The dataset to iterate over.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="collections.abc.Sequence">Sequence</span>[<span title="formed.integrations.ml.dataloader._InputT">_InputT</span>]</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>sampler</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Batch sampler that generates batch indices.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;BaseBatchSampler&lt;/span&gt; (&lt;code&gt;formed.integrations.ml.dataloader.BaseBatchSampler&lt;/code&gt;)" href="#formed.integrations.ml.dataloader.BaseBatchSampler">BaseBatchSampler</a></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>collator</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Function that collates a sequence of items into a batch.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="collections.abc.Callable">Callable</span>[[<span title="collections.abc.Sequence">Sequence</span>[<span title="formed.integrations.ml.dataloader._InputT">_InputT</span>]], <span title="formed.integrations.ml.dataloader._BatchT">_BatchT</span>]</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span id="__span-0-1"><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span><span class="w"> </span><span class="nf">collator</span><span class="p">(</span><span class="n">batch</span><span class="p">):</span>
</span><span id="__span-0-2"><span class="gp">... </span>    <span class="k">return</span> <span class="p">[</span><span class="n">x</span> <span class="o">*</span> <span class="mi">2</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">batch</span><span class="p">]</span>
</span><span id="__span-0-3"><span class="gp">&gt;&gt;&gt; </span><span class="n">sampler</span> <span class="o">=</span> <span class="n">BasicBatchSampler</span><span class="p">(</span><span class="n">batch_size</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</span><span id="__span-0-4"><span class="gp">&gt;&gt;&gt; </span><span class="n">iterator</span> <span class="o">=</span> <span class="n">BatchIterator</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="n">sampler</span><span class="p">,</span> <span class="n">collator</span><span class="p">)</span>
</span><span id="__span-0-5"><span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">iterator</span><span class="p">)</span>
</span><span id="__span-0-6"><span class="go">[[2, 4], [6, 8]]</span>
</span></code></pre></div>








                  <details class="mkdocstrings-source">
                    <summary>Source code in <code>src/formed/integrations/ml/dataloader.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-174"><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="__span-0-175">    <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-176">    <span class="n">data</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">_InputT</span><span class="p">],</span>
</span><span id="__span-0-177">    <span class="n">sampler</span><span class="p">:</span> <span class="n">BaseBatchSampler</span><span class="p">,</span>
</span><span id="__span-0-178">    <span class="n">collator</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Sequence</span><span class="p">[</span><span class="n">_InputT</span><span class="p">]],</span> <span class="n">_BatchT</span><span class="p">],</span>
</span><span id="__span-0-179"><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-180">    <span class="bp">self</span><span class="o">.</span><span class="n">_data</span> <span class="o">=</span> <span class="n">data</span>
</span><span id="__span-0-181">    <span class="bp">self</span><span class="o">.</span><span class="n">_collator</span> <span class="o">=</span> <span class="n">collator</span>
</span><span id="__span-0-182">    <span class="bp">self</span><span class="o">.</span><span class="n">_sampler</span> <span class="o">=</span> <span class="n">sampler</span>
</span><span id="__span-0-183">    <span class="bp">self</span><span class="o">.</span><span class="n">_iterator</span><span class="p">:</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">int</span><span class="p">]]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
</span></code></pre></div></td></tr></table></div>
                  </details>



<div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="formed.integrations.ml.dataloader.DataLoader" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">DataLoader</span>


<a href="#formed.integrations.ml.dataloader.DataLoader" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">DataLoader</span><span class="p">(</span><span class="n">sampler</span><span class="p">,</span> <span class="n">collator</span><span class="p">,</span> <span class="n">buffer_size</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="typing.Generic">Generic</span>[<span title="formed.integrations.ml.dataloader._InputT">_InputT</span>, <span title="formed.integrations.ml.dataloader._BatchT">_BatchT</span>]</code></p>



        <p>Data loader that creates batched iterators from datasets.</p>
<p>The DataLoader combines a batch sampler and a collator function to create
batched data iterators. It optionally supports buffering using a separate
process to prefetch batches in the background, which can improve throughput
when batch collation is expensive.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>sampler</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Batch sampler that generates batch indices.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;BaseBatchSampler&lt;/span&gt; (&lt;code&gt;formed.integrations.ml.dataloader.BaseBatchSampler&lt;/code&gt;)" href="#formed.integrations.ml.dataloader.BaseBatchSampler">BaseBatchSampler</a></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>collator</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Function that collates a sequence of items into a batch.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="collections.abc.Callable">Callable</span>[[<span title="collections.abc.Sequence">Sequence</span>[<span title="formed.integrations.ml.dataloader._InputT">_InputT</span>]], <span title="formed.integrations.ml.dataloader._BatchT">_BatchT</span>]</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>buffer_size</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Size of the prefetch buffer. If 0, buffering is disabled.
If &gt; 0, batches are prepared in a background process. Defaults to 0.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="int">int</span></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>0</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <p>Basic usage without buffering:</p>
    <div class="highlight"><pre><span></span><code><span id="__span-0-1"><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span><span class="w"> </span><span class="nf">collator</span><span class="p">(</span><span class="n">batch</span><span class="p">):</span>
</span><span id="__span-0-2"><span class="gp">... </span>    <span class="k">return</span> <span class="p">[</span><span class="n">x</span> <span class="o">*</span> <span class="mi">2</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">batch</span><span class="p">]</span>
</span><span id="__span-0-3"><span class="gp">&gt;&gt;&gt; </span><span class="n">sampler</span> <span class="o">=</span> <span class="n">BasicBatchSampler</span><span class="p">(</span><span class="n">batch_size</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-0-4"><span class="gp">&gt;&gt;&gt; </span><span class="n">loader</span> <span class="o">=</span> <span class="n">DataLoader</span><span class="p">(</span><span class="n">sampler</span><span class="o">=</span><span class="n">sampler</span><span class="p">,</span> <span class="n">collator</span><span class="o">=</span><span class="n">collator</span><span class="p">)</span>
</span><span id="__span-0-5"><span class="gp">&gt;&gt;&gt; </span><span class="n">dataset</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
</span><span id="__span-0-6"><span class="gp">&gt;&gt;&gt; </span><span class="n">batches</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">loader</span><span class="p">(</span><span class="n">dataset</span><span class="p">))</span>
</span></code></pre></div>
    <p>With buffering for better performance:</p>
    <div class="highlight"><pre><span></span><code><span id="__span-0-1"><span class="gp">&gt;&gt;&gt; </span><span class="n">loader</span> <span class="o">=</span> <span class="n">DataLoader</span><span class="p">(</span>
</span><span id="__span-0-2"><span class="gp">... </span>    <span class="n">sampler</span><span class="o">=</span><span class="n">sampler</span><span class="p">,</span>
</span><span id="__span-0-3"><span class="gp">... </span>    <span class="n">collator</span><span class="o">=</span><span class="n">collator</span><span class="p">,</span>
</span><span id="__span-0-4"><span class="gp">... </span>    <span class="n">buffer_size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>  <span class="c1"># Prefetch up to 10 batches</span>
</span><span id="__span-0-5"><span class="gp">... </span><span class="p">)</span>
</span><span id="__span-0-6"><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">formed.common.ctxutils</span><span class="w"> </span><span class="kn">import</span> <span class="n">closing</span>
</span><span id="__span-0-7"><span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">closing</span><span class="p">(</span><span class="n">loader</span><span class="p">(</span><span class="n">dataset</span><span class="p">))</span> <span class="k">as</span> <span class="n">batches</span><span class="p">:</span>
</span><span id="__span-0-8"><span class="gp">... </span>    <span class="k">for</span> <span class="n">batch</span> <span class="ow">in</span> <span class="n">batches</span><span class="p">:</span>
</span><span id="__span-0-9"><span class="gp">... </span>        <span class="c1"># Process batch</span>
</span><span id="__span-0-10"><span class="gp">... </span>        <span class="k">pass</span>
</span></code></pre></div>


<details class="note" open>
  <summary>Note</summary>
  <p>When using buffering (<code>buffer_size &gt; 0</code>), the collator function and
any objects it references must be picklable, as they will be passed
to a background process. Also, it's recommended to use the loader
with a context manager (<code>closing</code>) to ensure proper cleanup of the
background process.</p>
</details>







                  <details class="mkdocstrings-source">
                    <summary>Source code in <code>src/formed/integrations/ml/dataloader.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-238"><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="__span-0-239">    <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-240">    <span class="n">sampler</span><span class="p">:</span> <span class="n">BaseBatchSampler</span><span class="p">,</span>
</span><span id="__span-0-241">    <span class="n">collator</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Sequence</span><span class="p">[</span><span class="n">_InputT</span><span class="p">]],</span> <span class="n">_BatchT</span><span class="p">],</span>
</span><span id="__span-0-242">    <span class="n">buffer_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
</span><span id="__span-0-243"><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-244">    <span class="bp">self</span><span class="o">.</span><span class="n">_collator</span> <span class="o">=</span> <span class="n">collator</span>
</span><span id="__span-0-245">    <span class="bp">self</span><span class="o">.</span><span class="n">_sampler</span> <span class="o">=</span> <span class="n">sampler</span>
</span><span id="__span-0-246">    <span class="bp">self</span><span class="o">.</span><span class="n">_buffer_size</span> <span class="o">=</span> <span class="n">buffer_size</span>
</span></code></pre></div></td></tr></table></div>
                  </details>



<div class="doc doc-children">












  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="formed.integrations.ml.metrics" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">formed.integrations.ml.metrics</span>


<a href="#formed.integrations.ml.metrics" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents first">

        <p>Metrics for evaluating machine learning models.</p>
<p>This module provides a comprehensive set of metrics for evaluating
classification, regression, and ranking models. All metrics follow
a common interface with reset, update, and compute methods.</p>


<details class="key-components" open>
  <summary>Key Components</summary>
  <p>Base Classes:</p>
<ul>
<li><code>BaseMetric</code>: Abstract base for all metrics</li>
<li><code>BinaryClassificationMetric</code>: Base for binary classification metrics</li>
<li><code>MulticlassClassificationMetric</code>: Base for multiclass metrics</li>
<li><code>MultilabelClassificationMetric</code>: Base for multilabel metrics</li>
<li><code>RegressionMetric</code>: Base for regression metrics</li>
<li><code>RankingMetric</code>: Base for ranking metrics</li>
</ul>
<p>Classification Metrics:</p>
<ul>
<li><code>BinaryAccuracy</code>: Binary classification accuracy</li>
<li><code>BinaryFBeta</code>: Binary F-beta score (precision, recall, F1)</li>
<li><code>BinaryROCAUC</code>: Binary ROC AUC (requires scores)</li>
<li><code>BinaryPRAUC</code>: Binary PR AUC (Precision-Recall curve, requires scores)</li>
<li><code>MulticlassAccuracy</code>: Multiclass accuracy (micro/macro)</li>
<li><code>MulticlassFBeta</code>: Multiclass F-beta (micro/macro)</li>
<li><code>MultilabelAccuracy</code>: Multilabel accuracy</li>
<li><code>MultilabelFBeta</code>: Multilabel F-beta</li>
</ul>
<p>Regression Metrics:</p>
<ul>
<li><code>MeanAbsoluteError</code>: MAE metric</li>
<li><code>MeanSquaredError</code>: MSE metric</li>
</ul>
<p>Ranking Metrics:</p>
<ul>
<li><code>MeanAveragePrecision</code>: MAP metric</li>
<li><code>NDCG</code>: Normalized Discounted Cumulative Gain</li>
</ul>
<p>Utility Metrics:</p>
<ul>
<li><code>Average</code>: Simple averaging metric</li>
<li><code>EmptyMetric</code>: No-op metric</li>
</ul>
</details>

<details class="features" open>
  <summary>Features</summary>
  <ul>
<li>Stateful metrics with accumulation across batches</li>
<li>Support for micro and macro averaging</li>
<li>Flexible label types (<code>int</code>, <code>str</code>, <code>bool</code>)</li>
<li>Registrable for configuration-based instantiation</li>
</ul>
</details>

<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span id="__span-0-1"><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">formed.integrations.ml.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">MulticlassAccuracy</span><span class="p">,</span> <span class="n">ClassificationInput</span>
</span><span id="__span-0-2"><span class="gp">&gt;&gt;&gt;</span>
</span><span id="__span-0-3"><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create metric</span>
</span><span id="__span-0-4"><span class="gp">&gt;&gt;&gt; </span><span class="n">metric</span> <span class="o">=</span> <span class="n">MulticlassAccuracy</span><span class="p">(</span><span class="n">average</span><span class="o">=</span><span class="s2">&quot;macro&quot;</span><span class="p">)</span>
</span><span id="__span-0-5"><span class="gp">&gt;&gt;&gt;</span>
</span><span id="__span-0-6"><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Update with batch</span>
</span><span id="__span-0-7"><span class="gp">&gt;&gt;&gt; </span><span class="n">inputs</span> <span class="o">=</span> <span class="n">ClassificationInput</span><span class="p">(</span>
</span><span id="__span-0-8"><span class="gp">... </span>    <span class="n">predictions</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
</span><span id="__span-0-9"><span class="gp">... </span>    <span class="n">targets</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
</span><span id="__span-0-10"><span class="gp">... </span><span class="p">)</span>
</span><span id="__span-0-11"><span class="gp">&gt;&gt;&gt; </span><span class="n">metric</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
</span><span id="__span-0-12"><span class="gp">&gt;&gt;&gt;</span>
</span><span id="__span-0-13"><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Compute final metrics</span>
</span><span id="__span-0-14"><span class="gp">&gt;&gt;&gt; </span><span class="n">results</span> <span class="o">=</span> <span class="n">metric</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
</span><span id="__span-0-15"><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>  <span class="c1"># {&quot;accuracy&quot;: 0.75}</span>
</span><span id="__span-0-16"><span class="gp">&gt;&gt;&gt;</span>
</span><span id="__span-0-17"><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Reset for next evaluation</span>
</span><span id="__span-0-18"><span class="gp">&gt;&gt;&gt; </span><span class="n">metric</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
</span></code></pre></div>










<div class="doc doc-children">









<div class="doc doc-object doc-class">



<h3 id="formed.integrations.ml.metrics.BaseMetric" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">BaseMetric</span>


<a href="#formed.integrations.ml.metrics.BaseMetric" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="colt.Registrable">Registrable</span></code>, <code><span title="typing.Generic">Generic</span>[<span title="formed.integrations.ml.metrics._T">_T</span>]</code>, <code><span title="abc.ABC">ABC</span></code></p>



        <p>Abstract base class for all metrics.</p>
<p>Metrics are stateful objects that accumulate predictions and targets
across multiple batches, then compute aggregate statistics.</p>


<table>
      <thead>
        <tr>
          <th>
            <span class="doc-section-title">
              CLASS TYPE PARAMETER
            </span>
          </th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>_T</code>
            </td>
            <td class="doc-type_param-details">
              <div class="doc-md-description">
                <p>Type of input data for this metric.</p>
              </div>
              <p>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span id="__span-0-1"><span class="gp">&gt;&gt;&gt; </span><span class="nd">@BaseMetric</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="s2">&quot;my_metric&quot;</span><span class="p">)</span>
</span><span id="__span-0-2"><span class="gp">... </span><span class="k">class</span><span class="w"> </span><span class="nc">MyMetric</span><span class="p">(</span><span class="n">BaseMetric</span><span class="p">[</span><span class="n">MyInputType</span><span class="p">]):</span>
</span><span id="__span-0-3"><span class="gp">... </span>    <span class="k">def</span><span class="w"> </span><span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-0-4"><span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">_state</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="__span-0-5"><span class="gp">... </span>    <span class="k">def</span><span class="w"> </span><span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">):</span>
</span><span id="__span-0-6"><span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">_state</span> <span class="o">+=</span> <span class="n">process</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
</span><span id="__span-0-7"><span class="gp">... </span>    <span class="k">def</span><span class="w"> </span><span class="nf">compute</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-0-8"><span class="gp">... </span>        <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;metric&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_state</span><span class="p">}</span>
</span></code></pre></div>











<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.metrics.BaseMetric.reset" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">reset</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

<a href="#formed.integrations.ml.metrics.BaseMetric.reset" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">reset</span><span class="p">()</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Reset internal state for a new evaluation.</p>
<p>This should clear all accumulated statistics.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/metrics.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-106"><span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
</span><span id="__span-0-107"><span class="k">def</span><span class="w"> </span><span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-108"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Reset internal state for a new evaluation.</span>
</span><span id="__span-0-109">
</span><span id="__span-0-110"><span class="sd">    This should clear all accumulated statistics.</span>
</span><span id="__span-0-111">
</span><span id="__span-0-112"><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-113">    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.metrics.BaseMetric.update" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">update</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

<a href="#formed.integrations.ml.metrics.BaseMetric.update" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">update</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Update internal state with a batch of predictions.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>inputs</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Batch of predictions and targets.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="formed.integrations.ml.metrics._T">_T</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/metrics.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-115"><span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
</span><span id="__span-0-116"><span class="k">def</span><span class="w"> </span><span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">:</span> <span class="n">_T</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-117"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Update internal state with a batch of predictions.</span>
</span><span id="__span-0-118">
</span><span id="__span-0-119"><span class="sd">    Args:</span>
</span><span id="__span-0-120"><span class="sd">        inputs: Batch of predictions and targets.</span>
</span><span id="__span-0-121">
</span><span id="__span-0-122"><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-123">    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.metrics.BaseMetric.compute" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">compute</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

<a href="#formed.integrations.ml.metrics.BaseMetric.compute" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">compute</span><span class="p">()</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Compute metrics from accumulated state.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="float">float</span>]</code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>Dictionary mapping metric names to values.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/metrics.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-125"><span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
</span><span id="__span-0-126"><span class="k">def</span><span class="w"> </span><span class="nf">compute</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
</span><span id="__span-0-127"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute metrics from accumulated state.</span>
</span><span id="__span-0-128">
</span><span id="__span-0-129"><span class="sd">    Returns:</span>
</span><span id="__span-0-130"><span class="sd">        Dictionary mapping metric names to values.</span>
</span><span id="__span-0-131">
</span><span id="__span-0-132"><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-133">    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="formed.integrations.ml.metrics.EmptyMetric" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">EmptyMetric</span>


<a href="#formed.integrations.ml.metrics.EmptyMetric" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;BaseMetric&lt;/span&gt; (&lt;code&gt;formed.integrations.ml.metrics.BaseMetric&lt;/code&gt;)" href="#formed.integrations.ml.metrics.BaseMetric">BaseMetric</a>[<span title="typing.Any">Any</span>]</code></p>



        <p>No-op metric that does nothing.</p>
<p>This metric can be used as a placeholder when no evaluation is needed.</p>











<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.metrics.EmptyMetric.reset" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">reset</span>


<a href="#formed.integrations.ml.metrics.EmptyMetric.reset" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">reset</span><span class="p">()</span>
</span></code></pre></div>

    <div class="doc doc-contents ">


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/metrics.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">157</span>
<span class="normal">158</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-157"><span class="k">def</span><span class="w"> </span><span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-158">    <span class="k">pass</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.metrics.EmptyMetric.update" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">update</span>


<a href="#formed.integrations.ml.metrics.EmptyMetric.update" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">update</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/metrics.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">160</span>
<span class="normal">161</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-160"><span class="k">def</span><span class="w"> </span><span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-161">    <span class="k">pass</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.metrics.EmptyMetric.compute" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">compute</span>


<a href="#formed.integrations.ml.metrics.EmptyMetric.compute" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">compute</span><span class="p">()</span>
</span></code></pre></div>

    <div class="doc doc-contents ">


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/metrics.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">163</span>
<span class="normal">164</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-163"><span class="k">def</span><span class="w"> </span><span class="nf">compute</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
</span><span id="__span-0-164">    <span class="k">return</span> <span class="p">{}</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="formed.integrations.ml.metrics.Average" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">Average</span>


<a href="#formed.integrations.ml.metrics.Average" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">Average</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;average&#39;</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;BaseMetric&lt;/span&gt; (&lt;code&gt;formed.integrations.ml.metrics.BaseMetric&lt;/code&gt;)" href="#formed.integrations.ml.metrics.BaseMetric">BaseMetric</a>[<span title="collections.abc.Sequence">Sequence</span>[<span title="float">float</span>]]</code></p>



        <p>Simple averaging metric for numeric values.</p>
<p>Computes the mean of all values seen across batches.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>name</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Name for the metric in output dictionary.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="str">str</span></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>&#39;average&#39;</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span id="__span-0-1"><span class="gp">&gt;&gt;&gt; </span><span class="n">metric</span> <span class="o">=</span> <span class="n">Average</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;loss&quot;</span><span class="p">)</span>
</span><span id="__span-0-2"><span class="gp">&gt;&gt;&gt; </span><span class="n">metric</span><span class="o">.</span><span class="n">update</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">])</span>
</span><span id="__span-0-3"><span class="gp">&gt;&gt;&gt; </span><span class="n">metric</span><span class="o">.</span><span class="n">update</span><span class="p">([</span><span class="mf">4.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">])</span>
</span><span id="__span-0-4"><span class="gp">&gt;&gt;&gt; </span><span class="n">metric</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>  <span class="c1"># {&quot;loss&quot;: 3.0}</span>
</span></code></pre></div>








                  <details class="mkdocstrings-source">
                    <summary>Source code in <code>src/formed/integrations/ml/metrics.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-184"><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;average&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-185">    <span class="bp">self</span><span class="o">.</span><span class="n">_name</span> <span class="o">=</span> <span class="n">name</span>
</span><span id="__span-0-186">    <span class="bp">self</span><span class="o">.</span><span class="n">_total</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="__span-0-187">    <span class="bp">self</span><span class="o">.</span><span class="n">_count</span> <span class="o">=</span> <span class="mi">0</span>
</span></code></pre></div></td></tr></table></div>
                  </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.metrics.Average.reset" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">reset</span>


<a href="#formed.integrations.ml.metrics.Average.reset" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">reset</span><span class="p">()</span>
</span></code></pre></div>

    <div class="doc doc-contents ">


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/metrics.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-189"><span class="k">def</span><span class="w"> </span><span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-190">    <span class="bp">self</span><span class="o">.</span><span class="n">_total</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="__span-0-191">    <span class="bp">self</span><span class="o">.</span><span class="n">_count</span> <span class="o">=</span> <span class="mi">0</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.metrics.Average.update" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">update</span>


<a href="#formed.integrations.ml.metrics.Average.update" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">update</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/metrics.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-193"><span class="k">def</span><span class="w"> </span><span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-194">    <span class="bp">self</span><span class="o">.</span><span class="n">_total</span> <span class="o">+=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
</span><span id="__span-0-195">    <span class="bp">self</span><span class="o">.</span><span class="n">_count</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.metrics.Average.compute" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">compute</span>


<a href="#formed.integrations.ml.metrics.Average.compute" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">compute</span><span class="p">()</span>
</span></code></pre></div>

    <div class="doc doc-contents ">


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/metrics.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">197</span>
<span class="normal">198</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-197"><span class="k">def</span><span class="w"> </span><span class="nf">compute</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
</span><span id="__span-0-198">    <span class="k">return</span> <span class="p">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_name</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_total</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">_count</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_count</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mf">0.0</span><span class="p">}</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="formed.integrations.ml.metrics.ClassificationInput" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">ClassificationInput</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

<a href="#formed.integrations.ml.metrics.ClassificationInput" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">ClassificationInput</span><span class="p">(</span><span class="n">predictions</span><span class="p">,</span> <span class="n">targets</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="typing.Generic">Generic</span>[<span title="formed.integrations.ml.metrics._T">_T</span>]</code></p>



        <p>Input data for classification metrics.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">ATTRIBUTE</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-attribute&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-attribute-name&quot;&gt;predictions&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-instance-attribute&quot;&gt;&lt;code&gt;instance-attribute&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;formed.integrations.ml.metrics.ClassificationInput.predictions&lt;/code&gt;)" href="#formed.integrations.ml.metrics.ClassificationInput.predictions">predictions</a></code></td>
            <td class="doc-attribute-details">
              <div class="doc-md-description">
                <p>Sequence of predicted labels.</p>
              </div>
              <p>
                  <span class="doc-attribute-annotation">
                    <b>TYPE:</b>
                      <code><span title="collections.abc.Sequence">Sequence</span>[<span title="formed.integrations.ml.metrics._T">_T</span>]</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-attribute&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-attribute-name&quot;&gt;targets&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-instance-attribute&quot;&gt;&lt;code&gt;instance-attribute&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;formed.integrations.ml.metrics.ClassificationInput.targets&lt;/code&gt;)" href="#formed.integrations.ml.metrics.ClassificationInput.targets">targets</a></code></td>
            <td class="doc-attribute-details">
              <div class="doc-md-description">
                <p>Sequence of ground truth labels.</p>
              </div>
              <p>
                  <span class="doc-attribute-annotation">
                    <b>TYPE:</b>
                      <code><span title="collections.abc.Sequence">Sequence</span>[<span title="formed.integrations.ml.metrics._T">_T</span>]</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>











<div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="formed.integrations.ml.metrics.ClassificationInput.predictions" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">predictions</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#formed.integrations.ml.metrics.ClassificationInput.predictions" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="n">predictions</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="formed.integrations.ml.metrics.ClassificationInput.targets" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">targets</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#formed.integrations.ml.metrics.ClassificationInput.targets" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="n">targets</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>






  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="formed.integrations.ml.metrics.BinaryClassificationInput" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">BinaryClassificationInput</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

<a href="#formed.integrations.ml.metrics.BinaryClassificationInput" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">BinaryClassificationInput</span><span class="p">(</span>
</span><span id="__span-0-2">    <span class="n">predictions</span><span class="p">,</span> <span class="n">targets</span><span class="p">,</span> <span class="n">scores</span><span class="o">=</span><span class="kc">None</span>
</span><span id="__span-0-3"><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="typing.Generic">Generic</span>[<span title="formed.integrations.ml.types.BinaryLabelT">BinaryLabelT</span>]</code></p>



        <p>Input data for binary classification metrics that require probability scores.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">ATTRIBUTE</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-attribute&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-attribute-name&quot;&gt;predictions&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-instance-attribute&quot;&gt;&lt;code&gt;instance-attribute&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;formed.integrations.ml.metrics.BinaryClassificationInput.predictions&lt;/code&gt;)" href="#formed.integrations.ml.metrics.BinaryClassificationInput.predictions">predictions</a></code></td>
            <td class="doc-attribute-details">
              <div class="doc-md-description">
                <p>Sequence of predicted labels.</p>
              </div>
              <p>
                  <span class="doc-attribute-annotation">
                    <b>TYPE:</b>
                      <code><span title="collections.abc.Sequence">Sequence</span>[<span title="formed.integrations.ml.types.BinaryLabelT">BinaryLabelT</span>]</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-attribute&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-attribute-name&quot;&gt;scores&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-class-attribute&quot;&gt;&lt;code&gt;class-attribute&lt;/code&gt;&lt;/small&gt;
      &lt;small class=&quot;doc doc-label doc-label-instance-attribute&quot;&gt;&lt;code&gt;instance-attribute&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;formed.integrations.ml.metrics.BinaryClassificationInput.scores&lt;/code&gt;)" href="#formed.integrations.ml.metrics.BinaryClassificationInput.scores">scores</a></code></td>
            <td class="doc-attribute-details">
              <div class="doc-md-description">
                <p>Sequence of prediction scores (probabilities for positive class).</p>
              </div>
              <p>
                  <span class="doc-attribute-annotation">
                    <b>TYPE:</b>
                      <code><span title="collections.abc.Sequence">Sequence</span>[<span title="float">float</span>] | None</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-attribute&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-attribute-name&quot;&gt;targets&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-instance-attribute&quot;&gt;&lt;code&gt;instance-attribute&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;formed.integrations.ml.metrics.BinaryClassificationInput.targets&lt;/code&gt;)" href="#formed.integrations.ml.metrics.BinaryClassificationInput.targets">targets</a></code></td>
            <td class="doc-attribute-details">
              <div class="doc-md-description">
                <p>Sequence of ground truth labels.</p>
              </div>
              <p>
                  <span class="doc-attribute-annotation">
                    <b>TYPE:</b>
                      <code><span title="collections.abc.Sequence">Sequence</span>[<span title="formed.integrations.ml.types.BinaryLabelT">BinaryLabelT</span>]</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>











<div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="formed.integrations.ml.metrics.BinaryClassificationInput.predictions" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">predictions</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#formed.integrations.ml.metrics.BinaryClassificationInput.predictions" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="n">predictions</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="formed.integrations.ml.metrics.BinaryClassificationInput.targets" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">targets</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#formed.integrations.ml.metrics.BinaryClassificationInput.targets" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="n">targets</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="formed.integrations.ml.metrics.BinaryClassificationInput.scores" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">scores</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#formed.integrations.ml.metrics.BinaryClassificationInput.scores" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="n">scores</span> <span class="o">=</span> <span class="kc">None</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>






  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="formed.integrations.ml.metrics.BinaryClassificationMetric" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">BinaryClassificationMetric</span>


<a href="#formed.integrations.ml.metrics.BinaryClassificationMetric" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;BaseMetric&lt;/span&gt; (&lt;code&gt;formed.integrations.ml.metrics.BaseMetric&lt;/code&gt;)" href="#formed.integrations.ml.metrics.BaseMetric">BaseMetric</a>[<a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;BinaryClassificationInput&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;formed.integrations.ml.metrics.BinaryClassificationInput&lt;/code&gt;)" href="#formed.integrations.ml.metrics.BinaryClassificationInput">BinaryClassificationInput</a>[<span title="formed.integrations.ml.types.BinaryLabelT">BinaryLabelT</span>]]</code>, <code><span title="typing.Generic">Generic</span>[<span title="formed.integrations.ml.types.BinaryLabelT">BinaryLabelT</span>]</code></p>



        <p>Base class for binary classification metrics.</p>
<p>Binary classification metrics work with two classes (<code>0 and</code>1<code>`, or</code>True<code>/</code>False`).</p>


<table>
      <thead>
        <tr>
          <th>
            <span class="doc-section-title">
              CLASS TYPE PARAMETER
            </span>
          </th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>BinaryLabelT</code>
            </td>
            <td class="doc-type_param-details">
              <div class="doc-md-description">
                <p>Type of labels (<code>int</code>, <code>bool</code>, etc.).</p>
              </div>
              <p>
              </p>
            </td>
          </tr>
      </tbody>
    </table>











<div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="formed.integrations.ml.metrics.BinaryClassificationMetric.Input" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">Input</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#formed.integrations.ml.metrics.BinaryClassificationMetric.Input" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="n">Input</span> <span class="o">=</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;BinaryClassificationInput&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;formed.integrations.ml.metrics.BinaryClassificationInput&lt;/code&gt;)" href="#formed.integrations.ml.metrics.BinaryClassificationInput">BinaryClassificationInput</a></span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>




<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.metrics.BinaryClassificationMetric.reset" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">reset</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

<a href="#formed.integrations.ml.metrics.BinaryClassificationMetric.reset" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">reset</span><span class="p">()</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Reset internal state for a new evaluation.</p>
<p>This should clear all accumulated statistics.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/metrics.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-106"><span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
</span><span id="__span-0-107"><span class="k">def</span><span class="w"> </span><span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-108"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Reset internal state for a new evaluation.</span>
</span><span id="__span-0-109">
</span><span id="__span-0-110"><span class="sd">    This should clear all accumulated statistics.</span>
</span><span id="__span-0-111">
</span><span id="__span-0-112"><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-113">    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.metrics.BinaryClassificationMetric.update" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">update</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

<a href="#formed.integrations.ml.metrics.BinaryClassificationMetric.update" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">update</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Update internal state with a batch of predictions.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>inputs</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Batch of predictions and targets.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="formed.integrations.ml.metrics._T">_T</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/metrics.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-115"><span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
</span><span id="__span-0-116"><span class="k">def</span><span class="w"> </span><span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">:</span> <span class="n">_T</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-117"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Update internal state with a batch of predictions.</span>
</span><span id="__span-0-118">
</span><span id="__span-0-119"><span class="sd">    Args:</span>
</span><span id="__span-0-120"><span class="sd">        inputs: Batch of predictions and targets.</span>
</span><span id="__span-0-121">
</span><span id="__span-0-122"><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-123">    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.metrics.BinaryClassificationMetric.compute" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">compute</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

<a href="#formed.integrations.ml.metrics.BinaryClassificationMetric.compute" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">compute</span><span class="p">()</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Compute metrics from accumulated state.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="float">float</span>]</code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>Dictionary mapping metric names to values.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/metrics.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-125"><span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
</span><span id="__span-0-126"><span class="k">def</span><span class="w"> </span><span class="nf">compute</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
</span><span id="__span-0-127"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute metrics from accumulated state.</span>
</span><span id="__span-0-128">
</span><span id="__span-0-129"><span class="sd">    Returns:</span>
</span><span id="__span-0-130"><span class="sd">        Dictionary mapping metric names to values.</span>
</span><span id="__span-0-131">
</span><span id="__span-0-132"><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-133">    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="formed.integrations.ml.metrics.BinaryAccuracy" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">BinaryAccuracy</span>


<a href="#formed.integrations.ml.metrics.BinaryAccuracy" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">BinaryAccuracy</span><span class="p">()</span>
</span></code></pre></div>

    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;BinaryClassificationMetric&lt;/span&gt; (&lt;code&gt;formed.integrations.ml.metrics.BinaryClassificationMetric&lt;/code&gt;)" href="#formed.integrations.ml.metrics.BinaryClassificationMetric">BinaryClassificationMetric</a>[<span title="formed.integrations.ml.types.BinaryLabelT">BinaryLabelT</span>]</code>, <code><span title="typing.Generic">Generic</span>[<span title="formed.integrations.ml.types.BinaryLabelT">BinaryLabelT</span>]</code></p>



        <p>Binary classification accuracy metric.</p>
<p>Computes the fraction of correct predictions.</p>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span id="__span-0-1"><span class="gp">&gt;&gt;&gt; </span><span class="n">metric</span> <span class="o">=</span> <span class="n">BinaryAccuracy</span><span class="p">()</span>
</span><span id="__span-0-2"><span class="gp">&gt;&gt;&gt; </span><span class="n">inputs</span> <span class="o">=</span> <span class="n">ClassificationInput</span><span class="p">(</span>
</span><span id="__span-0-3"><span class="gp">... </span>    <span class="n">predictions</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
</span><span id="__span-0-4"><span class="gp">... </span>    <span class="n">targets</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
</span><span id="__span-0-5"><span class="gp">... </span><span class="p">)</span>
</span><span id="__span-0-6"><span class="gp">&gt;&gt;&gt; </span><span class="n">metric</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
</span><span id="__span-0-7"><span class="gp">&gt;&gt;&gt; </span><span class="n">metric</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>  <span class="c1"># {&quot;accuracy&quot;: 0.75}</span>
</span></code></pre></div>








                  <details class="mkdocstrings-source">
                    <summary>Source code in <code>src/formed/integrations/ml/metrics.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-262"><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-263">    <span class="bp">self</span><span class="o">.</span><span class="n">_correct</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="__span-0-264">    <span class="bp">self</span><span class="o">.</span><span class="n">_total</span> <span class="o">=</span> <span class="mi">0</span>
</span></code></pre></div></td></tr></table></div>
                  </details>



<div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="formed.integrations.ml.metrics.BinaryAccuracy.Input" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">Input</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#formed.integrations.ml.metrics.BinaryAccuracy.Input" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="n">Input</span> <span class="o">=</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;BinaryClassificationInput&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;formed.integrations.ml.metrics.BinaryClassificationInput&lt;/code&gt;)" href="#formed.integrations.ml.metrics.BinaryClassificationInput">BinaryClassificationInput</a></span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>




<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.metrics.BinaryAccuracy.reset" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">reset</span>


<a href="#formed.integrations.ml.metrics.BinaryAccuracy.reset" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">reset</span><span class="p">()</span>
</span></code></pre></div>

    <div class="doc doc-contents ">


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/metrics.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-266"><span class="k">def</span><span class="w"> </span><span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-267">    <span class="bp">self</span><span class="o">.</span><span class="n">_correct</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="__span-0-268">    <span class="bp">self</span><span class="o">.</span><span class="n">_total</span> <span class="o">=</span> <span class="mi">0</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.metrics.BinaryAccuracy.update" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">update</span>


<a href="#formed.integrations.ml.metrics.BinaryAccuracy.update" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">update</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/metrics.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-270"><span class="k">def</span><span class="w"> </span><span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">:</span> <span class="n">BinaryClassificationInput</span><span class="p">[</span><span class="n">BinaryLabelT</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-271">    <span class="n">predictions</span> <span class="o">=</span> <span class="n">inputs</span><span class="o">.</span><span class="n">predictions</span>
</span><span id="__span-0-272">    <span class="n">targets</span> <span class="o">=</span> <span class="n">inputs</span><span class="o">.</span><span class="n">targets</span>
</span><span id="__span-0-273">    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">predictions</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">targets</span><span class="p">),</span> <span class="s2">&quot;Predictions and targets must have the same length&quot;</span>
</span><span id="__span-0-274">
</span><span id="__span-0-275">    <span class="k">for</span> <span class="n">pred</span><span class="p">,</span> <span class="n">target</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">predictions</span><span class="p">,</span> <span class="n">targets</span><span class="p">):</span>
</span><span id="__span-0-276">        <span class="k">if</span> <span class="n">pred</span> <span class="o">==</span> <span class="n">target</span><span class="p">:</span>
</span><span id="__span-0-277">            <span class="bp">self</span><span class="o">.</span><span class="n">_correct</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="__span-0-278">        <span class="bp">self</span><span class="o">.</span><span class="n">_total</span> <span class="o">+=</span> <span class="mi">1</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.metrics.BinaryAccuracy.compute" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">compute</span>


<a href="#formed.integrations.ml.metrics.BinaryAccuracy.compute" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">compute</span><span class="p">()</span>
</span></code></pre></div>

    <div class="doc doc-contents ">


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/metrics.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-280"><span class="k">def</span><span class="w"> </span><span class="nf">compute</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
</span><span id="__span-0-281">    <span class="n">accuracy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_correct</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">_total</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_total</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mf">0.0</span>
</span><span id="__span-0-282">    <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;accuracy&quot;</span><span class="p">:</span> <span class="n">accuracy</span><span class="p">}</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="formed.integrations.ml.metrics.BinaryFBeta" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">BinaryFBeta</span>


<a href="#formed.integrations.ml.metrics.BinaryFBeta" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">BinaryFBeta</span><span class="p">(</span><span class="n">beta</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;BinaryClassificationMetric&lt;/span&gt; (&lt;code&gt;formed.integrations.ml.metrics.BinaryClassificationMetric&lt;/code&gt;)" href="#formed.integrations.ml.metrics.BinaryClassificationMetric">BinaryClassificationMetric</a>[<span title="formed.integrations.ml.types.BinaryLabelT">BinaryLabelT</span>]</code>, <code><span title="typing.Generic">Generic</span>[<span title="formed.integrations.ml.types.BinaryLabelT">BinaryLabelT</span>]</code></p>



        <p>Binary F-beta score with precision and recall.</p>
<p>Computes F-beta score, precision, and recall for binary classification.
F-beta is the weighted harmonic mean of precision and recall, where
beta controls the weight of recall relative to precision.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>beta</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Weight of recall relative to precision. Common values:
- <code>1.0</code>: F1 score (balanced)
- <code>0.5</code>: F0.5 (emphasizes precision)
- <code>2.0</code>: F2 (emphasizes recall)</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="float">float</span></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>1.0</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>Dictionary with <code>"fbeta"</code>, <code>"precision"</code>, and <code>"recall"</code> metrics.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span id="__span-0-1"><span class="gp">&gt;&gt;&gt; </span><span class="c1"># F1 score (beta=1.0)</span>
</span><span id="__span-0-2"><span class="gp">&gt;&gt;&gt; </span><span class="n">metric</span> <span class="o">=</span> <span class="n">BinaryFBeta</span><span class="p">(</span><span class="n">beta</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
</span><span id="__span-0-3"><span class="gp">&gt;&gt;&gt; </span><span class="n">inputs</span> <span class="o">=</span> <span class="n">ClassificationInput</span><span class="p">(</span>
</span><span id="__span-0-4"><span class="gp">... </span>    <span class="n">predictions</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
</span><span id="__span-0-5"><span class="gp">... </span>    <span class="n">targets</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
</span><span id="__span-0-6"><span class="gp">... </span><span class="p">)</span>
</span><span id="__span-0-7"><span class="gp">&gt;&gt;&gt; </span><span class="n">metric</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
</span><span id="__span-0-8"><span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">metric</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
</span><span id="__span-0-9"><span class="gp">&gt;&gt;&gt; </span><span class="c1"># {&quot;fbeta&quot;: 0.67, &quot;precision&quot;: 0.67, &quot;recall&quot;: 1.0}</span>
</span></code></pre></div>








                  <details class="mkdocstrings-source">
                    <summary>Source code in <code>src/formed/integrations/ml/metrics.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-316"><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">beta</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-317">    <span class="bp">self</span><span class="o">.</span><span class="n">_beta</span> <span class="o">=</span> <span class="n">beta</span>
</span><span id="__span-0-318">    <span class="bp">self</span><span class="o">.</span><span class="n">_true_positive</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="__span-0-319">    <span class="bp">self</span><span class="o">.</span><span class="n">_false_positive</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="__span-0-320">    <span class="bp">self</span><span class="o">.</span><span class="n">_false_negative</span> <span class="o">=</span> <span class="mi">0</span>
</span></code></pre></div></td></tr></table></div>
                  </details>



<div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="formed.integrations.ml.metrics.BinaryFBeta.Input" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">Input</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#formed.integrations.ml.metrics.BinaryFBeta.Input" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="n">Input</span> <span class="o">=</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;BinaryClassificationInput&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;formed.integrations.ml.metrics.BinaryClassificationInput&lt;/code&gt;)" href="#formed.integrations.ml.metrics.BinaryClassificationInput">BinaryClassificationInput</a></span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>




<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.metrics.BinaryFBeta.reset" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">reset</span>


<a href="#formed.integrations.ml.metrics.BinaryFBeta.reset" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">reset</span><span class="p">()</span>
</span></code></pre></div>

    <div class="doc doc-contents ">


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/metrics.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-322"><span class="k">def</span><span class="w"> </span><span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-323">    <span class="bp">self</span><span class="o">.</span><span class="n">_true_positive</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="__span-0-324">    <span class="bp">self</span><span class="o">.</span><span class="n">_false_positive</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="__span-0-325">    <span class="bp">self</span><span class="o">.</span><span class="n">_false_negative</span> <span class="o">=</span> <span class="mi">0</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.metrics.BinaryFBeta.update" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">update</span>


<a href="#formed.integrations.ml.metrics.BinaryFBeta.update" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">update</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/metrics.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-327"><span class="k">def</span><span class="w"> </span><span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">:</span> <span class="n">BinaryClassificationInput</span><span class="p">[</span><span class="n">BinaryLabelT</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-328">    <span class="n">predictions</span> <span class="o">=</span> <span class="n">inputs</span><span class="o">.</span><span class="n">predictions</span>
</span><span id="__span-0-329">    <span class="n">targets</span> <span class="o">=</span> <span class="n">inputs</span><span class="o">.</span><span class="n">targets</span>
</span><span id="__span-0-330">    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">predictions</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">targets</span><span class="p">),</span> <span class="s2">&quot;Predictions and targets must have the same length&quot;</span>
</span><span id="__span-0-331">
</span><span id="__span-0-332">    <span class="k">for</span> <span class="n">pred</span><span class="p">,</span> <span class="n">target</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">predictions</span><span class="p">,</span> <span class="n">targets</span><span class="p">):</span>
</span><span id="__span-0-333">        <span class="k">if</span> <span class="n">pred</span> <span class="o">==</span> <span class="n">target</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="__span-0-334">            <span class="bp">self</span><span class="o">.</span><span class="n">_true_positive</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="__span-0-335">        <span class="k">elif</span> <span class="n">pred</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">target</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="__span-0-336">            <span class="bp">self</span><span class="o">.</span><span class="n">_false_positive</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="__span-0-337">        <span class="k">elif</span> <span class="n">pred</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">target</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="__span-0-338">            <span class="bp">self</span><span class="o">.</span><span class="n">_false_negative</span> <span class="o">+=</span> <span class="mi">1</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.metrics.BinaryFBeta.compute" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">compute</span>


<a href="#formed.integrations.ml.metrics.BinaryFBeta.compute" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">compute</span><span class="p">()</span>
</span></code></pre></div>

    <div class="doc doc-contents ">


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/metrics.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-340"><span class="k">def</span><span class="w"> </span><span class="nf">compute</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
</span><span id="__span-0-341">    <span class="n">beta_sq</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_beta</span><span class="o">**</span><span class="mi">2</span>
</span><span id="__span-0-342">    <span class="n">precision_denominator</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_true_positive</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_false_positive</span>
</span><span id="__span-0-343">    <span class="n">recall_denominator</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_true_positive</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_false_negative</span>
</span><span id="__span-0-344">
</span><span id="__span-0-345">    <span class="n">precision</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_true_positive</span> <span class="o">/</span> <span class="n">precision_denominator</span> <span class="k">if</span> <span class="n">precision_denominator</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mf">0.0</span>
</span><span id="__span-0-346">    <span class="n">recall</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_true_positive</span> <span class="o">/</span> <span class="n">recall_denominator</span> <span class="k">if</span> <span class="n">recall_denominator</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mf">0.0</span>
</span><span id="__span-0-347">
</span><span id="__span-0-348">    <span class="k">if</span> <span class="n">precision</span> <span class="o">+</span> <span class="n">recall</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="__span-0-349">        <span class="n">fbeta</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="__span-0-350">    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-351">        <span class="n">fbeta</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">beta_sq</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">precision</span> <span class="o">*</span> <span class="n">recall</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">beta_sq</span> <span class="o">*</span> <span class="n">precision</span> <span class="o">+</span> <span class="n">recall</span><span class="p">)</span>
</span><span id="__span-0-352">
</span><span id="__span-0-353">    <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;fbeta&quot;</span><span class="p">:</span> <span class="n">fbeta</span><span class="p">,</span> <span class="s2">&quot;precision&quot;</span><span class="p">:</span> <span class="n">precision</span><span class="p">,</span> <span class="s2">&quot;recall&quot;</span><span class="p">:</span> <span class="n">recall</span><span class="p">}</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="formed.integrations.ml.metrics.BinaryROCAUC" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">BinaryROCAUC</span>


<a href="#formed.integrations.ml.metrics.BinaryROCAUC" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">BinaryROCAUC</span><span class="p">()</span>
</span></code></pre></div>

    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;BinaryClassificationMetric&lt;/span&gt; (&lt;code&gt;formed.integrations.ml.metrics.BinaryClassificationMetric&lt;/code&gt;)" href="#formed.integrations.ml.metrics.BinaryClassificationMetric">BinaryClassificationMetric</a>[<span title="formed.integrations.ml.types.BinaryLabelT">BinaryLabelT</span>]</code>, <code><span title="typing.Generic">Generic</span>[<span title="formed.integrations.ml.types.BinaryLabelT">BinaryLabelT</span>]</code></p>



        <p>Binary ROC AUC (Area Under the Receiver Operating Characteristic Curve) metric.</p>
<p>Computes the area under the ROC curve, which measures the model's ability
to distinguish between positive and negative classes across all thresholds.
ROC AUC ranges from 0 to 1, where 0.5 represents random guessing and 1.0
represents perfect classification.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>Dictionary with <code>"roc_auc"</code> metric.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span id="__span-0-1"><span class="gp">&gt;&gt;&gt; </span><span class="n">metric</span> <span class="o">=</span> <span class="n">BinaryROCAUC</span><span class="p">()</span>
</span><span id="__span-0-2"><span class="gp">&gt;&gt;&gt; </span><span class="n">inputs</span> <span class="o">=</span> <span class="n">BinaryClassificationInputWithScores</span><span class="p">(</span>
</span><span id="__span-0-3"><span class="gp">... </span>    <span class="n">predictions</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
</span><span id="__span-0-4"><span class="gp">... </span>    <span class="n">scores</span><span class="o">=</span><span class="p">[</span><span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">],</span>
</span><span id="__span-0-5"><span class="gp">... </span>    <span class="n">targets</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
</span><span id="__span-0-6"><span class="gp">... </span><span class="p">)</span>
</span><span id="__span-0-7"><span class="gp">&gt;&gt;&gt; </span><span class="n">metric</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
</span><span id="__span-0-8"><span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">metric</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
</span><span id="__span-0-9"><span class="gp">&gt;&gt;&gt; </span><span class="c1"># {&quot;roc_auc&quot;: 0.75}</span>
</span></code></pre></div>








                  <details class="mkdocstrings-source">
                    <summary>Source code in <code>src/formed/integrations/ml/metrics.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-382"><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-383">    <span class="bp">self</span><span class="o">.</span><span class="n">_scores</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-0-384">    <span class="bp">self</span><span class="o">.</span><span class="n">_targets</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span></code></pre></div></td></tr></table></div>
                  </details>



<div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="formed.integrations.ml.metrics.BinaryROCAUC.Input" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">Input</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#formed.integrations.ml.metrics.BinaryROCAUC.Input" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="n">Input</span> <span class="o">=</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;BinaryClassificationInput&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;formed.integrations.ml.metrics.BinaryClassificationInput&lt;/code&gt;)" href="#formed.integrations.ml.metrics.BinaryClassificationInput">BinaryClassificationInput</a></span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>




<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.metrics.BinaryROCAUC.reset" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">reset</span>


<a href="#formed.integrations.ml.metrics.BinaryROCAUC.reset" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">reset</span><span class="p">()</span>
</span></code></pre></div>

    <div class="doc doc-contents ">


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/metrics.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-386"><span class="k">def</span><span class="w"> </span><span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-387">    <span class="bp">self</span><span class="o">.</span><span class="n">_scores</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-0-388">    <span class="bp">self</span><span class="o">.</span><span class="n">_targets</span> <span class="o">=</span> <span class="p">[]</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.metrics.BinaryROCAUC.update" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">update</span>


<a href="#formed.integrations.ml.metrics.BinaryROCAUC.update" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">update</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/metrics.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-390"><span class="k">def</span><span class="w"> </span><span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">:</span> <span class="n">BinaryClassificationInput</span><span class="p">[</span><span class="n">BinaryLabelT</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-391">    <span class="k">assert</span> <span class="n">inputs</span><span class="o">.</span><span class="n">scores</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;Scores are required for ROC AUC computation&quot;</span>
</span><span id="__span-0-392">
</span><span id="__span-0-393">    <span class="n">scores</span> <span class="o">=</span> <span class="n">inputs</span><span class="o">.</span><span class="n">scores</span>
</span><span id="__span-0-394">    <span class="n">targets</span> <span class="o">=</span> <span class="n">inputs</span><span class="o">.</span><span class="n">targets</span>
</span><span id="__span-0-395">    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">scores</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">targets</span><span class="p">),</span> <span class="s2">&quot;Scores and targets must have the same length&quot;</span>
</span><span id="__span-0-396">
</span><span id="__span-0-397">    <span class="k">for</span> <span class="n">score</span><span class="p">,</span> <span class="n">target</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">scores</span><span class="p">,</span> <span class="n">targets</span><span class="p">):</span>
</span><span id="__span-0-398">        <span class="bp">self</span><span class="o">.</span><span class="n">_scores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">score</span><span class="p">)</span>
</span><span id="__span-0-399">        <span class="bp">self</span><span class="o">.</span><span class="n">_targets</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">1</span> <span class="k">if</span> <span class="n">target</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">or</span> <span class="n">target</span> <span class="ow">is</span> <span class="kc">True</span> <span class="k">else</span> <span class="mi">0</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.metrics.BinaryROCAUC.compute" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">compute</span>


<a href="#formed.integrations.ml.metrics.BinaryROCAUC.compute" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">compute</span><span class="p">()</span>
</span></code></pre></div>

    <div class="doc doc-contents ">


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/metrics.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-401"><span class="k">def</span><span class="w"> </span><span class="nf">compute</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
</span><span id="__span-0-402">    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_scores</span><span class="p">:</span>
</span><span id="__span-0-403">        <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;roc_auc&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">}</span>
</span><span id="__span-0-404">
</span><span id="__span-0-405">    <span class="c1"># Count total positives and negatives</span>
</span><span id="__span-0-406">    <span class="n">n_pos</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_targets</span><span class="p">)</span>
</span><span id="__span-0-407">    <span class="n">n_neg</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_targets</span><span class="p">)</span> <span class="o">-</span> <span class="n">n_pos</span>
</span><span id="__span-0-408">
</span><span id="__span-0-409">    <span class="k">if</span> <span class="n">n_pos</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">n_neg</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="__span-0-410">        <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;roc_auc&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">}</span>
</span><span id="__span-0-411">
</span><span id="__span-0-412">    <span class="c1"># Sort by scores in descending order, with ties broken by target (negatives first)</span>
</span><span id="__span-0-413">    <span class="n">sorted_pairs</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_scores</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_targets</span><span class="p">),</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
</span><span id="__span-0-414">
</span><span id="__span-0-415">    <span class="c1"># Calculate ROC curve points and AUC</span>
</span><span id="__span-0-416">    <span class="n">tp</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="__span-0-417">    <span class="n">fp</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="__span-0-418">    <span class="n">prev_tp</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="__span-0-419">    <span class="n">prev_fp</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="__span-0-420">    <span class="n">prev_score</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;inf&quot;</span><span class="p">)</span>
</span><span id="__span-0-421">    <span class="n">auc</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="__span-0-422">
</span><span id="__span-0-423">    <span class="k">for</span> <span class="n">score</span><span class="p">,</span> <span class="n">target</span> <span class="ow">in</span> <span class="n">sorted_pairs</span><span class="p">:</span>
</span><span id="__span-0-424">        <span class="c1"># When score changes, add area for previous threshold</span>
</span><span id="__span-0-425">        <span class="k">if</span> <span class="n">score</span> <span class="o">!=</span> <span class="n">prev_score</span><span class="p">:</span>
</span><span id="__span-0-426">            <span class="c1"># Add trapezoid area: width * average height</span>
</span><span id="__span-0-427">            <span class="n">auc</span> <span class="o">+=</span> <span class="p">(</span><span class="n">fp</span> <span class="o">-</span> <span class="n">prev_fp</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">tp</span> <span class="o">+</span> <span class="n">prev_tp</span><span class="p">)</span> <span class="o">/</span> <span class="mf">2.0</span>
</span><span id="__span-0-428">            <span class="n">prev_tp</span> <span class="o">=</span> <span class="n">tp</span>
</span><span id="__span-0-429">            <span class="n">prev_fp</span> <span class="o">=</span> <span class="n">fp</span>
</span><span id="__span-0-430">            <span class="n">prev_score</span> <span class="o">=</span> <span class="n">score</span>
</span><span id="__span-0-431">
</span><span id="__span-0-432">        <span class="k">if</span> <span class="n">target</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="__span-0-433">            <span class="n">tp</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="__span-0-434">        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-435">            <span class="n">fp</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="__span-0-436">
</span><span id="__span-0-437">    <span class="c1"># Add final trapezoid</span>
</span><span id="__span-0-438">    <span class="n">auc</span> <span class="o">+=</span> <span class="p">(</span><span class="n">fp</span> <span class="o">-</span> <span class="n">prev_fp</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">tp</span> <span class="o">+</span> <span class="n">prev_tp</span><span class="p">)</span> <span class="o">/</span> <span class="mf">2.0</span>
</span><span id="__span-0-439">
</span><span id="__span-0-440">    <span class="c1"># Normalize by total area</span>
</span><span id="__span-0-441">    <span class="n">auc</span> <span class="o">/=</span> <span class="n">n_pos</span> <span class="o">*</span> <span class="n">n_neg</span>
</span><span id="__span-0-442">
</span><span id="__span-0-443">    <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;roc_auc&quot;</span><span class="p">:</span> <span class="n">auc</span><span class="p">}</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="formed.integrations.ml.metrics.BinaryPRAUC" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">BinaryPRAUC</span>


<a href="#formed.integrations.ml.metrics.BinaryPRAUC" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">BinaryPRAUC</span><span class="p">()</span>
</span></code></pre></div>

    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;BinaryClassificationMetric&lt;/span&gt; (&lt;code&gt;formed.integrations.ml.metrics.BinaryClassificationMetric&lt;/code&gt;)" href="#formed.integrations.ml.metrics.BinaryClassificationMetric">BinaryClassificationMetric</a>[<span title="formed.integrations.ml.types.BinaryLabelT">BinaryLabelT</span>]</code>, <code><span title="typing.Generic">Generic</span>[<span title="formed.integrations.ml.types.BinaryLabelT">BinaryLabelT</span>]</code></p>



        <p>Binary PR AUC (Area Under the Precision-Recall Curve) metric.</p>
<p>Computes the area under the Precision-Recall curve, which plots precision
(y-axis) against recall (x-axis) at different classification thresholds.
This metric is particularly useful for imbalanced datasets where ROC AUC
might be overly optimistic.</p>
<p>Unlike ROC AUC which uses false positive rate, PR AUC focuses on the
positive class performance, making it more informative when the positive
class is rare.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>Dictionary with <code>"pr_auc"</code> metric.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span id="__span-0-1"><span class="gp">&gt;&gt;&gt; </span><span class="n">metric</span> <span class="o">=</span> <span class="n">BinaryPRAUC</span><span class="p">()</span>
</span><span id="__span-0-2"><span class="gp">&gt;&gt;&gt; </span><span class="n">inputs</span> <span class="o">=</span> <span class="n">BinaryClassificationInputWithScores</span><span class="p">(</span>
</span><span id="__span-0-3"><span class="gp">... </span>    <span class="n">predictions</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
</span><span id="__span-0-4"><span class="gp">... </span>    <span class="n">scores</span><span class="o">=</span><span class="p">[</span><span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">],</span>
</span><span id="__span-0-5"><span class="gp">... </span>    <span class="n">targets</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
</span><span id="__span-0-6"><span class="gp">... </span><span class="p">)</span>
</span><span id="__span-0-7"><span class="gp">&gt;&gt;&gt; </span><span class="n">metric</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
</span><span id="__span-0-8"><span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">metric</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
</span><span id="__span-0-9"><span class="gp">&gt;&gt;&gt; </span><span class="c1"># {&quot;pr_auc&quot;: 0.833...}</span>
</span></code></pre></div>








                  <details class="mkdocstrings-source">
                    <summary>Source code in <code>src/formed/integrations/ml/metrics.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-476"><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-477">    <span class="bp">self</span><span class="o">.</span><span class="n">_scores</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-0-478">    <span class="bp">self</span><span class="o">.</span><span class="n">_targets</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span></code></pre></div></td></tr></table></div>
                  </details>



<div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="formed.integrations.ml.metrics.BinaryPRAUC.Input" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">Input</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#formed.integrations.ml.metrics.BinaryPRAUC.Input" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="n">Input</span> <span class="o">=</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;BinaryClassificationInput&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;formed.integrations.ml.metrics.BinaryClassificationInput&lt;/code&gt;)" href="#formed.integrations.ml.metrics.BinaryClassificationInput">BinaryClassificationInput</a></span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>




<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.metrics.BinaryPRAUC.reset" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">reset</span>


<a href="#formed.integrations.ml.metrics.BinaryPRAUC.reset" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">reset</span><span class="p">()</span>
</span></code></pre></div>

    <div class="doc doc-contents ">


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/metrics.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-480"><span class="k">def</span><span class="w"> </span><span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-481">    <span class="bp">self</span><span class="o">.</span><span class="n">_scores</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-0-482">    <span class="bp">self</span><span class="o">.</span><span class="n">_targets</span> <span class="o">=</span> <span class="p">[]</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.metrics.BinaryPRAUC.update" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">update</span>


<a href="#formed.integrations.ml.metrics.BinaryPRAUC.update" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">update</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/metrics.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-484"><span class="k">def</span><span class="w"> </span><span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">:</span> <span class="n">BinaryClassificationInput</span><span class="p">[</span><span class="n">BinaryLabelT</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-485">    <span class="k">assert</span> <span class="n">inputs</span><span class="o">.</span><span class="n">scores</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;Scores are required for PR AUC computation&quot;</span>
</span><span id="__span-0-486">
</span><span id="__span-0-487">    <span class="n">scores</span> <span class="o">=</span> <span class="n">inputs</span><span class="o">.</span><span class="n">scores</span>
</span><span id="__span-0-488">    <span class="n">targets</span> <span class="o">=</span> <span class="n">inputs</span><span class="o">.</span><span class="n">targets</span>
</span><span id="__span-0-489">    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">scores</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">targets</span><span class="p">),</span> <span class="s2">&quot;Scores and targets must have the same length&quot;</span>
</span><span id="__span-0-490">
</span><span id="__span-0-491">    <span class="k">for</span> <span class="n">score</span><span class="p">,</span> <span class="n">target</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">scores</span><span class="p">,</span> <span class="n">targets</span><span class="p">):</span>
</span><span id="__span-0-492">        <span class="bp">self</span><span class="o">.</span><span class="n">_scores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">score</span><span class="p">)</span>
</span><span id="__span-0-493">        <span class="bp">self</span><span class="o">.</span><span class="n">_targets</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">1</span> <span class="k">if</span> <span class="n">target</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">or</span> <span class="n">target</span> <span class="ow">is</span> <span class="kc">True</span> <span class="k">else</span> <span class="mi">0</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.metrics.BinaryPRAUC.compute" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">compute</span>


<a href="#formed.integrations.ml.metrics.BinaryPRAUC.compute" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">compute</span><span class="p">()</span>
</span></code></pre></div>

    <div class="doc doc-contents ">


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/metrics.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-495"><span class="k">def</span><span class="w"> </span><span class="nf">compute</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
</span><span id="__span-0-496">    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_scores</span><span class="p">:</span>
</span><span id="__span-0-497">        <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;pr_auc&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">}</span>
</span><span id="__span-0-498">
</span><span id="__span-0-499">    <span class="c1"># Count total positives</span>
</span><span id="__span-0-500">    <span class="n">n_pos</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_targets</span><span class="p">)</span>
</span><span id="__span-0-501">    <span class="k">if</span> <span class="n">n_pos</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="__span-0-502">        <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;pr_auc&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">}</span>
</span><span id="__span-0-503">
</span><span id="__span-0-504">    <span class="c1"># Sort by scores in descending order</span>
</span><span id="__span-0-505">    <span class="n">sorted_pairs</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_scores</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_targets</span><span class="p">),</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
</span><span id="__span-0-506">
</span><span id="__span-0-507">    <span class="c1"># Calculate precision and recall at each threshold</span>
</span><span id="__span-0-508">    <span class="n">precisions</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-0-509">    <span class="n">recalls</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-0-510">
</span><span id="__span-0-511">    <span class="n">tp</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="__span-0-512">    <span class="n">fp</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="__span-0-513">
</span><span id="__span-0-514">    <span class="k">for</span> <span class="n">score</span><span class="p">,</span> <span class="n">target</span> <span class="ow">in</span> <span class="n">sorted_pairs</span><span class="p">:</span>
</span><span id="__span-0-515">        <span class="k">if</span> <span class="n">target</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="__span-0-516">            <span class="n">tp</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="__span-0-517">        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-518">            <span class="n">fp</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="__span-0-519">
</span><span id="__span-0-520">        <span class="n">precision</span> <span class="o">=</span> <span class="n">tp</span> <span class="o">/</span> <span class="p">(</span><span class="n">tp</span> <span class="o">+</span> <span class="n">fp</span><span class="p">)</span> <span class="k">if</span> <span class="p">(</span><span class="n">tp</span> <span class="o">+</span> <span class="n">fp</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mf">0.0</span>
</span><span id="__span-0-521">        <span class="n">recall</span> <span class="o">=</span> <span class="n">tp</span> <span class="o">/</span> <span class="n">n_pos</span>
</span><span id="__span-0-522">
</span><span id="__span-0-523">        <span class="n">precisions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">precision</span><span class="p">)</span>
</span><span id="__span-0-524">        <span class="n">recalls</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">recall</span><span class="p">)</span>
</span><span id="__span-0-525">
</span><span id="__span-0-526">    <span class="c1"># Add point (0, 1) at the beginning if not already there</span>
</span><span id="__span-0-527">    <span class="k">if</span> <span class="n">recalls</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="__span-0-528">        <span class="n">recalls</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>
</span><span id="__span-0-529">        <span class="n">precisions</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">precisions</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="__span-0-530">
</span><span id="__span-0-531">    <span class="c1"># Calculate AUC using trapezoidal rule</span>
</span><span id="__span-0-532">    <span class="n">auc</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="__span-0-533">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">recalls</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
</span><span id="__span-0-534">        <span class="c1"># Width in recall axis</span>
</span><span id="__span-0-535">        <span class="n">width</span> <span class="o">=</span> <span class="n">recalls</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">recalls</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span><span id="__span-0-536">        <span class="c1"># Average height (precision)</span>
</span><span id="__span-0-537">        <span class="n">height</span> <span class="o">=</span> <span class="p">(</span><span class="n">precisions</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">precisions</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="mf">2.0</span>
</span><span id="__span-0-538">        <span class="n">auc</span> <span class="o">+=</span> <span class="n">width</span> <span class="o">*</span> <span class="n">height</span>
</span><span id="__span-0-539">
</span><span id="__span-0-540">    <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;pr_auc&quot;</span><span class="p">:</span> <span class="n">auc</span><span class="p">}</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="formed.integrations.ml.metrics.MulticlassClassificationMetric" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">MulticlassClassificationMetric</span>


<a href="#formed.integrations.ml.metrics.MulticlassClassificationMetric" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;BaseMetric&lt;/span&gt; (&lt;code&gt;formed.integrations.ml.metrics.BaseMetric&lt;/code&gt;)" href="#formed.integrations.ml.metrics.BaseMetric">BaseMetric</a>[<a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;ClassificationInput&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;formed.integrations.ml.metrics.ClassificationInput&lt;/code&gt;)" href="#formed.integrations.ml.metrics.ClassificationInput">ClassificationInput</a>[<span title="formed.integrations.ml.types.LabelT">LabelT</span>]]</code>, <code><span title="typing.Generic">Generic</span>[<span title="formed.integrations.ml.types.LabelT">LabelT</span>]</code></p>



        <p>Base class for multiclass classification metrics.</p>
<p>Multiclass metrics work with any number of classes and support
both micro and macro averaging strategies.</p>


<table>
      <thead>
        <tr>
          <th>
            <span class="doc-section-title">
              CLASS TYPE PARAMETER
            </span>
          </th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>LabelT</code>
            </td>
            <td class="doc-type_param-details">
              <div class="doc-md-description">
                <p>Type of labels (<code>int</code>, <code>str</code>, etc.).</p>
              </div>
              <p>
              </p>
            </td>
          </tr>
      </tbody>
    </table>











<div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="formed.integrations.ml.metrics.MulticlassClassificationMetric.Input" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">Input</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#formed.integrations.ml.metrics.MulticlassClassificationMetric.Input" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="n">Input</span> <span class="o">=</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;ClassificationInput&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;formed.integrations.ml.metrics.ClassificationInput&lt;/code&gt;)" href="#formed.integrations.ml.metrics.ClassificationInput">ClassificationInput</a></span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>




<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.metrics.MulticlassClassificationMetric.reset" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">reset</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

<a href="#formed.integrations.ml.metrics.MulticlassClassificationMetric.reset" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">reset</span><span class="p">()</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Reset internal state for a new evaluation.</p>
<p>This should clear all accumulated statistics.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/metrics.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-106"><span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
</span><span id="__span-0-107"><span class="k">def</span><span class="w"> </span><span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-108"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Reset internal state for a new evaluation.</span>
</span><span id="__span-0-109">
</span><span id="__span-0-110"><span class="sd">    This should clear all accumulated statistics.</span>
</span><span id="__span-0-111">
</span><span id="__span-0-112"><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-113">    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.metrics.MulticlassClassificationMetric.update" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">update</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

<a href="#formed.integrations.ml.metrics.MulticlassClassificationMetric.update" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">update</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Update internal state with a batch of predictions.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>inputs</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Batch of predictions and targets.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="formed.integrations.ml.metrics._T">_T</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/metrics.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-115"><span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
</span><span id="__span-0-116"><span class="k">def</span><span class="w"> </span><span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">:</span> <span class="n">_T</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-117"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Update internal state with a batch of predictions.</span>
</span><span id="__span-0-118">
</span><span id="__span-0-119"><span class="sd">    Args:</span>
</span><span id="__span-0-120"><span class="sd">        inputs: Batch of predictions and targets.</span>
</span><span id="__span-0-121">
</span><span id="__span-0-122"><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-123">    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.metrics.MulticlassClassificationMetric.compute" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">compute</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

<a href="#formed.integrations.ml.metrics.MulticlassClassificationMetric.compute" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">compute</span><span class="p">()</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Compute metrics from accumulated state.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="float">float</span>]</code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>Dictionary mapping metric names to values.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/metrics.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-125"><span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
</span><span id="__span-0-126"><span class="k">def</span><span class="w"> </span><span class="nf">compute</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
</span><span id="__span-0-127"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute metrics from accumulated state.</span>
</span><span id="__span-0-128">
</span><span id="__span-0-129"><span class="sd">    Returns:</span>
</span><span id="__span-0-130"><span class="sd">        Dictionary mapping metric names to values.</span>
</span><span id="__span-0-131">
</span><span id="__span-0-132"><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-133">    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="formed.integrations.ml.metrics.MulticlassAccuracy" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">MulticlassAccuracy</span>


<a href="#formed.integrations.ml.metrics.MulticlassAccuracy" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">MulticlassAccuracy</span><span class="p">(</span><span class="n">average</span><span class="o">=</span><span class="s1">&#39;micro&#39;</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;MulticlassClassificationMetric&lt;/span&gt; (&lt;code&gt;formed.integrations.ml.metrics.MulticlassClassificationMetric&lt;/code&gt;)" href="#formed.integrations.ml.metrics.MulticlassClassificationMetric">MulticlassClassificationMetric</a>[<span title="formed.integrations.ml.types.LabelT">LabelT</span>]</code>, <code><span title="typing.Generic">Generic</span>[<span title="formed.integrations.ml.types.LabelT">LabelT</span>]</code></p>



        <p>Multiclass classification accuracy with averaging strategies.</p>
<p>Computes accuracy for multiclass classification with support for
micro (overall accuracy) and macro (per-class average) strategies.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>average</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Averaging strategy:
- <code>"micro"</code>: Overall accuracy across all samples
- <code>"macro"</code>: Average of per-class accuracies</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="typing.Literal">Literal</span>[&#39;micro&#39;, &#39;macro&#39;]</code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>&#39;micro&#39;</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span id="__span-0-1"><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Micro averaging (overall accuracy)</span>
</span><span id="__span-0-2"><span class="gp">&gt;&gt;&gt; </span><span class="n">metric</span> <span class="o">=</span> <span class="n">MulticlassAccuracy</span><span class="p">(</span><span class="n">average</span><span class="o">=</span><span class="s2">&quot;micro&quot;</span><span class="p">)</span>
</span><span id="__span-0-3"><span class="gp">&gt;&gt;&gt; </span><span class="n">inputs</span> <span class="o">=</span> <span class="n">ClassificationInput</span><span class="p">(</span>
</span><span id="__span-0-4"><span class="gp">... </span>    <span class="n">predictions</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
</span><span id="__span-0-5"><span class="gp">... </span>    <span class="n">targets</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
</span><span id="__span-0-6"><span class="gp">... </span><span class="p">)</span>
</span><span id="__span-0-7"><span class="gp">&gt;&gt;&gt; </span><span class="n">metric</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
</span><span id="__span-0-8"><span class="gp">&gt;&gt;&gt; </span><span class="n">metric</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>  <span class="c1"># {&quot;accuracy&quot;: 0.75}</span>
</span><span id="__span-0-9"><span class="gp">&gt;&gt;&gt;</span>
</span><span id="__span-0-10"><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Macro averaging (per-class average)</span>
</span><span id="__span-0-11"><span class="gp">&gt;&gt;&gt; </span><span class="n">metric</span> <span class="o">=</span> <span class="n">MulticlassAccuracy</span><span class="p">(</span><span class="n">average</span><span class="o">=</span><span class="s2">&quot;macro&quot;</span><span class="p">)</span>
</span><span id="__span-0-12"><span class="gp">&gt;&gt;&gt; </span><span class="n">metric</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
</span><span id="__span-0-13"><span class="gp">&gt;&gt;&gt; </span><span class="n">metric</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>  <span class="c1"># Average of class-wise accuracies</span>
</span></code></pre></div>








                  <details class="mkdocstrings-source">
                    <summary>Source code in <code>src/formed/integrations/ml/metrics.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-587"><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">average</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;micro&quot;</span><span class="p">,</span> <span class="s2">&quot;macro&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;micro&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-588">    <span class="bp">self</span><span class="o">.</span><span class="n">_average</span> <span class="o">=</span> <span class="n">average</span>
</span><span id="__span-0-589">    <span class="bp">self</span><span class="o">.</span><span class="n">_correct</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="n">LabelT</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</span><span id="__span-0-590">    <span class="bp">self</span><span class="o">.</span><span class="n">_total</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="n">LabelT</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
                  </details>



<div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="formed.integrations.ml.metrics.MulticlassAccuracy.Input" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">Input</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#formed.integrations.ml.metrics.MulticlassAccuracy.Input" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="n">Input</span> <span class="o">=</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;ClassificationInput&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;formed.integrations.ml.metrics.ClassificationInput&lt;/code&gt;)" href="#formed.integrations.ml.metrics.ClassificationInput">ClassificationInput</a></span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>




<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.metrics.MulticlassAccuracy.reset" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">reset</span>


<a href="#formed.integrations.ml.metrics.MulticlassAccuracy.reset" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">reset</span><span class="p">()</span>
</span></code></pre></div>

    <div class="doc doc-contents ">


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/metrics.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-592"><span class="k">def</span><span class="w"> </span><span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-593">    <span class="bp">self</span><span class="o">.</span><span class="n">_correct</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</span><span id="__span-0-594">    <span class="bp">self</span><span class="o">.</span><span class="n">_total</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.metrics.MulticlassAccuracy.update" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">update</span>


<a href="#formed.integrations.ml.metrics.MulticlassAccuracy.update" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">update</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/metrics.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-596"><span class="k">def</span><span class="w"> </span><span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">:</span> <span class="n">ClassificationInput</span><span class="p">[</span><span class="n">LabelT</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-597">    <span class="n">predictions</span> <span class="o">=</span> <span class="n">inputs</span><span class="o">.</span><span class="n">predictions</span>
</span><span id="__span-0-598">    <span class="n">targets</span> <span class="o">=</span> <span class="n">inputs</span><span class="o">.</span><span class="n">targets</span>
</span><span id="__span-0-599">    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">predictions</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">targets</span><span class="p">),</span> <span class="s2">&quot;Predictions and targets must have the same length&quot;</span>
</span><span id="__span-0-600">
</span><span id="__span-0-601">    <span class="k">for</span> <span class="n">pred</span><span class="p">,</span> <span class="n">target</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">predictions</span><span class="p">,</span> <span class="n">targets</span><span class="p">):</span>
</span><span id="__span-0-602">        <span class="k">if</span> <span class="n">pred</span> <span class="o">==</span> <span class="n">target</span><span class="p">:</span>
</span><span id="__span-0-603">            <span class="bp">self</span><span class="o">.</span><span class="n">_correct</span><span class="p">[</span><span class="n">target</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="__span-0-604">        <span class="bp">self</span><span class="o">.</span><span class="n">_total</span><span class="p">[</span><span class="n">target</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.metrics.MulticlassAccuracy.compute" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">compute</span>


<a href="#formed.integrations.ml.metrics.MulticlassAccuracy.compute" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">compute</span><span class="p">()</span>
</span></code></pre></div>

    <div class="doc doc-contents ">


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/metrics.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-606"><span class="k">def</span><span class="w"> </span><span class="nf">compute</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
</span><span id="__span-0-607">    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_average</span> <span class="o">==</span> <span class="s2">&quot;micro&quot;</span><span class="p">:</span>
</span><span id="__span-0-608">        <span class="n">total_correct</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_correct</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
</span><span id="__span-0-609">        <span class="n">total_count</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_total</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
</span><span id="__span-0-610">        <span class="n">accuracy</span> <span class="o">=</span> <span class="n">total_correct</span> <span class="o">/</span> <span class="n">total_count</span> <span class="k">if</span> <span class="n">total_count</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mf">0.0</span>
</span><span id="__span-0-611">        <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;accuracy&quot;</span><span class="p">:</span> <span class="n">accuracy</span><span class="p">}</span>
</span><span id="__span-0-612">    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_average</span> <span class="o">==</span> <span class="s2">&quot;macro&quot;</span><span class="p">:</span>
</span><span id="__span-0-613">        <span class="n">accuracies</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-0-614">        <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_total</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="__span-0-615">            <span class="n">correct</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_correct</span><span class="p">[</span><span class="n">label</span><span class="p">]</span>
</span><span id="__span-0-616">            <span class="n">total</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_total</span><span class="p">[</span><span class="n">label</span><span class="p">]</span>
</span><span id="__span-0-617">            <span class="n">accuracies</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">correct</span> <span class="o">/</span> <span class="n">total</span> <span class="k">if</span> <span class="n">total</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mf">0.0</span><span class="p">)</span>
</span><span id="__span-0-618">        <span class="n">macro_accuracy</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">accuracies</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">accuracies</span><span class="p">)</span> <span class="k">if</span> <span class="n">accuracies</span> <span class="k">else</span> <span class="mf">0.0</span>
</span><span id="__span-0-619">        <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;accuracy&quot;</span><span class="p">:</span> <span class="n">macro_accuracy</span><span class="p">}</span>
</span><span id="__span-0-620">    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-621">        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unknown average type: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_average</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="formed.integrations.ml.metrics.MulticlassFBeta" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">MulticlassFBeta</span>


<a href="#formed.integrations.ml.metrics.MulticlassFBeta" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">MulticlassFBeta</span><span class="p">(</span><span class="n">beta</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;micro&#39;</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;MulticlassClassificationMetric&lt;/span&gt; (&lt;code&gt;formed.integrations.ml.metrics.MulticlassClassificationMetric&lt;/code&gt;)" href="#formed.integrations.ml.metrics.MulticlassClassificationMetric">MulticlassClassificationMetric</a>[<span title="formed.integrations.ml.types.LabelT">LabelT</span>]</code>, <code><span title="typing.Generic">Generic</span>[<span title="formed.integrations.ml.types.LabelT">LabelT</span>]</code></p>



        <p>Multiclass F-beta score with precision and recall.</p>
<p>Computes F-beta, precision, and recall for multiclass classification
with support for micro and macro averaging.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>beta</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Weight of recall relative to precision (default: <code>1.0</code> for F1).</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="float">float</span></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>1.0</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>average</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Averaging strategy:
- <code>"micro"</code>: Compute globally across all classes
- <code>"macro"</code>: Compute per-class then average</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="typing.Literal">Literal</span>[&#39;micro&#39;, &#39;macro&#39;]</code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>&#39;micro&#39;</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>Dictionary with "fbeta", "precision", and "recall" metrics.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span id="__span-0-1"><span class="gp">&gt;&gt;&gt; </span><span class="n">metric</span> <span class="o">=</span> <span class="n">MulticlassFBeta</span><span class="p">(</span><span class="n">beta</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s2">&quot;macro&quot;</span><span class="p">)</span>
</span><span id="__span-0-2"><span class="gp">&gt;&gt;&gt; </span><span class="n">inputs</span> <span class="o">=</span> <span class="n">ClassificationInput</span><span class="p">(</span>
</span><span id="__span-0-3"><span class="gp">... </span>    <span class="n">predictions</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
</span><span id="__span-0-4"><span class="gp">... </span>    <span class="n">targets</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
</span><span id="__span-0-5"><span class="gp">... </span><span class="p">)</span>
</span><span id="__span-0-6"><span class="gp">&gt;&gt;&gt; </span><span class="n">metric</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
</span><span id="__span-0-7"><span class="gp">&gt;&gt;&gt; </span><span class="n">metric</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
</span><span id="__span-0-8"><span class="gp">&gt;&gt;&gt; </span><span class="c1"># {&quot;fbeta&quot;: ..., &quot;precision&quot;: ..., &quot;recall&quot;: ...}</span>
</span></code></pre></div>








                  <details class="mkdocstrings-source">
                    <summary>Source code in <code>src/formed/integrations/ml/metrics.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-653"><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">beta</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">average</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;micro&quot;</span><span class="p">,</span> <span class="s2">&quot;macro&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;micro&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-654">    <span class="bp">self</span><span class="o">.</span><span class="n">_beta</span> <span class="o">=</span> <span class="n">beta</span>
</span><span id="__span-0-655">    <span class="bp">self</span><span class="o">.</span><span class="n">_average</span> <span class="o">=</span> <span class="n">average</span>
</span><span id="__span-0-656">    <span class="bp">self</span><span class="o">.</span><span class="n">_true_positive</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="n">LabelT</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</span><span id="__span-0-657">    <span class="bp">self</span><span class="o">.</span><span class="n">_false_positive</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="n">LabelT</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</span><span id="__span-0-658">    <span class="bp">self</span><span class="o">.</span><span class="n">_false_negative</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="n">LabelT</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
                  </details>



<div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="formed.integrations.ml.metrics.MulticlassFBeta.Input" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">Input</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#formed.integrations.ml.metrics.MulticlassFBeta.Input" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="n">Input</span> <span class="o">=</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;ClassificationInput&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;formed.integrations.ml.metrics.ClassificationInput&lt;/code&gt;)" href="#formed.integrations.ml.metrics.ClassificationInput">ClassificationInput</a></span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>




<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.metrics.MulticlassFBeta.reset" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">reset</span>


<a href="#formed.integrations.ml.metrics.MulticlassFBeta.reset" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">reset</span><span class="p">()</span>
</span></code></pre></div>

    <div class="doc doc-contents ">


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/metrics.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-660"><span class="k">def</span><span class="w"> </span><span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-661">    <span class="bp">self</span><span class="o">.</span><span class="n">_true_positive</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</span><span id="__span-0-662">    <span class="bp">self</span><span class="o">.</span><span class="n">_false_positive</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</span><span id="__span-0-663">    <span class="bp">self</span><span class="o">.</span><span class="n">_false_negative</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.metrics.MulticlassFBeta.update" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">update</span>


<a href="#formed.integrations.ml.metrics.MulticlassFBeta.update" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">update</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/metrics.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-665"><span class="k">def</span><span class="w"> </span><span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">:</span> <span class="n">ClassificationInput</span><span class="p">[</span><span class="n">LabelT</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-666">    <span class="n">predictions</span> <span class="o">=</span> <span class="n">inputs</span><span class="o">.</span><span class="n">predictions</span>
</span><span id="__span-0-667">    <span class="n">targets</span> <span class="o">=</span> <span class="n">inputs</span><span class="o">.</span><span class="n">targets</span>
</span><span id="__span-0-668">    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">predictions</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">targets</span><span class="p">),</span> <span class="s2">&quot;Predictions and targets must have the same length&quot;</span>
</span><span id="__span-0-669">
</span><span id="__span-0-670">    <span class="k">for</span> <span class="n">pred</span><span class="p">,</span> <span class="n">target</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">predictions</span><span class="p">,</span> <span class="n">targets</span><span class="p">):</span>
</span><span id="__span-0-671">        <span class="k">if</span> <span class="n">pred</span> <span class="o">==</span> <span class="n">target</span><span class="p">:</span>
</span><span id="__span-0-672">            <span class="bp">self</span><span class="o">.</span><span class="n">_true_positive</span><span class="p">[</span><span class="n">target</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="__span-0-673">        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-674">            <span class="bp">self</span><span class="o">.</span><span class="n">_false_positive</span><span class="p">[</span><span class="n">pred</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="__span-0-675">            <span class="bp">self</span><span class="o">.</span><span class="n">_false_negative</span><span class="p">[</span><span class="n">target</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.metrics.MulticlassFBeta.compute" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">compute</span>


<a href="#formed.integrations.ml.metrics.MulticlassFBeta.compute" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">compute</span><span class="p">()</span>
</span></code></pre></div>

    <div class="doc doc-contents ">


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/metrics.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-677"><span class="k">def</span><span class="w"> </span><span class="nf">compute</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
</span><span id="__span-0-678">    <span class="n">beta_sq</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_beta</span><span class="o">**</span><span class="mi">2</span>
</span><span id="__span-0-679">
</span><span id="__span-0-680">    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_average</span> <span class="o">==</span> <span class="s2">&quot;micro&quot;</span><span class="p">:</span>
</span><span id="__span-0-681">        <span class="n">total_true_positive</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_true_positive</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
</span><span id="__span-0-682">        <span class="n">total_false_positive</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_false_positive</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
</span><span id="__span-0-683">        <span class="n">total_false_negative</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_false_negative</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
</span><span id="__span-0-684">
</span><span id="__span-0-685">        <span class="n">precision_denominator</span> <span class="o">=</span> <span class="n">total_true_positive</span> <span class="o">+</span> <span class="n">total_false_positive</span>
</span><span id="__span-0-686">        <span class="n">recall_denominator</span> <span class="o">=</span> <span class="n">total_true_positive</span> <span class="o">+</span> <span class="n">total_false_negative</span>
</span><span id="__span-0-687">
</span><span id="__span-0-688">        <span class="n">precision</span> <span class="o">=</span> <span class="n">total_true_positive</span> <span class="o">/</span> <span class="n">precision_denominator</span> <span class="k">if</span> <span class="n">precision_denominator</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mf">0.0</span>
</span><span id="__span-0-689">        <span class="n">recall</span> <span class="o">=</span> <span class="n">total_true_positive</span> <span class="o">/</span> <span class="n">recall_denominator</span> <span class="k">if</span> <span class="n">recall_denominator</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mf">0.0</span>
</span><span id="__span-0-690">
</span><span id="__span-0-691">        <span class="k">if</span> <span class="n">precision</span> <span class="o">+</span> <span class="n">recall</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="__span-0-692">            <span class="n">fbeta</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="__span-0-693">        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-694">            <span class="n">fbeta</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">beta_sq</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">precision</span> <span class="o">*</span> <span class="n">recall</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">beta_sq</span> <span class="o">*</span> <span class="n">precision</span> <span class="o">+</span> <span class="n">recall</span><span class="p">)</span>
</span><span id="__span-0-695">
</span><span id="__span-0-696">        <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;fbeta&quot;</span><span class="p">:</span> <span class="n">fbeta</span><span class="p">,</span> <span class="s2">&quot;precision&quot;</span><span class="p">:</span> <span class="n">precision</span><span class="p">,</span> <span class="s2">&quot;recall&quot;</span><span class="p">:</span> <span class="n">recall</span><span class="p">}</span>
</span><span id="__span-0-697">
</span><span id="__span-0-698">    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_average</span> <span class="o">==</span> <span class="s2">&quot;macro&quot;</span><span class="p">:</span>
</span><span id="__span-0-699">        <span class="n">fbetas</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-0-700">        <span class="n">precisions</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-0-701">        <span class="n">recalls</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-0-702">
</span><span id="__span-0-703">        <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="p">(</span>
</span><span id="__span-0-704">            <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_true_positive</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_false_positive</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_false_negative</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</span><span id="__span-0-705">        <span class="p">):</span>
</span><span id="__span-0-706">            <span class="n">tp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_true_positive</span><span class="p">[</span><span class="n">label</span><span class="p">]</span>
</span><span id="__span-0-707">            <span class="n">fp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_false_positive</span><span class="p">[</span><span class="n">label</span><span class="p">]</span>
</span><span id="__span-0-708">            <span class="n">fn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_false_negative</span><span class="p">[</span><span class="n">label</span><span class="p">]</span>
</span><span id="__span-0-709">
</span><span id="__span-0-710">            <span class="n">precision_denominator</span> <span class="o">=</span> <span class="n">tp</span> <span class="o">+</span> <span class="n">fp</span>
</span><span id="__span-0-711">            <span class="n">recall_denominator</span> <span class="o">=</span> <span class="n">tp</span> <span class="o">+</span> <span class="n">fn</span>
</span><span id="__span-0-712">
</span><span id="__span-0-713">            <span class="n">precision</span> <span class="o">=</span> <span class="n">tp</span> <span class="o">/</span> <span class="n">precision_denominator</span> <span class="k">if</span> <span class="n">precision_denominator</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mf">0.0</span>
</span><span id="__span-0-714">            <span class="n">recall</span> <span class="o">=</span> <span class="n">tp</span> <span class="o">/</span> <span class="n">recall_denominator</span> <span class="k">if</span> <span class="n">recall_denominator</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mf">0.0</span>
</span><span id="__span-0-715">
</span><span id="__span-0-716">            <span class="k">if</span> <span class="n">precision</span> <span class="o">+</span> <span class="n">recall</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="__span-0-717">                <span class="n">fbeta</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="__span-0-718">            <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-719">                <span class="n">fbeta</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">beta_sq</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">precision</span> <span class="o">*</span> <span class="n">recall</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">beta_sq</span> <span class="o">*</span> <span class="n">precision</span> <span class="o">+</span> <span class="n">recall</span><span class="p">)</span>
</span><span id="__span-0-720">
</span><span id="__span-0-721">            <span class="n">fbetas</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fbeta</span><span class="p">)</span>
</span><span id="__span-0-722">            <span class="n">precisions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">precision</span><span class="p">)</span>
</span><span id="__span-0-723">            <span class="n">recalls</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">recall</span><span class="p">)</span>
</span><span id="__span-0-724">        <span class="n">macro_fbeta</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">fbetas</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">fbetas</span><span class="p">)</span> <span class="k">if</span> <span class="n">fbetas</span> <span class="k">else</span> <span class="mf">0.0</span>
</span><span id="__span-0-725">        <span class="n">macro_precision</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">precisions</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">precisions</span><span class="p">)</span> <span class="k">if</span> <span class="n">precisions</span> <span class="k">else</span> <span class="mf">0.0</span>
</span><span id="__span-0-726">        <span class="n">macro_recall</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">recalls</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">recalls</span><span class="p">)</span> <span class="k">if</span> <span class="n">recalls</span> <span class="k">else</span> <span class="mf">0.0</span>
</span><span id="__span-0-727">        <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;fbeta&quot;</span><span class="p">:</span> <span class="n">macro_fbeta</span><span class="p">,</span> <span class="s2">&quot;precision&quot;</span><span class="p">:</span> <span class="n">macro_precision</span><span class="p">,</span> <span class="s2">&quot;recall&quot;</span><span class="p">:</span> <span class="n">macro_recall</span><span class="p">}</span>
</span><span id="__span-0-728">    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-729">        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unknown average type: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_average</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="formed.integrations.ml.metrics.MultilabelClassificationMetric" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">MultilabelClassificationMetric</span>


<a href="#formed.integrations.ml.metrics.MultilabelClassificationMetric" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;BaseMetric&lt;/span&gt; (&lt;code&gt;formed.integrations.ml.metrics.BaseMetric&lt;/code&gt;)" href="#formed.integrations.ml.metrics.BaseMetric">BaseMetric</a>[<a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;ClassificationInput&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;formed.integrations.ml.metrics.ClassificationInput&lt;/code&gt;)" href="#formed.integrations.ml.metrics.ClassificationInput">ClassificationInput</a>[<span title="collections.abc.Sequence">Sequence</span>[<span title="formed.integrations.ml.types.LabelT">LabelT</span>]]]</code>, <code><span title="typing.Generic">Generic</span>[<span title="formed.integrations.ml.types.LabelT">LabelT</span>]</code></p>













<div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="formed.integrations.ml.metrics.MultilabelClassificationMetric.Input" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">Input</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#formed.integrations.ml.metrics.MultilabelClassificationMetric.Input" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="n">Input</span> <span class="o">=</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;ClassificationInput&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;formed.integrations.ml.metrics.ClassificationInput&lt;/code&gt;)" href="#formed.integrations.ml.metrics.ClassificationInput">ClassificationInput</a></span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>




<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.metrics.MultilabelClassificationMetric.reset" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">reset</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

<a href="#formed.integrations.ml.metrics.MultilabelClassificationMetric.reset" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">reset</span><span class="p">()</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Reset internal state for a new evaluation.</p>
<p>This should clear all accumulated statistics.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/metrics.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-106"><span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
</span><span id="__span-0-107"><span class="k">def</span><span class="w"> </span><span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-108"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Reset internal state for a new evaluation.</span>
</span><span id="__span-0-109">
</span><span id="__span-0-110"><span class="sd">    This should clear all accumulated statistics.</span>
</span><span id="__span-0-111">
</span><span id="__span-0-112"><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-113">    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.metrics.MultilabelClassificationMetric.update" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">update</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

<a href="#formed.integrations.ml.metrics.MultilabelClassificationMetric.update" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">update</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Update internal state with a batch of predictions.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>inputs</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Batch of predictions and targets.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="formed.integrations.ml.metrics._T">_T</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/metrics.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-115"><span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
</span><span id="__span-0-116"><span class="k">def</span><span class="w"> </span><span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">:</span> <span class="n">_T</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-117"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Update internal state with a batch of predictions.</span>
</span><span id="__span-0-118">
</span><span id="__span-0-119"><span class="sd">    Args:</span>
</span><span id="__span-0-120"><span class="sd">        inputs: Batch of predictions and targets.</span>
</span><span id="__span-0-121">
</span><span id="__span-0-122"><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-123">    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.metrics.MultilabelClassificationMetric.compute" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">compute</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

<a href="#formed.integrations.ml.metrics.MultilabelClassificationMetric.compute" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">compute</span><span class="p">()</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Compute metrics from accumulated state.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="float">float</span>]</code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>Dictionary mapping metric names to values.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/metrics.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-125"><span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
</span><span id="__span-0-126"><span class="k">def</span><span class="w"> </span><span class="nf">compute</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
</span><span id="__span-0-127"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute metrics from accumulated state.</span>
</span><span id="__span-0-128">
</span><span id="__span-0-129"><span class="sd">    Returns:</span>
</span><span id="__span-0-130"><span class="sd">        Dictionary mapping metric names to values.</span>
</span><span id="__span-0-131">
</span><span id="__span-0-132"><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-133">    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="formed.integrations.ml.metrics.MultilabelAccuracy" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">MultilabelAccuracy</span>


<a href="#formed.integrations.ml.metrics.MultilabelAccuracy" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">MultilabelAccuracy</span><span class="p">(</span><span class="n">average</span><span class="o">=</span><span class="s1">&#39;micro&#39;</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;MultilabelClassificationMetric&lt;/span&gt; (&lt;code&gt;formed.integrations.ml.metrics.MultilabelClassificationMetric&lt;/code&gt;)" href="#formed.integrations.ml.metrics.MultilabelClassificationMetric">MultilabelClassificationMetric</a>[<span title="formed.integrations.ml.types.LabelT">LabelT</span>]</code>, <code><span title="typing.Generic">Generic</span>[<span title="formed.integrations.ml.types.LabelT">LabelT</span>]</code></p>










                  <details class="mkdocstrings-source">
                    <summary>Source code in <code>src/formed/integrations/ml/metrics.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-739"><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">average</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;micro&quot;</span><span class="p">,</span> <span class="s2">&quot;macro&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;micro&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-740">    <span class="bp">self</span><span class="o">.</span><span class="n">_average</span> <span class="o">=</span> <span class="n">average</span>
</span><span id="__span-0-741">    <span class="bp">self</span><span class="o">.</span><span class="n">_correct</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="n">LabelT</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</span><span id="__span-0-742">    <span class="bp">self</span><span class="o">.</span><span class="n">_total</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="n">LabelT</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
                  </details>



<div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="formed.integrations.ml.metrics.MultilabelAccuracy.Input" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">Input</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#formed.integrations.ml.metrics.MultilabelAccuracy.Input" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="n">Input</span> <span class="o">=</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;ClassificationInput&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;formed.integrations.ml.metrics.ClassificationInput&lt;/code&gt;)" href="#formed.integrations.ml.metrics.ClassificationInput">ClassificationInput</a></span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>




<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.metrics.MultilabelAccuracy.reset" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">reset</span>


<a href="#formed.integrations.ml.metrics.MultilabelAccuracy.reset" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">reset</span><span class="p">()</span>
</span></code></pre></div>

    <div class="doc doc-contents ">


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/metrics.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-744"><span class="k">def</span><span class="w"> </span><span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-745">    <span class="bp">self</span><span class="o">.</span><span class="n">_correct</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</span><span id="__span-0-746">    <span class="bp">self</span><span class="o">.</span><span class="n">_total</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.metrics.MultilabelAccuracy.update" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">update</span>


<a href="#formed.integrations.ml.metrics.MultilabelAccuracy.update" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">update</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/metrics.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-748"><span class="k">def</span><span class="w"> </span><span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">:</span> <span class="n">ClassificationInput</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="n">LabelT</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-749">    <span class="n">predictions</span> <span class="o">=</span> <span class="n">inputs</span><span class="o">.</span><span class="n">predictions</span>
</span><span id="__span-0-750">    <span class="n">targets</span> <span class="o">=</span> <span class="n">inputs</span><span class="o">.</span><span class="n">targets</span>
</span><span id="__span-0-751">    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">predictions</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">targets</span><span class="p">),</span> <span class="s2">&quot;Predictions and targets must have the same length&quot;</span>
</span><span id="__span-0-752">
</span><span id="__span-0-753">    <span class="k">for</span> <span class="n">pred_labels</span><span class="p">,</span> <span class="n">target_labels</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">predictions</span><span class="p">,</span> <span class="n">targets</span><span class="p">):</span>
</span><span id="__span-0-754">        <span class="n">pred_set</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">pred_labels</span><span class="p">)</span>
</span><span id="__span-0-755">        <span class="n">target_set</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">target_labels</span><span class="p">)</span>
</span><span id="__span-0-756">        <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">target_set</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">pred_set</span><span class="p">):</span>
</span><span id="__span-0-757">            <span class="k">if</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">target_set</span> <span class="ow">and</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">pred_set</span><span class="p">:</span>
</span><span id="__span-0-758">                <span class="bp">self</span><span class="o">.</span><span class="n">_correct</span><span class="p">[</span><span class="n">label</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="__span-0-759">            <span class="bp">self</span><span class="o">.</span><span class="n">_total</span><span class="p">[</span><span class="n">label</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.metrics.MultilabelAccuracy.compute" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">compute</span>


<a href="#formed.integrations.ml.metrics.MultilabelAccuracy.compute" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">compute</span><span class="p">()</span>
</span></code></pre></div>

    <div class="doc doc-contents ">


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/metrics.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-761"><span class="k">def</span><span class="w"> </span><span class="nf">compute</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
</span><span id="__span-0-762">    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_average</span> <span class="o">==</span> <span class="s2">&quot;micro&quot;</span><span class="p">:</span>
</span><span id="__span-0-763">        <span class="n">total_correct</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_correct</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
</span><span id="__span-0-764">        <span class="n">total_count</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_total</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
</span><span id="__span-0-765">        <span class="n">accuracy</span> <span class="o">=</span> <span class="n">total_correct</span> <span class="o">/</span> <span class="n">total_count</span> <span class="k">if</span> <span class="n">total_count</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mf">0.0</span>
</span><span id="__span-0-766">        <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;accuracy&quot;</span><span class="p">:</span> <span class="n">accuracy</span><span class="p">}</span>
</span><span id="__span-0-767">    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_average</span> <span class="o">==</span> <span class="s2">&quot;macro&quot;</span><span class="p">:</span>
</span><span id="__span-0-768">        <span class="n">accuracies</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-0-769">        <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_total</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="__span-0-770">            <span class="n">correct</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_correct</span><span class="p">[</span><span class="n">label</span><span class="p">]</span>
</span><span id="__span-0-771">            <span class="n">total</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_total</span><span class="p">[</span><span class="n">label</span><span class="p">]</span>
</span><span id="__span-0-772">            <span class="n">accuracies</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">correct</span> <span class="o">/</span> <span class="n">total</span> <span class="k">if</span> <span class="n">total</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mf">0.0</span><span class="p">)</span>
</span><span id="__span-0-773">        <span class="n">macro_accuracy</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">accuracies</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">accuracies</span><span class="p">)</span> <span class="k">if</span> <span class="n">accuracies</span> <span class="k">else</span> <span class="mf">0.0</span>
</span><span id="__span-0-774">        <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;accuracy&quot;</span><span class="p">:</span> <span class="n">macro_accuracy</span><span class="p">}</span>
</span><span id="__span-0-775">    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-776">        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unknown average type: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_average</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="formed.integrations.ml.metrics.MultilabelFBeta" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">MultilabelFBeta</span>


<a href="#formed.integrations.ml.metrics.MultilabelFBeta" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">MultilabelFBeta</span><span class="p">(</span><span class="n">beta</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;micro&#39;</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;MultilabelClassificationMetric&lt;/span&gt; (&lt;code&gt;formed.integrations.ml.metrics.MultilabelClassificationMetric&lt;/code&gt;)" href="#formed.integrations.ml.metrics.MultilabelClassificationMetric">MultilabelClassificationMetric</a>[<span title="formed.integrations.ml.types.LabelT">LabelT</span>]</code>, <code><span title="typing.Generic">Generic</span>[<span title="formed.integrations.ml.types.LabelT">LabelT</span>]</code></p>










                  <details class="mkdocstrings-source">
                    <summary>Source code in <code>src/formed/integrations/ml/metrics.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-782"><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">beta</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">average</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;micro&quot;</span><span class="p">,</span> <span class="s2">&quot;macro&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;micro&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-783">    <span class="bp">self</span><span class="o">.</span><span class="n">_beta</span> <span class="o">=</span> <span class="n">beta</span>
</span><span id="__span-0-784">    <span class="bp">self</span><span class="o">.</span><span class="n">_average</span> <span class="o">=</span> <span class="n">average</span>
</span><span id="__span-0-785">    <span class="bp">self</span><span class="o">.</span><span class="n">_true_positive</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="n">LabelT</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</span><span id="__span-0-786">    <span class="bp">self</span><span class="o">.</span><span class="n">_false_positive</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="n">LabelT</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</span><span id="__span-0-787">    <span class="bp">self</span><span class="o">.</span><span class="n">_false_negative</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="n">LabelT</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
                  </details>



<div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="formed.integrations.ml.metrics.MultilabelFBeta.Input" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">Input</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#formed.integrations.ml.metrics.MultilabelFBeta.Input" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="n">Input</span> <span class="o">=</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;ClassificationInput&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;formed.integrations.ml.metrics.ClassificationInput&lt;/code&gt;)" href="#formed.integrations.ml.metrics.ClassificationInput">ClassificationInput</a></span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>




<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.metrics.MultilabelFBeta.reset" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">reset</span>


<a href="#formed.integrations.ml.metrics.MultilabelFBeta.reset" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">reset</span><span class="p">()</span>
</span></code></pre></div>

    <div class="doc doc-contents ">


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/metrics.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-789"><span class="k">def</span><span class="w"> </span><span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-790">    <span class="bp">self</span><span class="o">.</span><span class="n">_true_positive</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</span><span id="__span-0-791">    <span class="bp">self</span><span class="o">.</span><span class="n">_false_positive</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</span><span id="__span-0-792">    <span class="bp">self</span><span class="o">.</span><span class="n">_false_negative</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.metrics.MultilabelFBeta.update" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">update</span>


<a href="#formed.integrations.ml.metrics.MultilabelFBeta.update" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">update</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/metrics.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span>
<span class="normal">808</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-794"><span class="k">def</span><span class="w"> </span><span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">:</span> <span class="n">ClassificationInput</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="n">LabelT</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-795">    <span class="n">predictions</span> <span class="o">=</span> <span class="n">inputs</span><span class="o">.</span><span class="n">predictions</span>
</span><span id="__span-0-796">    <span class="n">targets</span> <span class="o">=</span> <span class="n">inputs</span><span class="o">.</span><span class="n">targets</span>
</span><span id="__span-0-797">    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">predictions</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">targets</span><span class="p">),</span> <span class="s2">&quot;Predictions and targets must have the same length&quot;</span>
</span><span id="__span-0-798">
</span><span id="__span-0-799">    <span class="k">for</span> <span class="n">pred_labels</span><span class="p">,</span> <span class="n">target_labels</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">predictions</span><span class="p">,</span> <span class="n">targets</span><span class="p">):</span>
</span><span id="__span-0-800">        <span class="n">pred_set</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">pred_labels</span><span class="p">)</span>
</span><span id="__span-0-801">        <span class="n">target_set</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">target_labels</span><span class="p">)</span>
</span><span id="__span-0-802">        <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">target_set</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">pred_set</span><span class="p">):</span>
</span><span id="__span-0-803">            <span class="k">if</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">target_set</span> <span class="ow">and</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">pred_set</span><span class="p">:</span>
</span><span id="__span-0-804">                <span class="bp">self</span><span class="o">.</span><span class="n">_true_positive</span><span class="p">[</span><span class="n">label</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="__span-0-805">            <span class="k">elif</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">pred_set</span> <span class="ow">and</span> <span class="n">label</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">target_set</span><span class="p">:</span>
</span><span id="__span-0-806">                <span class="bp">self</span><span class="o">.</span><span class="n">_false_positive</span><span class="p">[</span><span class="n">label</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="__span-0-807">            <span class="k">elif</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">target_set</span> <span class="ow">and</span> <span class="n">label</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">pred_set</span><span class="p">:</span>
</span><span id="__span-0-808">                <span class="bp">self</span><span class="o">.</span><span class="n">_false_negative</span><span class="p">[</span><span class="n">label</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.metrics.MultilabelFBeta.compute" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">compute</span>


<a href="#formed.integrations.ml.metrics.MultilabelFBeta.compute" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">compute</span><span class="p">()</span>
</span></code></pre></div>

    <div class="doc doc-contents ">


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/metrics.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span>
<span class="normal">827</span>
<span class="normal">828</span>
<span class="normal">829</span>
<span class="normal">830</span>
<span class="normal">831</span>
<span class="normal">832</span>
<span class="normal">833</span>
<span class="normal">834</span>
<span class="normal">835</span>
<span class="normal">836</span>
<span class="normal">837</span>
<span class="normal">838</span>
<span class="normal">839</span>
<span class="normal">840</span>
<span class="normal">841</span>
<span class="normal">842</span>
<span class="normal">843</span>
<span class="normal">844</span>
<span class="normal">845</span>
<span class="normal">846</span>
<span class="normal">847</span>
<span class="normal">848</span>
<span class="normal">849</span>
<span class="normal">850</span>
<span class="normal">851</span>
<span class="normal">852</span>
<span class="normal">853</span>
<span class="normal">854</span>
<span class="normal">855</span>
<span class="normal">856</span>
<span class="normal">857</span>
<span class="normal">858</span>
<span class="normal">859</span>
<span class="normal">860</span>
<span class="normal">861</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-810"><span class="k">def</span><span class="w"> </span><span class="nf">compute</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
</span><span id="__span-0-811">    <span class="n">beta_sq</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_beta</span><span class="o">**</span><span class="mi">2</span>
</span><span id="__span-0-812">
</span><span id="__span-0-813">    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_average</span> <span class="o">==</span> <span class="s2">&quot;micro&quot;</span><span class="p">:</span>
</span><span id="__span-0-814">        <span class="n">total_true_positive</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_true_positive</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
</span><span id="__span-0-815">        <span class="n">total_false_positive</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_false_positive</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
</span><span id="__span-0-816">        <span class="n">total_false_negative</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_false_negative</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
</span><span id="__span-0-817">
</span><span id="__span-0-818">        <span class="n">precision_denominator</span> <span class="o">=</span> <span class="n">total_true_positive</span> <span class="o">+</span> <span class="n">total_false_positive</span>
</span><span id="__span-0-819">        <span class="n">recall_denominator</span> <span class="o">=</span> <span class="n">total_true_positive</span> <span class="o">+</span> <span class="n">total_false_negative</span>
</span><span id="__span-0-820">
</span><span id="__span-0-821">        <span class="n">precision</span> <span class="o">=</span> <span class="n">total_true_positive</span> <span class="o">/</span> <span class="n">precision_denominator</span> <span class="k">if</span> <span class="n">precision_denominator</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mf">0.0</span>
</span><span id="__span-0-822">        <span class="n">recall</span> <span class="o">=</span> <span class="n">total_true_positive</span> <span class="o">/</span> <span class="n">recall_denominator</span> <span class="k">if</span> <span class="n">recall_denominator</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mf">0.0</span>
</span><span id="__span-0-823">
</span><span id="__span-0-824">        <span class="k">if</span> <span class="n">precision</span> <span class="o">+</span> <span class="n">recall</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="__span-0-825">            <span class="n">fbeta</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="__span-0-826">        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-827">            <span class="n">fbeta</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">beta_sq</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">precision</span> <span class="o">*</span> <span class="n">recall</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">beta_sq</span> <span class="o">*</span> <span class="n">precision</span> <span class="o">+</span> <span class="n">recall</span><span class="p">)</span>
</span><span id="__span-0-828">
</span><span id="__span-0-829">        <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;fbeta&quot;</span><span class="p">:</span> <span class="n">fbeta</span><span class="p">,</span> <span class="s2">&quot;precision&quot;</span><span class="p">:</span> <span class="n">precision</span><span class="p">,</span> <span class="s2">&quot;recall&quot;</span><span class="p">:</span> <span class="n">recall</span><span class="p">}</span>
</span><span id="__span-0-830">    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_average</span> <span class="o">==</span> <span class="s2">&quot;macro&quot;</span><span class="p">:</span>
</span><span id="__span-0-831">        <span class="n">fbetas</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-0-832">        <span class="n">precisions</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-0-833">        <span class="n">recalls</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-0-834">
</span><span id="__span-0-835">        <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="p">(</span>
</span><span id="__span-0-836">            <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_true_positive</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_false_positive</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_false_negative</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</span><span id="__span-0-837">        <span class="p">):</span>
</span><span id="__span-0-838">            <span class="n">tp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_true_positive</span><span class="p">[</span><span class="n">label</span><span class="p">]</span>
</span><span id="__span-0-839">            <span class="n">fp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_false_positive</span><span class="p">[</span><span class="n">label</span><span class="p">]</span>
</span><span id="__span-0-840">            <span class="n">fn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_false_negative</span><span class="p">[</span><span class="n">label</span><span class="p">]</span>
</span><span id="__span-0-841">
</span><span id="__span-0-842">            <span class="n">precision_denominator</span> <span class="o">=</span> <span class="n">tp</span> <span class="o">+</span> <span class="n">fp</span>
</span><span id="__span-0-843">            <span class="n">recall_denominator</span> <span class="o">=</span> <span class="n">tp</span> <span class="o">+</span> <span class="n">fn</span>
</span><span id="__span-0-844">
</span><span id="__span-0-845">            <span class="n">precision</span> <span class="o">=</span> <span class="n">tp</span> <span class="o">/</span> <span class="n">precision_denominator</span> <span class="k">if</span> <span class="n">precision_denominator</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mf">0.0</span>
</span><span id="__span-0-846">            <span class="n">recall</span> <span class="o">=</span> <span class="n">tp</span> <span class="o">/</span> <span class="n">recall_denominator</span> <span class="k">if</span> <span class="n">recall_denominator</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mf">0.0</span>
</span><span id="__span-0-847">
</span><span id="__span-0-848">            <span class="k">if</span> <span class="n">precision</span> <span class="o">+</span> <span class="n">recall</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="__span-0-849">                <span class="n">fbeta</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="__span-0-850">            <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-851">                <span class="n">fbeta</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">beta_sq</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">precision</span> <span class="o">*</span> <span class="n">recall</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">beta_sq</span> <span class="o">*</span> <span class="n">precision</span> <span class="o">+</span> <span class="n">recall</span><span class="p">)</span>
</span><span id="__span-0-852">
</span><span id="__span-0-853">            <span class="n">fbetas</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fbeta</span><span class="p">)</span>
</span><span id="__span-0-854">            <span class="n">precisions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">precision</span><span class="p">)</span>
</span><span id="__span-0-855">            <span class="n">recalls</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">recall</span><span class="p">)</span>
</span><span id="__span-0-856">        <span class="n">macro_fbeta</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">fbetas</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">fbetas</span><span class="p">)</span> <span class="k">if</span> <span class="n">fbetas</span> <span class="k">else</span> <span class="mf">0.0</span>
</span><span id="__span-0-857">        <span class="n">macro_precision</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">precisions</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">precisions</span><span class="p">)</span> <span class="k">if</span> <span class="n">precisions</span> <span class="k">else</span> <span class="mf">0.0</span>
</span><span id="__span-0-858">        <span class="n">macro_recall</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">recalls</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">recalls</span><span class="p">)</span> <span class="k">if</span> <span class="n">recalls</span> <span class="k">else</span> <span class="mf">0.0</span>
</span><span id="__span-0-859">        <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;fbeta&quot;</span><span class="p">:</span> <span class="n">macro_fbeta</span><span class="p">,</span> <span class="s2">&quot;precision&quot;</span><span class="p">:</span> <span class="n">macro_precision</span><span class="p">,</span> <span class="s2">&quot;recall&quot;</span><span class="p">:</span> <span class="n">macro_recall</span><span class="p">}</span>
</span><span id="__span-0-860">    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-861">        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unknown average type: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_average</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="formed.integrations.ml.metrics.RegressionInput" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">RegressionInput</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

<a href="#formed.integrations.ml.metrics.RegressionInput" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">RegressionInput</span><span class="p">(</span><span class="n">predictions</span><span class="p">,</span> <span class="n">targets</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">













<div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="formed.integrations.ml.metrics.RegressionInput.predictions" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">predictions</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#formed.integrations.ml.metrics.RegressionInput.predictions" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="n">predictions</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="formed.integrations.ml.metrics.RegressionInput.targets" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">targets</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#formed.integrations.ml.metrics.RegressionInput.targets" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="n">targets</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>






  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="formed.integrations.ml.metrics.RegressionMetric" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">RegressionMetric</span>


<a href="#formed.integrations.ml.metrics.RegressionMetric" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;BaseMetric&lt;/span&gt; (&lt;code&gt;formed.integrations.ml.metrics.BaseMetric&lt;/code&gt;)" href="#formed.integrations.ml.metrics.BaseMetric">BaseMetric</a>[<a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;RegressionInput&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;formed.integrations.ml.metrics.RegressionInput&lt;/code&gt;)" href="#formed.integrations.ml.metrics.RegressionInput">RegressionInput</a>]</code></p>













<div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="formed.integrations.ml.metrics.RegressionMetric.Input" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">Input</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#formed.integrations.ml.metrics.RegressionMetric.Input" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="n">Input</span> <span class="o">=</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;RegressionInput&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;formed.integrations.ml.metrics.RegressionInput&lt;/code&gt;)" href="#formed.integrations.ml.metrics.RegressionInput">RegressionInput</a></span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>




<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.metrics.RegressionMetric.reset" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">reset</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

<a href="#formed.integrations.ml.metrics.RegressionMetric.reset" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">reset</span><span class="p">()</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Reset internal state for a new evaluation.</p>
<p>This should clear all accumulated statistics.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/metrics.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-106"><span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
</span><span id="__span-0-107"><span class="k">def</span><span class="w"> </span><span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-108"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Reset internal state for a new evaluation.</span>
</span><span id="__span-0-109">
</span><span id="__span-0-110"><span class="sd">    This should clear all accumulated statistics.</span>
</span><span id="__span-0-111">
</span><span id="__span-0-112"><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-113">    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.metrics.RegressionMetric.update" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">update</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

<a href="#formed.integrations.ml.metrics.RegressionMetric.update" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">update</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Update internal state with a batch of predictions.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>inputs</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Batch of predictions and targets.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="formed.integrations.ml.metrics._T">_T</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/metrics.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-115"><span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
</span><span id="__span-0-116"><span class="k">def</span><span class="w"> </span><span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">:</span> <span class="n">_T</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-117"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Update internal state with a batch of predictions.</span>
</span><span id="__span-0-118">
</span><span id="__span-0-119"><span class="sd">    Args:</span>
</span><span id="__span-0-120"><span class="sd">        inputs: Batch of predictions and targets.</span>
</span><span id="__span-0-121">
</span><span id="__span-0-122"><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-123">    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.metrics.RegressionMetric.compute" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">compute</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

<a href="#formed.integrations.ml.metrics.RegressionMetric.compute" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">compute</span><span class="p">()</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Compute metrics from accumulated state.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="float">float</span>]</code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>Dictionary mapping metric names to values.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/metrics.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-125"><span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
</span><span id="__span-0-126"><span class="k">def</span><span class="w"> </span><span class="nf">compute</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
</span><span id="__span-0-127"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute metrics from accumulated state.</span>
</span><span id="__span-0-128">
</span><span id="__span-0-129"><span class="sd">    Returns:</span>
</span><span id="__span-0-130"><span class="sd">        Dictionary mapping metric names to values.</span>
</span><span id="__span-0-131">
</span><span id="__span-0-132"><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-133">    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="formed.integrations.ml.metrics.MeanSquaredError" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">MeanSquaredError</span>


<a href="#formed.integrations.ml.metrics.MeanSquaredError" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">MeanSquaredError</span><span class="p">()</span>
</span></code></pre></div>

    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;RegressionMetric&lt;/span&gt; (&lt;code&gt;formed.integrations.ml.metrics.RegressionMetric&lt;/code&gt;)" href="#formed.integrations.ml.metrics.RegressionMetric">RegressionMetric</a></code></p>










                  <details class="mkdocstrings-source">
                    <summary>Source code in <code>src/formed/integrations/ml/metrics.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">877</span>
<span class="normal">878</span>
<span class="normal">879</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-877"><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-878">    <span class="bp">self</span><span class="o">.</span><span class="n">_squared_error</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="__span-0-879">    <span class="bp">self</span><span class="o">.</span><span class="n">_count</span> <span class="o">=</span> <span class="mi">0</span>
</span></code></pre></div></td></tr></table></div>
                  </details>



<div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="formed.integrations.ml.metrics.MeanSquaredError.Input" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">Input</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#formed.integrations.ml.metrics.MeanSquaredError.Input" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="n">Input</span> <span class="o">=</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;RegressionInput&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;formed.integrations.ml.metrics.RegressionInput&lt;/code&gt;)" href="#formed.integrations.ml.metrics.RegressionInput">RegressionInput</a></span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>




<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.metrics.MeanSquaredError.reset" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">reset</span>


<a href="#formed.integrations.ml.metrics.MeanSquaredError.reset" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">reset</span><span class="p">()</span>
</span></code></pre></div>

    <div class="doc doc-contents ">


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/metrics.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">881</span>
<span class="normal">882</span>
<span class="normal">883</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-881"><span class="k">def</span><span class="w"> </span><span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-882">    <span class="bp">self</span><span class="o">.</span><span class="n">_squared_error</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="__span-0-883">    <span class="bp">self</span><span class="o">.</span><span class="n">_count</span> <span class="o">=</span> <span class="mi">0</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.metrics.MeanSquaredError.update" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">update</span>


<a href="#formed.integrations.ml.metrics.MeanSquaredError.update" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">update</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/metrics.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">885</span>
<span class="normal">886</span>
<span class="normal">887</span>
<span class="normal">888</span>
<span class="normal">889</span>
<span class="normal">890</span>
<span class="normal">891</span>
<span class="normal">892</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-885"><span class="k">def</span><span class="w"> </span><span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">:</span> <span class="n">RegressionInput</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-886">    <span class="n">predictions</span> <span class="o">=</span> <span class="n">inputs</span><span class="o">.</span><span class="n">predictions</span>
</span><span id="__span-0-887">    <span class="n">targets</span> <span class="o">=</span> <span class="n">inputs</span><span class="o">.</span><span class="n">targets</span>
</span><span id="__span-0-888">    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">predictions</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">targets</span><span class="p">),</span> <span class="s2">&quot;Predictions and targets must have the same length&quot;</span>
</span><span id="__span-0-889">
</span><span id="__span-0-890">    <span class="k">for</span> <span class="n">pred</span><span class="p">,</span> <span class="n">target</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">predictions</span><span class="p">,</span> <span class="n">targets</span><span class="p">):</span>
</span><span id="__span-0-891">        <span class="bp">self</span><span class="o">.</span><span class="n">_squared_error</span> <span class="o">+=</span> <span class="p">(</span><span class="n">pred</span> <span class="o">-</span> <span class="n">target</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>
</span><span id="__span-0-892">        <span class="bp">self</span><span class="o">.</span><span class="n">_count</span> <span class="o">+=</span> <span class="mi">1</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.metrics.MeanSquaredError.compute" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">compute</span>


<a href="#formed.integrations.ml.metrics.MeanSquaredError.compute" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">compute</span><span class="p">()</span>
</span></code></pre></div>

    <div class="doc doc-contents ">


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/metrics.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">894</span>
<span class="normal">895</span>
<span class="normal">896</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-894"><span class="k">def</span><span class="w"> </span><span class="nf">compute</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
</span><span id="__span-0-895">    <span class="n">mse</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_squared_error</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">_count</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_count</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mf">0.0</span>
</span><span id="__span-0-896">    <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;mean_squared_error&quot;</span><span class="p">:</span> <span class="n">mse</span><span class="p">}</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="formed.integrations.ml.metrics.MeanAbsoluteError" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">MeanAbsoluteError</span>


<a href="#formed.integrations.ml.metrics.MeanAbsoluteError" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">MeanAbsoluteError</span><span class="p">()</span>
</span></code></pre></div>

    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;RegressionMetric&lt;/span&gt; (&lt;code&gt;formed.integrations.ml.metrics.RegressionMetric&lt;/code&gt;)" href="#formed.integrations.ml.metrics.RegressionMetric">RegressionMetric</a></code></p>










                  <details class="mkdocstrings-source">
                    <summary>Source code in <code>src/formed/integrations/ml/metrics.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">902</span>
<span class="normal">903</span>
<span class="normal">904</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-902"><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-903">    <span class="bp">self</span><span class="o">.</span><span class="n">_absolute_error</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="__span-0-904">    <span class="bp">self</span><span class="o">.</span><span class="n">_count</span> <span class="o">=</span> <span class="mi">0</span>
</span></code></pre></div></td></tr></table></div>
                  </details>



<div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="formed.integrations.ml.metrics.MeanAbsoluteError.Input" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">Input</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#formed.integrations.ml.metrics.MeanAbsoluteError.Input" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="n">Input</span> <span class="o">=</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;RegressionInput&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;formed.integrations.ml.metrics.RegressionInput&lt;/code&gt;)" href="#formed.integrations.ml.metrics.RegressionInput">RegressionInput</a></span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>




<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.metrics.MeanAbsoluteError.reset" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">reset</span>


<a href="#formed.integrations.ml.metrics.MeanAbsoluteError.reset" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">reset</span><span class="p">()</span>
</span></code></pre></div>

    <div class="doc doc-contents ">


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/metrics.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">906</span>
<span class="normal">907</span>
<span class="normal">908</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-906"><span class="k">def</span><span class="w"> </span><span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-907">    <span class="bp">self</span><span class="o">.</span><span class="n">_absolute_error</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="__span-0-908">    <span class="bp">self</span><span class="o">.</span><span class="n">_count</span> <span class="o">=</span> <span class="mi">0</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.metrics.MeanAbsoluteError.update" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">update</span>


<a href="#formed.integrations.ml.metrics.MeanAbsoluteError.update" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">update</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/metrics.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">910</span>
<span class="normal">911</span>
<span class="normal">912</span>
<span class="normal">913</span>
<span class="normal">914</span>
<span class="normal">915</span>
<span class="normal">916</span>
<span class="normal">917</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-910"><span class="k">def</span><span class="w"> </span><span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">:</span> <span class="n">RegressionInput</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-911">    <span class="n">predictions</span> <span class="o">=</span> <span class="n">inputs</span><span class="o">.</span><span class="n">predictions</span>
</span><span id="__span-0-912">    <span class="n">targets</span> <span class="o">=</span> <span class="n">inputs</span><span class="o">.</span><span class="n">targets</span>
</span><span id="__span-0-913">    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">predictions</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">targets</span><span class="p">),</span> <span class="s2">&quot;Predictions and targets must have the same length&quot;</span>
</span><span id="__span-0-914">
</span><span id="__span-0-915">    <span class="k">for</span> <span class="n">pred</span><span class="p">,</span> <span class="n">target</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">predictions</span><span class="p">,</span> <span class="n">targets</span><span class="p">):</span>
</span><span id="__span-0-916">        <span class="bp">self</span><span class="o">.</span><span class="n">_absolute_error</span> <span class="o">+=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">pred</span> <span class="o">-</span> <span class="n">target</span><span class="p">)</span>
</span><span id="__span-0-917">        <span class="bp">self</span><span class="o">.</span><span class="n">_count</span> <span class="o">+=</span> <span class="mi">1</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.metrics.MeanAbsoluteError.compute" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">compute</span>


<a href="#formed.integrations.ml.metrics.MeanAbsoluteError.compute" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">compute</span><span class="p">()</span>
</span></code></pre></div>

    <div class="doc doc-contents ">


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/metrics.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">919</span>
<span class="normal">920</span>
<span class="normal">921</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-919"><span class="k">def</span><span class="w"> </span><span class="nf">compute</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
</span><span id="__span-0-920">    <span class="n">mae</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_absolute_error</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">_count</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_count</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mf">0.0</span>
</span><span id="__span-0-921">    <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;mean_absolute_error&quot;</span><span class="p">:</span> <span class="n">mae</span><span class="p">}</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="formed.integrations.ml.metrics.RankingInput" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">RankingInput</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

<a href="#formed.integrations.ml.metrics.RankingInput" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">RankingInput</span><span class="p">(</span><span class="n">predictions</span><span class="p">,</span> <span class="n">targets</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="typing.Generic">Generic</span>[<span title="formed.integrations.ml.types.LabelT">LabelT</span>]</code></p>













<div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="formed.integrations.ml.metrics.RankingInput.predictions" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">predictions</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#formed.integrations.ml.metrics.RankingInput.predictions" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="n">predictions</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="formed.integrations.ml.metrics.RankingInput.targets" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">targets</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#formed.integrations.ml.metrics.RankingInput.targets" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="n">targets</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>






  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="formed.integrations.ml.metrics.RankingMetric" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">RankingMetric</span>


<a href="#formed.integrations.ml.metrics.RankingMetric" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;BaseMetric&lt;/span&gt; (&lt;code&gt;formed.integrations.ml.metrics.BaseMetric&lt;/code&gt;)" href="#formed.integrations.ml.metrics.BaseMetric">BaseMetric</a>[<a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;RankingInput&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;formed.integrations.ml.metrics.RankingInput&lt;/code&gt;)" href="#formed.integrations.ml.metrics.RankingInput">RankingInput</a>[<span title="formed.integrations.ml.types.LabelT">LabelT</span>]]</code>, <code><span title="typing.Generic">Generic</span>[<span title="formed.integrations.ml.types.LabelT">LabelT</span>]</code></p>













<div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="formed.integrations.ml.metrics.RankingMetric.Input" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">Input</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#formed.integrations.ml.metrics.RankingMetric.Input" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="n">Input</span> <span class="o">=</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;RankingInput&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;formed.integrations.ml.metrics.RankingInput&lt;/code&gt;)" href="#formed.integrations.ml.metrics.RankingInput">RankingInput</a></span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>




<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.metrics.RankingMetric.reset" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">reset</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

<a href="#formed.integrations.ml.metrics.RankingMetric.reset" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">reset</span><span class="p">()</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Reset internal state for a new evaluation.</p>
<p>This should clear all accumulated statistics.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/metrics.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-106"><span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
</span><span id="__span-0-107"><span class="k">def</span><span class="w"> </span><span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-108"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Reset internal state for a new evaluation.</span>
</span><span id="__span-0-109">
</span><span id="__span-0-110"><span class="sd">    This should clear all accumulated statistics.</span>
</span><span id="__span-0-111">
</span><span id="__span-0-112"><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-113">    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.metrics.RankingMetric.update" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">update</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

<a href="#formed.integrations.ml.metrics.RankingMetric.update" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">update</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Update internal state with a batch of predictions.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>inputs</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Batch of predictions and targets.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="formed.integrations.ml.metrics._T">_T</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/metrics.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-115"><span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
</span><span id="__span-0-116"><span class="k">def</span><span class="w"> </span><span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">:</span> <span class="n">_T</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-117"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Update internal state with a batch of predictions.</span>
</span><span id="__span-0-118">
</span><span id="__span-0-119"><span class="sd">    Args:</span>
</span><span id="__span-0-120"><span class="sd">        inputs: Batch of predictions and targets.</span>
</span><span id="__span-0-121">
</span><span id="__span-0-122"><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-123">    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.metrics.RankingMetric.compute" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">compute</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

<a href="#formed.integrations.ml.metrics.RankingMetric.compute" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">compute</span><span class="p">()</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Compute metrics from accumulated state.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="float">float</span>]</code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>Dictionary mapping metric names to values.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/metrics.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-125"><span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
</span><span id="__span-0-126"><span class="k">def</span><span class="w"> </span><span class="nf">compute</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
</span><span id="__span-0-127"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute metrics from accumulated state.</span>
</span><span id="__span-0-128">
</span><span id="__span-0-129"><span class="sd">    Returns:</span>
</span><span id="__span-0-130"><span class="sd">        Dictionary mapping metric names to values.</span>
</span><span id="__span-0-131">
</span><span id="__span-0-132"><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-133">    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="formed.integrations.ml.metrics.MeanAveragePrecision" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">MeanAveragePrecision</span>


<a href="#formed.integrations.ml.metrics.MeanAveragePrecision" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">MeanAveragePrecision</span><span class="p">()</span>
</span></code></pre></div>

    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;RankingMetric&lt;/span&gt; (&lt;code&gt;formed.integrations.ml.metrics.RankingMetric&lt;/code&gt;)" href="#formed.integrations.ml.metrics.RankingMetric">RankingMetric</a>[<span title="formed.integrations.ml.types.LabelT">LabelT</span>]</code>, <code><span title="typing.Generic">Generic</span>[<span title="formed.integrations.ml.types.LabelT">LabelT</span>]</code></p>










                  <details class="mkdocstrings-source">
                    <summary>Source code in <code>src/formed/integrations/ml/metrics.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">937</span>
<span class="normal">938</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-937"><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-938">    <span class="bp">self</span><span class="o">.</span><span class="n">_average_precisions</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span></code></pre></div></td></tr></table></div>
                  </details>



<div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="formed.integrations.ml.metrics.MeanAveragePrecision.Input" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">Input</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#formed.integrations.ml.metrics.MeanAveragePrecision.Input" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="n">Input</span> <span class="o">=</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;RankingInput&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;formed.integrations.ml.metrics.RankingInput&lt;/code&gt;)" href="#formed.integrations.ml.metrics.RankingInput">RankingInput</a></span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>




<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.metrics.MeanAveragePrecision.reset" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">reset</span>


<a href="#formed.integrations.ml.metrics.MeanAveragePrecision.reset" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">reset</span><span class="p">()</span>
</span></code></pre></div>

    <div class="doc doc-contents ">


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/metrics.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">940</span>
<span class="normal">941</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-940"><span class="k">def</span><span class="w"> </span><span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-941">    <span class="bp">self</span><span class="o">.</span><span class="n">_average_precisions</span> <span class="o">=</span> <span class="p">[]</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.metrics.MeanAveragePrecision.update" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">update</span>


<a href="#formed.integrations.ml.metrics.MeanAveragePrecision.update" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">update</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/metrics.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">943</span>
<span class="normal">944</span>
<span class="normal">945</span>
<span class="normal">946</span>
<span class="normal">947</span>
<span class="normal">948</span>
<span class="normal">949</span>
<span class="normal">950</span>
<span class="normal">951</span>
<span class="normal">952</span>
<span class="normal">953</span>
<span class="normal">954</span>
<span class="normal">955</span>
<span class="normal">956</span>
<span class="normal">957</span>
<span class="normal">958</span>
<span class="normal">959</span>
<span class="normal">960</span>
<span class="normal">961</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-943"><span class="k">def</span><span class="w"> </span><span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">:</span> <span class="n">RankingInput</span><span class="p">[</span><span class="n">LabelT</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-944">    <span class="n">predictions</span> <span class="o">=</span> <span class="n">inputs</span><span class="o">.</span><span class="n">predictions</span>
</span><span id="__span-0-945">    <span class="n">targets</span> <span class="o">=</span> <span class="n">inputs</span><span class="o">.</span><span class="n">targets</span>
</span><span id="__span-0-946">    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">predictions</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">targets</span><span class="p">),</span> <span class="s2">&quot;Predictions and targets must have the same length&quot;</span>
</span><span id="__span-0-947">
</span><span id="__span-0-948">    <span class="k">for</span> <span class="n">pred_scores</span><span class="p">,</span> <span class="n">target_labels</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">predictions</span><span class="p">,</span> <span class="n">targets</span><span class="p">):</span>
</span><span id="__span-0-949">        <span class="n">sorted_labels</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">pred_scores</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">pred_scores</span><span class="p">[</span><span class="n">x</span><span class="p">],</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-0-950">        <span class="n">relevant_set</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">target_labels</span><span class="p">)</span>
</span><span id="__span-0-951">
</span><span id="__span-0-952">        <span class="n">num_relevant</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="__span-0-953">        <span class="n">precision_sum</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="__span-0-954">
</span><span id="__span-0-955">        <span class="k">for</span> <span class="n">rank</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">sorted_labels</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
</span><span id="__span-0-956">            <span class="k">if</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">relevant_set</span><span class="p">:</span>
</span><span id="__span-0-957">                <span class="n">num_relevant</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="__span-0-958">                <span class="n">precision_sum</span> <span class="o">+=</span> <span class="n">num_relevant</span> <span class="o">/</span> <span class="n">rank</span>
</span><span id="__span-0-959">
</span><span id="__span-0-960">        <span class="n">average_precision</span> <span class="o">=</span> <span class="n">precision_sum</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">relevant_set</span><span class="p">)</span> <span class="k">if</span> <span class="n">relevant_set</span> <span class="k">else</span> <span class="mf">0.0</span>
</span><span id="__span-0-961">        <span class="bp">self</span><span class="o">.</span><span class="n">_average_precisions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">average_precision</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.metrics.MeanAveragePrecision.compute" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">compute</span>


<a href="#formed.integrations.ml.metrics.MeanAveragePrecision.compute" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">compute</span><span class="p">()</span>
</span></code></pre></div>

    <div class="doc doc-contents ">


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/metrics.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">963</span>
<span class="normal">964</span>
<span class="normal">965</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-963"><span class="k">def</span><span class="w"> </span><span class="nf">compute</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
</span><span id="__span-0-964">    <span class="n">mean_ap</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_average_precisions</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_average_precisions</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_average_precisions</span> <span class="k">else</span> <span class="mf">0.0</span>
</span><span id="__span-0-965">    <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;mean_average_precision&quot;</span><span class="p">:</span> <span class="n">mean_ap</span><span class="p">}</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="formed.integrations.ml.metrics.NDCG" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">NDCG</span>


<a href="#formed.integrations.ml.metrics.NDCG" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">NDCG</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;RankingMetric&lt;/span&gt; (&lt;code&gt;formed.integrations.ml.metrics.RankingMetric&lt;/code&gt;)" href="#formed.integrations.ml.metrics.RankingMetric">RankingMetric</a>[<span title="formed.integrations.ml.types.LabelT">LabelT</span>]</code>, <code><span title="typing.Generic">Generic</span>[<span title="formed.integrations.ml.types.LabelT">LabelT</span>]</code></p>










                  <details class="mkdocstrings-source">
                    <summary>Source code in <code>src/formed/integrations/ml/metrics.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">971</span>
<span class="normal">972</span>
<span class="normal">973</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-971"><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">k</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-972">    <span class="bp">self</span><span class="o">.</span><span class="n">_k</span> <span class="o">=</span> <span class="n">k</span>
</span><span id="__span-0-973">    <span class="bp">self</span><span class="o">.</span><span class="n">_ndcgs</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span></code></pre></div></td></tr></table></div>
                  </details>



<div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="formed.integrations.ml.metrics.NDCG.Input" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">Input</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#formed.integrations.ml.metrics.NDCG.Input" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="n">Input</span> <span class="o">=</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;RankingInput&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;formed.integrations.ml.metrics.RankingInput&lt;/code&gt;)" href="#formed.integrations.ml.metrics.RankingInput">RankingInput</a></span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>




<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.metrics.NDCG.reset" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">reset</span>


<a href="#formed.integrations.ml.metrics.NDCG.reset" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">reset</span><span class="p">()</span>
</span></code></pre></div>

    <div class="doc doc-contents ">


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/metrics.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">975</span>
<span class="normal">976</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-975"><span class="k">def</span><span class="w"> </span><span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-976">    <span class="bp">self</span><span class="o">.</span><span class="n">_ndcgs</span> <span class="o">=</span> <span class="p">[]</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.metrics.NDCG.update" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">update</span>


<a href="#formed.integrations.ml.metrics.NDCG.update" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">update</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/metrics.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">978</span>
<span class="normal">979</span>
<span class="normal">980</span>
<span class="normal">981</span>
<span class="normal">982</span>
<span class="normal">983</span>
<span class="normal">984</span>
<span class="normal">985</span>
<span class="normal">986</span>
<span class="normal">987</span>
<span class="normal">988</span>
<span class="normal">989</span>
<span class="normal">990</span>
<span class="normal">991</span>
<span class="normal">992</span>
<span class="normal">993</span>
<span class="normal">994</span>
<span class="normal">995</span>
<span class="normal">996</span>
<span class="normal">997</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-978"><span class="k">def</span><span class="w"> </span><span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">:</span> <span class="n">RankingInput</span><span class="p">[</span><span class="n">LabelT</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-979">    <span class="n">predictions</span> <span class="o">=</span> <span class="n">inputs</span><span class="o">.</span><span class="n">predictions</span>
</span><span id="__span-0-980">    <span class="n">targets</span> <span class="o">=</span> <span class="n">inputs</span><span class="o">.</span><span class="n">targets</span>
</span><span id="__span-0-981">    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">predictions</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">targets</span><span class="p">),</span> <span class="s2">&quot;Predictions and targets must have the same length&quot;</span>
</span><span id="__span-0-982">
</span><span id="__span-0-983">    <span class="k">for</span> <span class="n">pred_scores</span><span class="p">,</span> <span class="n">target_labels</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">predictions</span><span class="p">,</span> <span class="n">targets</span><span class="p">):</span>
</span><span id="__span-0-984">        <span class="n">sorted_labels</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">pred_scores</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">pred_scores</span><span class="p">[</span><span class="n">x</span><span class="p">],</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-0-985">        <span class="n">relevant_set</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">target_labels</span><span class="p">)</span>
</span><span id="__span-0-986">
</span><span id="__span-0-987">        <span class="n">dcg</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="__span-0-988">        <span class="k">for</span> <span class="n">rank</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">sorted_labels</span><span class="p">[:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_k</span><span class="p">],</span> <span class="n">start</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
</span><span id="__span-0-989">            <span class="k">if</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">relevant_set</span><span class="p">:</span>
</span><span id="__span-0-990">                <span class="n">dcg</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">math</span><span class="o">.</span><span class="n">log2</span><span class="p">(</span><span class="n">rank</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="__span-0-991">
</span><span id="__span-0-992">        <span class="n">ideal_dcg</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="__span-0-993">        <span class="k">for</span> <span class="n">rank</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">min</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">relevant_set</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">_k</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
</span><span id="__span-0-994">            <span class="n">ideal_dcg</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">math</span><span class="o">.</span><span class="n">log2</span><span class="p">(</span><span class="n">rank</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="__span-0-995">
</span><span id="__span-0-996">        <span class="n">ndcg</span> <span class="o">=</span> <span class="n">dcg</span> <span class="o">/</span> <span class="n">ideal_dcg</span> <span class="k">if</span> <span class="n">ideal_dcg</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mf">0.0</span>
</span><span id="__span-0-997">        <span class="bp">self</span><span class="o">.</span><span class="n">_ndcgs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ndcg</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.metrics.NDCG.compute" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">compute</span>


<a href="#formed.integrations.ml.metrics.NDCG.compute" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">compute</span><span class="p">()</span>
</span></code></pre></div>

    <div class="doc doc-contents ">


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/metrics.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-999"><span class="k">def</span><span class="w"> </span><span class="nf">compute</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
</span><span id="__span-0-1000">    <span class="n">mean_ndcg</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ndcgs</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ndcgs</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ndcgs</span> <span class="k">else</span> <span class="mf">0.0</span>
</span><span id="__span-0-1001">    <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;ndcg&quot;</span><span class="p">:</span> <span class="n">mean_ndcg</span><span class="p">}</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="formed.integrations.ml.transforms.base" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">formed.integrations.ml.transforms.base</span>


<a href="#formed.integrations.ml.transforms.base" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents first">

        <p>Base classes and utilities for data transformations.</p>
<p>This module provides the core infrastructure for building type-safe, composable
data transformations in machine learning pipelines. It supports both single-instance
and batched processing with strong type guarantees.</p>


<details class="key-components" open>
  <summary>Key Components</summary>
  <ul>
<li>BaseTransform: Abstract base class for all transformations</li>
<li>DataModule: Composable data transformation container</li>
<li>Extra: Descriptor for optional fields (e.g., labels in test data)</li>
<li>Param: Descriptor for non-transformed parameters</li>
<li>register_dataclass: Function to register dataclasses with JAX pytree</li>
</ul>
</details>

<details class="design-patterns" open>
  <summary>Design Patterns</summary>
  <ul>
<li>Descriptor protocol for field access control</li>
<li>Generic type parameters for type safety</li>
<li>Mode-based behavior (AsInstance, AsBatch, AsConverter)</li>
<li>Automatic JAX pytree registration for compatibility with jax.jit/jax.vmap</li>
</ul>
</details>

<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span id="__span-0-1"><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">formed.integrations.ml</span><span class="w"> </span><span class="kn">import</span> <span class="n">DataModule</span><span class="p">,</span> <span class="n">TensorTransform</span><span class="p">,</span> <span class="n">LabelIndexer</span><span class="p">,</span> <span class="n">Extra</span>
</span><span id="__span-0-2"><span class="gp">&gt;&gt;&gt;</span>
</span><span id="__span-0-3"><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span><span class="w"> </span><span class="nc">MyDataModule</span><span class="p">(</span><span class="n">DataModule</span><span class="p">[</span><span class="n">DataModuleModeT</span><span class="p">,</span> <span class="nb">dict</span><span class="p">,</span> <span class="o">...</span><span class="p">]):</span>
</span><span id="__span-0-4"><span class="gp">... </span>    <span class="n">features</span><span class="p">:</span> <span class="n">TensorTransform</span>
</span><span id="__span-0-5"><span class="gp">... </span>    <span class="n">label</span><span class="p">:</span> <span class="n">Extra</span><span class="p">[</span><span class="n">LabelIndexer</span><span class="p">]</span> <span class="o">=</span> <span class="n">Extra</span><span class="o">.</span><span class="n">default</span><span class="p">()</span>
</span><span id="__span-0-6"><span class="gp">&gt;&gt;&gt;</span>
</span><span id="__span-0-7"><span class="gp">&gt;&gt;&gt; </span><span class="n">dm</span> <span class="o">=</span> <span class="n">MyDataModule</span><span class="p">(</span><span class="n">features</span><span class="o">=</span><span class="n">TensorTransform</span><span class="p">(),</span> <span class="n">label</span><span class="o">=</span><span class="n">LabelIndexer</span><span class="p">())</span>
</span><span id="__span-0-8"><span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">dm</span><span class="o">.</span><span class="n">train</span><span class="p">():</span>
</span><span id="__span-0-9"><span class="gp">... </span>    <span class="n">instance</span> <span class="o">=</span> <span class="n">dm</span><span class="o">.</span><span class="n">instance</span><span class="p">({</span><span class="s2">&quot;features&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">],</span> <span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="s2">&quot;positive&quot;</span><span class="p">})</span>
</span><span id="__span-0-10"><span class="gp">&gt;&gt;&gt; </span><span class="n">batch</span> <span class="o">=</span> <span class="n">dm</span><span class="o">.</span><span class="n">batch</span><span class="p">([</span><span class="n">instance1</span><span class="p">,</span> <span class="n">instance2</span><span class="p">,</span> <span class="n">instance3</span><span class="p">])</span>
</span></code></pre></div>


<details class="note" open>
  <summary>Note</summary>
  <p>If JAX is installed, all DataModule instances are automatically registered
as JAX pytrees for compatibility with JAX transformations.</p>
</details>









<div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="formed.integrations.ml.transforms.base.logger" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">logger</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

<a href="#formed.integrations.ml.transforms.base.logger" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="n">logger</span> <span class="o">=</span> <span class="n"><span title="logging.getLogger">getLogger</span></span><span class="p">(</span><span class="n"><span title="__name__">__name__</span></span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>



<div class="doc doc-object doc-class">



<h3 id="formed.integrations.ml.transforms.base.Extra" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">Extra</span>


<a href="#formed.integrations.ml.transforms.base.Extra" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">Extra</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="typing.Generic">Generic</span>[<span title="formed.integrations.ml.transforms.base._BaseTransformT_co">_BaseTransformT_co</span>]</code></p>



        <p>Descriptor marker for optional transformation fields in DataModule.</p>
<p>Extra fields are optional and can be None, which is useful for fields that
may not be present in all data (e.g., labels in test/inference data).
When accessed, Extra fields return the transformed value in instance/batch mode,
or the transform itself in converter mode.</p>


<table>
      <thead>
        <tr>
          <th>
            <span class="doc-section-title">
              CLASS TYPE PARAMETER
            </span>
          </th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>_BaseTransformT_co</code>
            </td>
            <td class="doc-type_param-details">
              <div class="doc-md-description">
                <p>The transform type (covariant).</p>
              </div>
              <p>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span id="__span-0-1"><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span><span class="w"> </span><span class="nc">MyDataModule</span><span class="p">(</span><span class="n">DataModule</span><span class="p">[</span><span class="o">...</span><span class="p">]):</span>
</span><span id="__span-0-2"><span class="gp">... </span>    <span class="n">text</span><span class="p">:</span> <span class="n">Tokenizer</span>
</span><span id="__span-0-3"><span class="gp">... </span>    <span class="n">label</span><span class="p">:</span> <span class="n">Extra</span><span class="p">[</span><span class="n">LabelIndexer</span><span class="p">]</span> <span class="o">=</span> <span class="n">Extra</span><span class="o">.</span><span class="n">default</span><span class="p">()</span>  <span class="c1"># Optional field</span>
</span><span id="__span-0-4"><span class="gp">&gt;&gt;&gt;</span>
</span><span id="__span-0-5"><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Training mode with labels</span>
</span><span id="__span-0-6"><span class="gp">&gt;&gt;&gt; </span><span class="n">train_dm</span> <span class="o">=</span> <span class="n">MyDataModule</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="n">Tokenizer</span><span class="p">(),</span> <span class="n">label</span><span class="o">=</span><span class="n">LabelIndexer</span><span class="p">())</span>
</span><span id="__span-0-7"><span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">train_dm</span><span class="o">.</span><span class="n">train</span><span class="p">():</span>
</span><span id="__span-0-8"><span class="gp">... </span>    <span class="n">instance</span> <span class="o">=</span> <span class="n">train_dm</span><span class="o">.</span><span class="n">instance</span><span class="p">({</span><span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="s2">&quot;hello&quot;</span><span class="p">,</span> <span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="s2">&quot;positive&quot;</span><span class="p">})</span>
</span><span id="__span-0-9"><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">instance</span><span class="o">.</span><span class="n">label</span><span class="p">)</span>  <span class="c1"># Returns the transformed label index</span>
</span><span id="__span-0-10"><span class="gp">&gt;&gt;&gt;</span>
</span><span id="__span-0-11"><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Inference mode without labels</span>
</span><span id="__span-0-12"><span class="gp">&gt;&gt;&gt; </span><span class="n">test_dm</span> <span class="o">=</span> <span class="n">MyDataModule</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="n">Tokenizer</span><span class="p">(),</span> <span class="n">label</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</span><span id="__span-0-13"><span class="gp">&gt;&gt;&gt; </span><span class="n">test_instance</span> <span class="o">=</span> <span class="n">test_dm</span><span class="o">.</span><span class="n">instance</span><span class="p">({</span><span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="s2">&quot;hello&quot;</span><span class="p">})</span>
</span><span id="__span-0-14"><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">test_instance</span><span class="o">.</span><span class="n">label</span><span class="p">)</span>  <span class="c1"># Returns None</span>
</span></code></pre></div>


<details class="note" open>
  <summary>Note</summary>
  <p>Extra is a marker class and cannot be instantiated directly.
Use Extra.default() to provide a default value.</p>
</details>







                  <details class="mkdocstrings-source">
                    <summary>Source code in <code>src/formed/integrations/ml/transforms/base.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">258</span>
<span class="normal">259</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-258"><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-259">    <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Extra is a marker class and cannot be instantiated directly&quot;</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
                  </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.transforms.base.Extra.default" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">default</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#formed.integrations.ml.transforms.base.Extra.default" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">default</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Create a default Extra field with an optional default transform.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>default</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Optional default transform to use if not specified.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="formed.integrations.ml.transforms.base._BaseTransformT">_BaseTransformT</span> | None</code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>None</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;Extra&lt;/span&gt; (&lt;code&gt;formed.integrations.ml.transforms.base.Extra&lt;/code&gt;)" href="#formed.integrations.ml.transforms.base.Extra">Extra</a>[<span title="formed.integrations.ml.transforms.base._BaseTransformT">_BaseTransformT</span>]</code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>An Extra field with the specified default.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/transforms/base.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-226"><span class="nd">@classmethod</span>
</span><span id="__span-0-227"><span class="k">def</span><span class="w"> </span><span class="nf">default</span><span class="p">(</span>
</span><span id="__span-0-228">    <span class="bp">cls</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="s2">&quot;Extra[_BaseTransformT]&quot;</span><span class="p">],</span>
</span><span id="__span-0-229">    <span class="n">default</span><span class="p">:</span> <span class="n">_BaseTransformT</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-230"><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Extra[_BaseTransformT]&quot;</span><span class="p">:</span>
</span><span id="__span-0-231"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a default Extra field with an optional default transform.</span>
</span><span id="__span-0-232">
</span><span id="__span-0-233"><span class="sd">    Args:</span>
</span><span id="__span-0-234"><span class="sd">        default: Optional default transform to use if not specified.</span>
</span><span id="__span-0-235">
</span><span id="__span-0-236"><span class="sd">    Returns:</span>
</span><span id="__span-0-237"><span class="sd">        An Extra field with the specified default.</span>
</span><span id="__span-0-238">
</span><span id="__span-0-239"><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-240">    <span class="k">return</span> <span class="n">cast</span><span class="p">(</span><span class="n">Extra</span><span class="p">[</span><span class="n">_BaseTransformT</span><span class="p">],</span> <span class="n">default</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.transforms.base.Extra.default_factory" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">default_factory</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#formed.integrations.ml.transforms.base.Extra.default_factory" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">default_factory</span><span class="p">(</span><span class="n">factory</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Create a factory for an Extra field with an optional default transform.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>factory</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>A callable that returns the default transform.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="collections.abc.Callable">Callable</span>[[], <span title="formed.integrations.ml.transforms.base._BaseTransformT">_BaseTransformT</span> | None]</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="collections.abc.Callable">Callable</span>[[], <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;Extra&lt;/span&gt; (&lt;code&gt;formed.integrations.ml.transforms.base.Extra&lt;/code&gt;)" href="#formed.integrations.ml.transforms.base.Extra">Extra</a>[<span title="formed.integrations.ml.transforms.base._BaseTransformT">_BaseTransformT</span>]]</code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>A factory callable for creating Extra fields.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/transforms/base.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-242"><span class="nd">@classmethod</span>
</span><span id="__span-0-243"><span class="k">def</span><span class="w"> </span><span class="nf">default_factory</span><span class="p">(</span>
</span><span id="__span-0-244">    <span class="bp">cls</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="s2">&quot;Extra[_BaseTransformT]&quot;</span><span class="p">],</span>
</span><span id="__span-0-245">    <span class="n">factory</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[],</span> <span class="n">_BaseTransformT</span> <span class="o">|</span> <span class="kc">None</span><span class="p">],</span>
</span><span id="__span-0-246"><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">[[],</span> <span class="s2">&quot;Extra[_BaseTransformT]&quot;</span><span class="p">]:</span>
</span><span id="__span-0-247"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a factory for an Extra field with an optional default transform.</span>
</span><span id="__span-0-248">
</span><span id="__span-0-249"><span class="sd">    Args:</span>
</span><span id="__span-0-250"><span class="sd">        factory: A callable that returns the default transform.</span>
</span><span id="__span-0-251">
</span><span id="__span-0-252"><span class="sd">    Returns:</span>
</span><span id="__span-0-253"><span class="sd">        A factory callable for creating Extra fields.</span>
</span><span id="__span-0-254">
</span><span id="__span-0-255"><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-256">    <span class="k">return</span> <span class="n">cast</span><span class="p">(</span><span class="n">Callable</span><span class="p">[[],</span> <span class="n">Extra</span><span class="p">[</span><span class="n">_BaseTransformT</span><span class="p">]],</span> <span class="n">factory</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="formed.integrations.ml.transforms.base.Param" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">Param</span>


<a href="#formed.integrations.ml.transforms.base.Param" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">Param</span><span class="p">()</span>
</span></code></pre></div>

    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="typing.Generic">Generic</span>[<span title="formed.integrations.ml.transforms.base._T_co">_T_co</span>]</code></p>



        <p>Descriptor marker for non-transformed parameter fields in DataModule.</p>
<p>Param fields represent parameters that pass through unchanged during instance/batch
conversion. They are not transformed but remain accessible in all modes.
This is useful for hyperparameters, configuration values, or other metadata
that should be available but not processed.</p>


<table>
      <thead>
        <tr>
          <th>
            <span class="doc-section-title">
              CLASS TYPE PARAMETER
            </span>
          </th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>_T_co</code>
            </td>
            <td class="doc-type_param-details">
              <div class="doc-md-description">
                <p>The parameter type (covariant).</p>
              </div>
              <p>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span id="__span-0-1"><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span><span class="w"> </span><span class="nc">MyDataModule</span><span class="p">(</span><span class="n">DataModule</span><span class="p">[</span><span class="o">...</span><span class="p">]):</span>
</span><span id="__span-0-2"><span class="gp">... </span>    <span class="n">text</span><span class="p">:</span> <span class="n">Tokenizer</span>
</span><span id="__span-0-3"><span class="gp">... </span>    <span class="n">max_length</span><span class="p">:</span> <span class="n">Param</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Param</span><span class="o">.</span><span class="n">default</span><span class="p">(</span><span class="mi">128</span><span class="p">)</span>
</span><span id="__span-0-4"><span class="gp">... </span>    <span class="n">temperature</span><span class="p">:</span> <span class="n">Param</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="n">Param</span><span class="o">.</span><span class="n">default</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>
</span><span id="__span-0-5"><span class="gp">&gt;&gt;&gt;</span>
</span><span id="__span-0-6"><span class="gp">&gt;&gt;&gt; </span><span class="n">dm</span> <span class="o">=</span> <span class="n">MyDataModule</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="n">Tokenizer</span><span class="p">(),</span> <span class="n">max_length</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span> <span class="n">temperature</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
</span><span id="__span-0-7"><span class="gp">&gt;&gt;&gt; </span><span class="n">instance</span> <span class="o">=</span> <span class="n">dm</span><span class="o">.</span><span class="n">instance</span><span class="p">({</span><span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="s2">&quot;hello&quot;</span><span class="p">})</span>
</span><span id="__span-0-8"><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">instance</span><span class="o">.</span><span class="n">max_length</span><span class="p">)</span>  <span class="c1"># Returns 256 (unchanged)</span>
</span><span id="__span-0-9"><span class="gp">&gt;&gt;&gt; </span><span class="n">batch</span> <span class="o">=</span> <span class="n">dm</span><span class="o">.</span><span class="n">batch</span><span class="p">([</span><span class="n">instance1</span><span class="p">,</span> <span class="n">instance2</span><span class="p">])</span>
</span><span id="__span-0-10"><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">batch</span><span class="o">.</span><span class="n">max_length</span><span class="p">)</span>  <span class="c1"># Still returns 256</span>
</span></code></pre></div>


<details class="note" open>
  <summary>Note</summary>
  <p>Param is a marker class and cannot be instantiated directly.
Use <code>Param.default()</code> or <code>Param.default_factory()</code> to provide defaults.</p>
</details>







                  <details class="mkdocstrings-source">
                    <summary>Source code in <code>src/formed/integrations/ml/transforms/base.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">369</span>
<span class="normal">370</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-369"><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-370">    <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Param is a marker class and cannot be instantiated directly&quot;</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
                  </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.transforms.base.Param.default" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">default</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#formed.integrations.ml.transforms.base.Param.default" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">default</span><span class="p">(</span><span class="n">default</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Create a Param field with a default value.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>default</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The default value for this parameter.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="formed.integrations.ml.transforms.base._T">_T</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;Param&lt;/span&gt; (&lt;code&gt;formed.integrations.ml.transforms.base.Param&lt;/code&gt;)" href="#formed.integrations.ml.transforms.base.Param">Param</a>[<span title="formed.integrations.ml.transforms.base._T">_T</span>]</code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>A Param field with the specified default.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/transforms/base.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-328"><span class="nd">@classmethod</span>
</span><span id="__span-0-329"><span class="k">def</span><span class="w"> </span><span class="nf">default</span><span class="p">(</span><span class="bp">cls</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="s2">&quot;Param[_T]&quot;</span><span class="p">],</span> <span class="n">default</span><span class="p">:</span> <span class="n">_T</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Param[_T]&quot;</span><span class="p">:</span>
</span><span id="__span-0-330"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a Param field with a default value.</span>
</span><span id="__span-0-331">
</span><span id="__span-0-332"><span class="sd">    Args:</span>
</span><span id="__span-0-333"><span class="sd">        default: The default value for this parameter.</span>
</span><span id="__span-0-334">
</span><span id="__span-0-335"><span class="sd">    Returns:</span>
</span><span id="__span-0-336"><span class="sd">        A Param field with the specified default.</span>
</span><span id="__span-0-337">
</span><span id="__span-0-338"><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-339">    <span class="k">return</span> <span class="n">cast</span><span class="p">(</span><span class="n">Param</span><span class="p">[</span><span class="n">_T</span><span class="p">],</span> <span class="n">default</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.transforms.base.Param.cast" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">cast</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#formed.integrations.ml.transforms.base.Param.cast" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">cast</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Wrap a value as a Param field.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>value</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The value to wrap as a Param.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="formed.integrations.ml.transforms.base._T">_T</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>
        <p>Returns:
    A Param field wrapping the given value.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/transforms/base.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-341"><span class="nd">@classmethod</span>
</span><span id="__span-0-342"><span class="k">def</span><span class="w"> </span><span class="nf">cast</span><span class="p">(</span><span class="bp">cls</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="s2">&quot;Param[_T]&quot;</span><span class="p">],</span> <span class="n">value</span><span class="p">:</span> <span class="n">_T</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Param[_T]&quot;</span><span class="p">:</span>
</span><span id="__span-0-343"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Wrap a value as a Param field.</span>
</span><span id="__span-0-344">
</span><span id="__span-0-345"><span class="sd">    Args:</span>
</span><span id="__span-0-346"><span class="sd">        value: The value to wrap as a Param.</span>
</span><span id="__span-0-347"><span class="sd">    Returns:</span>
</span><span id="__span-0-348"><span class="sd">        A Param field wrapping the given value.</span>
</span><span id="__span-0-349">
</span><span id="__span-0-350"><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-351">    <span class="k">return</span> <span class="n">cast</span><span class="p">(</span><span class="n">Param</span><span class="p">[</span><span class="n">_T</span><span class="p">],</span> <span class="n">value</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.transforms.base.Param.default_factory" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">default_factory</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#formed.integrations.ml.transforms.base.Param.default_factory" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">default_factory</span><span class="p">(</span><span class="n">factory</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Create a Param field with a default factory function.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>factory</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>A callable that returns the default value.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="collections.abc.Callable">Callable</span>[[], <span title="formed.integrations.ml.transforms.base._T">_T</span>]</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="collections.abc.Callable">Callable</span>[[], <a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;Param&lt;/span&gt; (&lt;code&gt;formed.integrations.ml.transforms.base.Param&lt;/code&gt;)" href="#formed.integrations.ml.transforms.base.Param">Param</a>[<span title="formed.integrations.ml.transforms.base._T">_T</span>]]</code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>A factory callable for creating Param fields.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/transforms/base.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-353"><span class="nd">@classmethod</span>
</span><span id="__span-0-354"><span class="k">def</span><span class="w"> </span><span class="nf">default_factory</span><span class="p">(</span>
</span><span id="__span-0-355">    <span class="bp">cls</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="s2">&quot;Param[_T]&quot;</span><span class="p">],</span>
</span><span id="__span-0-356">    <span class="n">factory</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[],</span> <span class="n">_T</span><span class="p">],</span>
</span><span id="__span-0-357"><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">[[],</span> <span class="s2">&quot;Param[_T]&quot;</span><span class="p">]:</span>
</span><span id="__span-0-358"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a Param field with a default factory function.</span>
</span><span id="__span-0-359">
</span><span id="__span-0-360"><span class="sd">    Args:</span>
</span><span id="__span-0-361"><span class="sd">        factory: A callable that returns the default value.</span>
</span><span id="__span-0-362">
</span><span id="__span-0-363"><span class="sd">    Returns:</span>
</span><span id="__span-0-364"><span class="sd">        A factory callable for creating Param fields.</span>
</span><span id="__span-0-365">
</span><span id="__span-0-366"><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-367">    <span class="k">return</span> <span class="n">cast</span><span class="p">(</span><span class="n">Callable</span><span class="p">[[],</span> <span class="n">Param</span><span class="p">[</span><span class="n">_T</span><span class="p">]],</span> <span class="n">factory</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="formed.integrations.ml.transforms.base.BaseTransformMeta" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">BaseTransformMeta</span>


<a href="#formed.integrations.ml.transforms.base.BaseTransformMeta" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="abc.ABCMeta">ABCMeta</span></code></p>













<div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="formed.integrations.ml.transforms.base.BaseTransform" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">BaseTransform</span>


<a href="#formed.integrations.ml.transforms.base.BaseTransform" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="colt.Registrable">Registrable</span></code>, <code><span title="typing.Generic">Generic</span>[<span title="formed.integrations.ml.transforms.base._S">_S</span>, <span title="formed.integrations.ml.transforms.base._T">_T</span>, <span title="formed.integrations.ml.types.InstanceT_co">InstanceT_co</span>, <span title="formed.integrations.ml.types.BatchT_co">BatchT_co</span>]</code>, <code><span title="abc.ABC">ABC</span></code></p>



        <p>Abstract base class for data transformations.</p>
<p>BaseTransform provides a two-stage transformation pipeline:
1. Instance transformation: Convert raw data to per-instance representation
2. Batch transformation: Collate multiple instances into batched tensors</p>
<p>The class uses descriptors for flexible field access and supports training/inference
modes for stateful transformations (e.g., vocabulary building).</p>


<table>
      <thead>
        <tr>
          <th>
            <span class="doc-section-title">
              CLASS TYPE PARAMETER
            </span>
          </th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>_S</code>
            </td>
            <td class="doc-type_param-details">
              <div class="doc-md-description">
                <p>Source data type before accessor is applied</p>
              </div>
              <p>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>_T</code>
            </td>
            <td class="doc-type_param-details">
              <div class="doc-md-description">
                <p>Target data type after accessor is applied</p>
              </div>
              <p>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>InstanceT_co</code>
            </td>
            <td class="doc-type_param-details">
              <div class="doc-md-description">
                <p>Instance representation type (covariant)</p>
              </div>
              <p>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>BatchT_co</code>
            </td>
            <td class="doc-type_param-details">
              <div class="doc-md-description">
                <p>Batch representation type (covariant)</p>
              </div>
              <p>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">ATTRIBUTE</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-attribute&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-attribute-name&quot;&gt;accessor&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-class-attribute&quot;&gt;&lt;code&gt;class-attribute&lt;/code&gt;&lt;/small&gt;
      &lt;small class=&quot;doc doc-label doc-label-instance-attribute&quot;&gt;&lt;code&gt;instance-attribute&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;formed.integrations.ml.transforms.base.BaseTransform.accessor&lt;/code&gt;)" href="#formed.integrations.ml.transforms.base.BaseTransform.accessor">accessor</a></code></td>
            <td class="doc-attribute-details">
              <div class="doc-md-description">
                <p>Optional accessor to extract the relevant field from input data.
      Can be a string (attribute/key name) or a callable.</p>
              </div>
              <p>
                  <span class="doc-attribute-annotation">
                    <b>TYPE:</b>
                      <code><span title="str">str</span> | <span title="collections.abc.Callable">Callable</span>[[<span title="formed.integrations.ml.transforms.base._S">_S</span>], <span title="formed.integrations.ml.transforms.base._T">_T</span>] | None</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<details class="class-attributes" open>
  <summary>Class Attributes</summary>
  <p><strong>is_static</strong>: If True, indicates the batched value is static for JAX.
<strong>process_parent</strong>: If True, the accessor receives the entire parent object.</p>
</details>

<details class="abstract-methods" open>
  <summary>Abstract Methods</summary>
  <p>instance: Transform a single data point to its instance representation.
batch: Collate a sequence of instances into a batched representation.</p>
</details>

<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span id="__span-0-1"><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span><span class="w"> </span><span class="nc">LowercaseTransform</span><span class="p">(</span><span class="n">BaseTransform</span><span class="p">[</span><span class="nb">dict</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]):</span>
</span><span id="__span-0-2"><span class="gp">... </span>    <span class="k">def</span><span class="w"> </span><span class="nf">instance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="__span-0-3"><span class="gp">... </span>        <span class="k">return</span> <span class="n">text</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
</span><span id="__span-0-4"><span class="gp">...</span>
</span><span id="__span-0-5"><span class="gp">... </span>    <span class="k">def</span><span class="w"> </span><span class="nf">batch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">instances</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="__span-0-6"><span class="gp">... </span>        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
</span><span id="__span-0-7"><span class="gp">&gt;&gt;&gt;</span>
</span><span id="__span-0-8"><span class="gp">&gt;&gt;&gt; </span><span class="n">transform</span> <span class="o">=</span> <span class="n">LowercaseTransform</span><span class="p">(</span><span class="n">accessor</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">)</span>
</span><span id="__span-0-9"><span class="gp">&gt;&gt;&gt; </span><span class="n">instance</span> <span class="o">=</span> <span class="n">transform</span><span class="p">({</span><span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="s2">&quot;HELLO&quot;</span><span class="p">})</span>  <span class="c1"># Returns &quot;hello&quot;</span>
</span><span id="__span-0-10"><span class="gp">&gt;&gt;&gt; </span><span class="n">batch</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">batch</span><span class="p">([</span><span class="s2">&quot;hello&quot;</span><span class="p">,</span> <span class="s2">&quot;world&quot;</span><span class="p">])</span>  <span class="c1"># Returns [&quot;hello&quot;, &quot;world&quot;]</span>
</span></code></pre></div>


<details class="note" open>
  <summary>Note</summary>
  <ul>
<li>Subclasses are automatically converted to dataclasses via metaclass.</li>
<li>Use the <code>train()</code> context manager for stateful transformations.</li>
<li>Supports saving/loading with cloudpickle for persistence.</li>
</ul>
</details>










<div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="formed.integrations.ml.transforms.base.BaseTransform.accessor" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">accessor</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#formed.integrations.ml.transforms.base.BaseTransform.accessor" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="n">accessor</span> <span class="o">=</span> <span class="kc">None</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>




<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.transforms.base.BaseTransform.instance" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">instance</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

<a href="#formed.integrations.ml.transforms.base.BaseTransform.instance" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">instance</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Transform a single data point to its instance representation.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>obj</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The input data after accessor extraction.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="formed.integrations.ml.transforms.base._T">_T</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="formed.integrations.ml.types.InstanceT_co">InstanceT_co</span></code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>The transformed instance representation.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Note</summary>
  <p>This method is called for each individual data point.</p>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/transforms/base.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-484"><span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
</span><span id="__span-0-485"><span class="k">def</span><span class="w"> </span><span class="nf">instance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">:</span> <span class="n">_T</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">InstanceT_co</span><span class="p">:</span>
</span><span id="__span-0-486"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Transform a single data point to its instance representation.</span>
</span><span id="__span-0-487">
</span><span id="__span-0-488"><span class="sd">    Args:</span>
</span><span id="__span-0-489"><span class="sd">        obj: The input data after accessor extraction.</span>
</span><span id="__span-0-490">
</span><span id="__span-0-491"><span class="sd">    Returns:</span>
</span><span id="__span-0-492"><span class="sd">        The transformed instance representation.</span>
</span><span id="__span-0-493">
</span><span id="__span-0-494"><span class="sd">    Note:</span>
</span><span id="__span-0-495"><span class="sd">        This method is called for each individual data point.</span>
</span><span id="__span-0-496">
</span><span id="__span-0-497"><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-498">    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;Subclasses must implement this method&quot;</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.transforms.base.BaseTransform.batch" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">batch</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

<a href="#formed.integrations.ml.transforms.base.BaseTransform.batch" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">batch</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Collate multiple instances into a batched representation.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>batch</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>A sequence of instance representations from <code>instance()</code>.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="collections.abc.Sequence">Sequence</span>[<span title="formed.integrations.ml.types.InstanceT_co">InstanceT_co</span>]</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="formed.integrations.ml.types.BatchT_co">BatchT_co</span></code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>The batched representation, typically as tensors or arrays.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Note</summary>
  <p>This method should handle padding, stacking, or other batching logic.</p>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/transforms/base.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-500"><span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
</span><span id="__span-0-501"><span class="k">def</span><span class="w"> </span><span class="nf">batch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">InstanceT_co</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BatchT_co</span><span class="p">:</span>
</span><span id="__span-0-502"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Collate multiple instances into a batched representation.</span>
</span><span id="__span-0-503">
</span><span id="__span-0-504"><span class="sd">    Args:</span>
</span><span id="__span-0-505"><span class="sd">        batch: A sequence of instance representations from `instance()`.</span>
</span><span id="__span-0-506">
</span><span id="__span-0-507"><span class="sd">    Returns:</span>
</span><span id="__span-0-508"><span class="sd">        The batched representation, typically as tensors or arrays.</span>
</span><span id="__span-0-509">
</span><span id="__span-0-510"><span class="sd">    Note:</span>
</span><span id="__span-0-511"><span class="sd">        This method should handle padding, stacking, or other batching logic.</span>
</span><span id="__span-0-512">
</span><span id="__span-0-513"><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-514">    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;Subclasses must implement this method&quot;</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.transforms.base.BaseTransform.train" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">train</span>


<a href="#formed.integrations.ml.transforms.base.BaseTransform.train" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">train</span><span class="p">()</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Context manager to enable training mode for stateful transformations.</p>
<p>In training mode, transforms can build state (e.g., vocabularies, statistics)
from the training data. Hooks <code>_on_start_training()</code> and <code>_on_end_training()</code>
are called at the beginning and end of the training context.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">YIELDS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-yields-annotation">
                    <code>None</code>
                </span>
            </td>
            <td class="doc-yields-details">
              <div class="doc-md-description">
                <p>None</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span id="__span-0-1"><span class="gp">&gt;&gt;&gt; </span><span class="n">indexer</span> <span class="o">=</span> <span class="n">TokenSequenceIndexer</span><span class="p">()</span>
</span><span id="__span-0-2"><span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">indexer</span><span class="o">.</span><span class="n">train</span><span class="p">():</span>
</span><span id="__span-0-3"><span class="gp">... </span>    <span class="c1"># Build vocabulary from training data</span>
</span><span id="__span-0-4"><span class="gp">... </span>    <span class="n">tokens1</span> <span class="o">=</span> <span class="n">indexer</span><span class="o">.</span><span class="n">instance</span><span class="p">([</span><span class="s2">&quot;hello&quot;</span><span class="p">,</span> <span class="s2">&quot;world&quot;</span><span class="p">])</span>
</span><span id="__span-0-5"><span class="gp">... </span>    <span class="n">tokens2</span> <span class="o">=</span> <span class="n">indexer</span><span class="o">.</span><span class="n">instance</span><span class="p">([</span><span class="s2">&quot;hello&quot;</span><span class="p">,</span> <span class="s2">&quot;there&quot;</span><span class="p">])</span>
</span><span id="__span-0-6"><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Vocabulary is now frozen, use for inference</span>
</span><span id="__span-0-7"><span class="gp">&gt;&gt;&gt; </span><span class="n">test_tokens</span> <span class="o">=</span> <span class="n">indexer</span><span class="o">.</span><span class="n">instance</span><span class="p">([</span><span class="s2">&quot;hello&quot;</span><span class="p">,</span> <span class="s2">&quot;unknown&quot;</span><span class="p">])</span>
</span></code></pre></div>


<details class="note" open>
  <summary>Note</summary>
  <p>Training mode is reentrant but nested calls won't trigger hooks again.</p>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/transforms/base.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-596"><span class="nd">@contextmanager</span>
</span><span id="__span-0-597"><span class="k">def</span><span class="w"> </span><span class="nf">train</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="kc">None</span><span class="p">]:</span>
</span><span id="__span-0-598"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Context manager to enable training mode for stateful transformations.</span>
</span><span id="__span-0-599">
</span><span id="__span-0-600"><span class="sd">    In training mode, transforms can build state (e.g., vocabularies, statistics)</span>
</span><span id="__span-0-601"><span class="sd">    from the training data. Hooks `_on_start_training()` and `_on_end_training()`</span>
</span><span id="__span-0-602"><span class="sd">    are called at the beginning and end of the training context.</span>
</span><span id="__span-0-603">
</span><span id="__span-0-604"><span class="sd">    Yields:</span>
</span><span id="__span-0-605"><span class="sd">        None</span>
</span><span id="__span-0-606">
</span><span id="__span-0-607"><span class="sd">    Examples:</span>
</span><span id="__span-0-608"><span class="sd">        &gt;&gt;&gt; indexer = TokenSequenceIndexer()</span>
</span><span id="__span-0-609"><span class="sd">        &gt;&gt;&gt; with indexer.train():</span>
</span><span id="__span-0-610"><span class="sd">        ...     # Build vocabulary from training data</span>
</span><span id="__span-0-611"><span class="sd">        ...     tokens1 = indexer.instance([&quot;hello&quot;, &quot;world&quot;])</span>
</span><span id="__span-0-612"><span class="sd">        ...     tokens2 = indexer.instance([&quot;hello&quot;, &quot;there&quot;])</span>
</span><span id="__span-0-613"><span class="sd">        &gt;&gt;&gt; # Vocabulary is now frozen, use for inference</span>
</span><span id="__span-0-614"><span class="sd">        &gt;&gt;&gt; test_tokens = indexer.instance([&quot;hello&quot;, &quot;unknown&quot;])</span>
</span><span id="__span-0-615">
</span><span id="__span-0-616"><span class="sd">    Note:</span>
</span><span id="__span-0-617"><span class="sd">        Training mode is reentrant but nested calls won&#39;t trigger hooks again.</span>
</span><span id="__span-0-618">
</span><span id="__span-0-619"><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-620">    <span class="n">original</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_training</span>
</span><span id="__span-0-621">    <span class="bp">self</span><span class="o">.</span><span class="n">_training</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="__span-0-622">    <span class="k">try</span><span class="p">:</span>
</span><span id="__span-0-623">        <span class="k">if</span> <span class="ow">not</span> <span class="n">original</span><span class="p">:</span>
</span><span id="__span-0-624">            <span class="bp">self</span><span class="o">.</span><span class="n">_on_start_training</span><span class="p">()</span>
</span><span id="__span-0-625">        <span class="k">yield</span>
</span><span id="__span-0-626">        <span class="k">if</span> <span class="ow">not</span> <span class="n">original</span><span class="p">:</span>
</span><span id="__span-0-627">            <span class="bp">self</span><span class="o">.</span><span class="n">_on_end_training</span><span class="p">()</span>
</span><span id="__span-0-628">    <span class="k">finally</span><span class="p">:</span>
</span><span id="__span-0-629">        <span class="bp">self</span><span class="o">.</span><span class="n">_training</span> <span class="o">=</span> <span class="n">original</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.transforms.base.BaseTransform.save" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">save</span>


<a href="#formed.integrations.ml.transforms.base.BaseTransform.save" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">save</span><span class="p">(</span><span class="n">directory</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Save the transform to a directory using cloudpickle.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>directory</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Directory path to save the transform.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="str">str</span> | <span title="os.PathLike">PathLike</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Note</summary>
  <p>The transform is saved as 'transform.pkl' in the specified directory.
cloudpickle is used to handle complex objects like lambdas and closures.</p>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/transforms/base.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-631"><span class="k">def</span><span class="w"> </span><span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">directory</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">PathLike</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-632"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Save the transform to a directory using cloudpickle.</span>
</span><span id="__span-0-633">
</span><span id="__span-0-634"><span class="sd">    Args:</span>
</span><span id="__span-0-635"><span class="sd">        directory: Directory path to save the transform.</span>
</span><span id="__span-0-636">
</span><span id="__span-0-637"><span class="sd">    Note:</span>
</span><span id="__span-0-638"><span class="sd">        The transform is saved as &#39;transform.pkl&#39; in the specified directory.</span>
</span><span id="__span-0-639"><span class="sd">        cloudpickle is used to handle complex objects like lambdas and closures.</span>
</span><span id="__span-0-640">
</span><span id="__span-0-641"><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-642">    <span class="n">filepath</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">directory</span><span class="p">)</span> <span class="o">/</span> <span class="s2">&quot;transform.pkl&quot;</span>
</span><span id="__span-0-643">    <span class="k">with</span> <span class="n">filepath</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="__span-0-644">        <span class="n">cloudpickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.transforms.base.BaseTransform.load" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">load</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#formed.integrations.ml.transforms.base.BaseTransform.load" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">load</span><span class="p">(</span><span class="n">directory</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Load a transform from a directory.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>directory</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Directory path containing the saved transform.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="str">str</span> | <span title="os.PathLike">PathLike</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="typing.Self">Self</span></code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>The loaded transform instance.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RAISES</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
              <span class="doc-raises-annotation">
                  <code><span title="TypeError">TypeError</span></code>
              </span>
            </td>
            <td class="doc-raises-details">
              <div class="doc-md-description">
                <p>If the loaded object is not an instance of this class.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Note</summary>
  <p>Expects a 'transform.pkl' file in the specified directory.</p>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/transforms/base.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-646"><span class="nd">@classmethod</span>
</span><span id="__span-0-647"><span class="k">def</span><span class="w"> </span><span class="nf">load</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">directory</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">PathLike</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
</span><span id="__span-0-648"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Load a transform from a directory.</span>
</span><span id="__span-0-649">
</span><span id="__span-0-650"><span class="sd">    Args:</span>
</span><span id="__span-0-651"><span class="sd">        directory: Directory path containing the saved transform.</span>
</span><span id="__span-0-652">
</span><span id="__span-0-653"><span class="sd">    Returns:</span>
</span><span id="__span-0-654"><span class="sd">        The loaded transform instance.</span>
</span><span id="__span-0-655">
</span><span id="__span-0-656"><span class="sd">    Raises:</span>
</span><span id="__span-0-657"><span class="sd">        TypeError: If the loaded object is not an instance of this class.</span>
</span><span id="__span-0-658">
</span><span id="__span-0-659"><span class="sd">    Note:</span>
</span><span id="__span-0-660"><span class="sd">        Expects a &#39;transform.pkl&#39; file in the specified directory.</span>
</span><span id="__span-0-661">
</span><span id="__span-0-662"><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-663">    <span class="n">filepath</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">directory</span><span class="p">)</span> <span class="o">/</span> <span class="s2">&quot;transform.pkl&quot;</span>
</span><span id="__span-0-664">    <span class="k">with</span> <span class="n">filepath</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="__span-0-665">        <span class="n">obj</span> <span class="o">=</span> <span class="n">cloudpickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</span><span id="__span-0-666">    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="bp">cls</span><span class="p">):</span>
</span><span id="__span-0-667">        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Loaded object is not an instance of </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-0-668">    <span class="k">return</span> <span class="n">obj</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="formed.integrations.ml.transforms.base.DataModule" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">DataModule</span>


<a href="#formed.integrations.ml.transforms.base.DataModule" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;BaseTransform&lt;/span&gt; (&lt;code&gt;formed.integrations.ml.transforms.base.BaseTransform&lt;/code&gt;)" href="#formed.integrations.ml.transforms.base.BaseTransform">BaseTransform</a>[<span title="formed.integrations.ml.transforms.base._T">_T</span>, <span title="formed.integrations.ml.transforms.base._T">_T</span>, <span title="formed.integrations.ml.transforms.base._InstanceT">_InstanceT</span>, <span title="formed.integrations.ml.transforms.base._BatchT">_BatchT</span>]</code>, <code><span title="typing.Generic">Generic</span>[<span title="formed.integrations.ml.transforms.base._DataModuleModeT_co">_DataModuleModeT_co</span>, <span title="formed.integrations.ml.transforms.base._T">_T</span>, <span title="formed.integrations.ml.transforms.base._InstanceT">_InstanceT</span>, <span title="formed.integrations.ml.transforms.base._BatchT">_BatchT</span>]</code></p>



        <p>Composable container for multiple data transformations with mode-based behavior.</p>
<p>DataModule orchestrates multiple BaseTransform fields and switches between three modes:
- AsConverter: Configuration mode, holds transform logic
- AsInstance: Single data point after per-instance transformation
- AsBatch: Multiple instances collated into batched tensors</p>
<p>This enables a single class definition to represent raw data, transformed instances,
and batched tensors with full type safety.</p>


<table>
      <thead>
        <tr>
          <th>
            <span class="doc-section-title">
              CLASS TYPE PARAMETER
            </span>
          </th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>_DataModuleModeT_co</code>
            </td>
            <td class="doc-type_param-details">
              <div class="doc-md-description">
                <p>Current mode (AsConverter, AsInstance, or AsBatch)</p>
              </div>
              <p>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>_T</code>
            </td>
            <td class="doc-type_param-details">
              <div class="doc-md-description">
                <p>Input data type</p>
              </div>
              <p>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>_InstanceT</code>
            </td>
            <td class="doc-type_param-details">
              <div class="doc-md-description">
                <p>Instance mode type (self when mode=AsInstance)</p>
              </div>
              <p>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>_BatchT</code>
            </td>
            <td class="doc-type_param-details">
              <div class="doc-md-description">
                <p>Batch mode type (self when mode=AsBatch)</p>
              </div>
              <p>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<details class="field-types" open>
  <summary>Field Types</summary>
  <ul>
<li>Regular fields: BaseTransform subclasses that transform data</li>
<li>Extra fields: Optional transforms (e.g., labels for test data)</li>
<li>Param fields: Non-transformed parameters that pass through unchanged</li>
</ul>
</details>

<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span id="__span-0-1"><span class="gp">&gt;&gt;&gt; </span><span class="nd">@dataclasses</span><span class="o">.</span><span class="n">dataclass</span>
</span><span id="__span-0-2"><span class="gp">... </span><span class="k">class</span><span class="w"> </span><span class="nc">TextExamples</span><span class="p">:</span>
</span><span id="__span-0-3"><span class="gp">... </span>    <span class="n">text</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-0-4"><span class="gp">... </span>    <span class="n">label</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="__span-0-5"><span class="gp">&gt;&gt;&gt;</span>
</span><span id="__span-0-6"><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span><span class="w"> </span><span class="nc">TextDataModule</span><span class="p">(</span><span class="n">DataModule</span><span class="p">[</span><span class="n">DataModuleModeT</span><span class="p">,</span> <span class="n">TextExample</span><span class="p">,</span> <span class="o">...</span><span class="p">]):</span>
</span><span id="__span-0-7"><span class="gp">... </span>    <span class="n">text</span><span class="p">:</span> <span class="n">Tokenizer</span>
</span><span id="__span-0-8"><span class="gp">... </span>    <span class="n">label</span><span class="p">:</span> <span class="n">Extra</span><span class="p">[</span><span class="n">LabelIndexer</span><span class="p">]</span> <span class="o">=</span> <span class="n">Extra</span><span class="o">.</span><span class="n">default</span><span class="p">()</span>
</span><span id="__span-0-9"><span class="gp">&gt;&gt;&gt;</span>
</span><span id="__span-0-10"><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create converter (configuration)</span>
</span><span id="__span-0-11"><span class="gp">&gt;&gt;&gt; </span><span class="n">dm</span> <span class="o">=</span> <span class="n">TextDataModule</span><span class="p">(</span>
</span><span id="__span-0-12"><span class="gp">... </span>    <span class="n">text</span><span class="o">=</span><span class="n">Tokenizer</span><span class="p">(</span><span class="n">surfaces</span><span class="o">=</span><span class="n">TokenSequenceIndexer</span><span class="p">()),</span>
</span><span id="__span-0-13"><span class="gp">... </span>    <span class="n">label</span><span class="o">=</span><span class="n">LabelIndexer</span><span class="p">()</span>
</span><span id="__span-0-14"><span class="gp">... </span><span class="p">)</span>
</span><span id="__span-0-15"><span class="gp">&gt;&gt;&gt;</span>
</span><span id="__span-0-16"><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Training: build vocabularies</span>
</span><span id="__span-0-17"><span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">dm</span><span class="o">.</span><span class="n">train</span><span class="p">():</span>
</span><span id="__span-0-18"><span class="gp">... </span>    <span class="n">train_instances</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="__span-0-19"><span class="gp">... </span>        <span class="n">dm</span><span class="o">.</span><span class="n">instance</span><span class="p">(</span><span class="n">TextExample</span><span class="p">(</span><span class="s2">&quot;hello world&quot;</span><span class="p">,</span> <span class="s2">&quot;positive&quot;</span><span class="p">))</span>
</span><span id="__span-0-20"><span class="gp">... </span>        <span class="k">for</span> <span class="n">example</span> <span class="ow">in</span> <span class="n">train_data</span>
</span><span id="__span-0-21"><span class="gp">... </span>    <span class="p">]</span>
</span><span id="__span-0-22"><span class="gp">&gt;&gt;&gt;</span>
</span><span id="__span-0-23"><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create batches</span>
</span><span id="__span-0-24"><span class="gp">&gt;&gt;&gt; </span><span class="n">batch</span> <span class="o">=</span> <span class="n">dm</span><span class="o">.</span><span class="n">batch</span><span class="p">(</span><span class="n">train_instances</span><span class="p">[:</span><span class="mi">32</span><span class="p">])</span>
</span><span id="__span-0-25"><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">batch</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">surfaces</span><span class="o">.</span><span class="n">ids</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>  <span class="c1"># (32, max_length)</span>
</span><span id="__span-0-26"><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">batch</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>  <span class="c1"># (32,)</span>
</span><span id="__span-0-27"><span class="gp">&gt;&gt;&gt;</span>
</span><span id="__span-0-28"><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Inference without labels</span>
</span><span id="__span-0-29"><span class="gp">&gt;&gt;&gt; </span><span class="n">test_dm</span> <span class="o">=</span> <span class="n">TextDataModule</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="n">dm</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</span><span id="__span-0-30"><span class="gp">&gt;&gt;&gt; </span><span class="n">test_instance</span> <span class="o">=</span> <span class="n">test_dm</span><span class="o">.</span><span class="n">instance</span><span class="p">(</span><span class="n">TextExample</span><span class="p">(</span><span class="s2">&quot;test sentence&quot;</span><span class="p">))</span>
</span><span id="__span-0-31"><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">test_instance</span><span class="o">.</span><span class="n">label</span><span class="p">)</span>  <span class="c1"># None</span>
</span></code></pre></div>


<details class="note" open>
  <summary>Note</summary>
  <ul>
<li>Automatically registered as JAX pytree if JAX is available</li>
<li>Mode transitions are enforced by type system</li>
<li>Fields are descriptors with mode-dependent behavior</li>
</ul>
</details>










<div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="formed.integrations.ml.transforms.base.DataModule.accessor" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">accessor</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#formed.integrations.ml.transforms.base.DataModule.accessor" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="n">accessor</span> <span class="o">=</span> <span class="kc">None</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>




<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.transforms.base.DataModule.train" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">train</span>


<a href="#formed.integrations.ml.transforms.base.DataModule.train" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">train</span><span class="p">()</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Context manager to enable training mode for all field transforms.</p>
<p>This propagates training mode to all BaseTransform fields, allowing them
to build state (e.g., vocabularies) from training data.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">YIELDS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-yields-annotation">
                    <code>None</code>
                </span>
            </td>
            <td class="doc-yields-details">
              <div class="doc-md-description">
                <p>None</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span id="__span-0-1"><span class="gp">&gt;&gt;&gt; </span><span class="n">dm</span> <span class="o">=</span> <span class="n">TextDataModule</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="n">Tokenizer</span><span class="p">(),</span> <span class="n">label</span><span class="o">=</span><span class="n">LabelIndexer</span><span class="p">())</span>
</span><span id="__span-0-2"><span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">dm</span><span class="o">.</span><span class="n">train</span><span class="p">():</span>
</span><span id="__span-0-3"><span class="gp">... </span>    <span class="n">instances</span> <span class="o">=</span> <span class="p">[</span><span class="n">dm</span><span class="o">.</span><span class="n">instance</span><span class="p">(</span><span class="n">example</span><span class="p">)</span> <span class="k">for</span> <span class="n">example</span> <span class="ow">in</span> <span class="n">train_data</span><span class="p">]</span>
</span><span id="__span-0-4"><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Vocabularies are now built and frozen</span>
</span></code></pre></div>


<details class="note" open>
  <summary>Note</summary>
  <p>Can only be called in AsConverter mode.</p>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/transforms/base.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span>
<span class="normal">827</span>
<span class="normal">828</span>
<span class="normal">829</span>
<span class="normal">830</span>
<span class="normal">831</span>
<span class="normal">832</span>
<span class="normal">833</span>
<span class="normal">834</span>
<span class="normal">835</span>
<span class="normal">836</span>
<span class="normal">837</span>
<span class="normal">838</span>
<span class="normal">839</span>
<span class="normal">840</span>
<span class="normal">841</span>
<span class="normal">842</span>
<span class="normal">843</span>
<span class="normal">844</span>
<span class="normal">845</span>
<span class="normal">846</span>
<span class="normal">847</span>
<span class="normal">848</span>
<span class="normal">849</span>
<span class="normal">850</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-824"><span class="nd">@contextmanager</span>
</span><span id="__span-0-825"><span class="k">def</span><span class="w"> </span><span class="nf">train</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="kc">None</span><span class="p">]:</span>
</span><span id="__span-0-826"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Context manager to enable training mode for all field transforms.</span>
</span><span id="__span-0-827">
</span><span id="__span-0-828"><span class="sd">    This propagates training mode to all BaseTransform fields, allowing them</span>
</span><span id="__span-0-829"><span class="sd">    to build state (e.g., vocabularies) from training data.</span>
</span><span id="__span-0-830">
</span><span id="__span-0-831"><span class="sd">    Yields:</span>
</span><span id="__span-0-832"><span class="sd">        None</span>
</span><span id="__span-0-833">
</span><span id="__span-0-834"><span class="sd">    Examples:</span>
</span><span id="__span-0-835"><span class="sd">        &gt;&gt;&gt; dm = TextDataModule(text=Tokenizer(), label=LabelIndexer())</span>
</span><span id="__span-0-836"><span class="sd">        &gt;&gt;&gt; with dm.train():</span>
</span><span id="__span-0-837"><span class="sd">        ...     instances = [dm.instance(example) for example in train_data]</span>
</span><span id="__span-0-838"><span class="sd">        &gt;&gt;&gt; # Vocabularies are now built and frozen</span>
</span><span id="__span-0-839">
</span><span id="__span-0-840"><span class="sd">    Note:</span>
</span><span id="__span-0-841"><span class="sd">        Can only be called in AsConverter mode.</span>
</span><span id="__span-0-842">
</span><span id="__span-0-843"><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-844">    <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">__mode__</span> <span class="ow">in</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">DataModuleMode</span><span class="o">.</span><span class="n">AS_CONVERTER</span><span class="p">),</span> <span class="p">(</span>
</span><span id="__span-0-845">        <span class="s2">&quot;DataModule must be in converter mode to enter training mode&quot;</span>
</span><span id="__span-0-846">    <span class="p">)</span>
</span><span id="__span-0-847">    <span class="k">with</span> <span class="n">ExitStack</span><span class="p">()</span> <span class="k">as</span> <span class="n">stack</span><span class="p">:</span>
</span><span id="__span-0-848">        <span class="k">for</span> <span class="n">transform</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__field_transforms__</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
</span><span id="__span-0-849">            <span class="n">stack</span><span class="o">.</span><span class="n">enter_context</span><span class="p">(</span><span class="n">transform</span><span class="o">.</span><span class="n">train</span><span class="p">())</span>
</span><span id="__span-0-850">        <span class="k">yield</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.transforms.base.DataModule.instance" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">instance</span>


<a href="#formed.integrations.ml.transforms.base.DataModule.instance" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">instance</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Transform raw data into an instance representation.</p>
<p>Applies all field transforms to create a DataModule in AsInstance mode.
Each transform field processes the corresponding data attribute/key.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>obj</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The raw input data object.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="formed.integrations.ml.transforms.base._T">_T</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="formed.integrations.ml.transforms.base._InstanceT">_InstanceT</span></code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>A DataModule in AsInstance mode with transformed fields.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span id="__span-0-1"><span class="gp">&gt;&gt;&gt; </span><span class="n">dm</span> <span class="o">=</span> <span class="n">TextDataModule</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="n">Tokenizer</span><span class="p">(),</span> <span class="n">label</span><span class="o">=</span><span class="n">LabelIndexer</span><span class="p">())</span>
</span><span id="__span-0-2"><span class="gp">&gt;&gt;&gt; </span><span class="n">instance</span> <span class="o">=</span> <span class="n">dm</span><span class="o">.</span><span class="n">instance</span><span class="p">({</span><span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="s2">&quot;hello world&quot;</span><span class="p">,</span> <span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="s2">&quot;positive&quot;</span><span class="p">})</span>
</span><span id="__span-0-3"><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">instance</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">surfaces</span><span class="p">)</span>  <span class="c1"># Tokenized text</span>
</span><span id="__span-0-4"><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">instance</span><span class="o">.</span><span class="n">label</span><span class="p">)</span>  <span class="c1"># Label index</span>
</span></code></pre></div>


<details class="note" open>
  <summary>Note</summary>
  <ul>
<li>Can only be called in <code>AsConverter</code> mode</li>
<li>Returns a new <code>DataModule</code> with <code>mode=AsInstance</code></li>
<li>Extra fields can be <code>None</code> if data is missing</li>
</ul>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/transforms/base.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">852</span>
<span class="normal">853</span>
<span class="normal">854</span>
<span class="normal">855</span>
<span class="normal">856</span>
<span class="normal">857</span>
<span class="normal">858</span>
<span class="normal">859</span>
<span class="normal">860</span>
<span class="normal">861</span>
<span class="normal">862</span>
<span class="normal">863</span>
<span class="normal">864</span>
<span class="normal">865</span>
<span class="normal">866</span>
<span class="normal">867</span>
<span class="normal">868</span>
<span class="normal">869</span>
<span class="normal">870</span>
<span class="normal">871</span>
<span class="normal">872</span>
<span class="normal">873</span>
<span class="normal">874</span>
<span class="normal">875</span>
<span class="normal">876</span>
<span class="normal">877</span>
<span class="normal">878</span>
<span class="normal">879</span>
<span class="normal">880</span>
<span class="normal">881</span>
<span class="normal">882</span>
<span class="normal">883</span>
<span class="normal">884</span>
<span class="normal">885</span>
<span class="normal">886</span>
<span class="normal">887</span>
<span class="normal">888</span>
<span class="normal">889</span>
<span class="normal">890</span>
<span class="normal">891</span>
<span class="normal">892</span>
<span class="normal">893</span>
<span class="normal">894</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-852"><span class="k">def</span><span class="w"> </span><span class="nf">instance</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="s2">&quot;DataModule[AsConverter]&quot;</span><span class="p">,</span> <span class="n">obj</span><span class="p">:</span> <span class="n">_T</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_InstanceT</span><span class="p">:</span>
</span><span id="__span-0-853"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Transform raw data into an instance representation.</span>
</span><span id="__span-0-854">
</span><span id="__span-0-855"><span class="sd">    Applies all field transforms to create a DataModule in AsInstance mode.</span>
</span><span id="__span-0-856"><span class="sd">    Each transform field processes the corresponding data attribute/key.</span>
</span><span id="__span-0-857">
</span><span id="__span-0-858"><span class="sd">    Args:</span>
</span><span id="__span-0-859"><span class="sd">        obj: The raw input data object.</span>
</span><span id="__span-0-860">
</span><span id="__span-0-861"><span class="sd">    Returns:</span>
</span><span id="__span-0-862"><span class="sd">        A DataModule in AsInstance mode with transformed fields.</span>
</span><span id="__span-0-863">
</span><span id="__span-0-864"><span class="sd">    Examples:</span>
</span><span id="__span-0-865"><span class="sd">        &gt;&gt;&gt; dm = TextDataModule(text=Tokenizer(), label=LabelIndexer())</span>
</span><span id="__span-0-866"><span class="sd">        &gt;&gt;&gt; instance = dm.instance({&quot;text&quot;: &quot;hello world&quot;, &quot;label&quot;: &quot;positive&quot;})</span>
</span><span id="__span-0-867"><span class="sd">        &gt;&gt;&gt; print(instance.text.surfaces)  # Tokenized text</span>
</span><span id="__span-0-868"><span class="sd">        &gt;&gt;&gt; print(instance.label)  # Label index</span>
</span><span id="__span-0-869">
</span><span id="__span-0-870"><span class="sd">    Note:</span>
</span><span id="__span-0-871"><span class="sd">        - Can only be called in `AsConverter` mode</span>
</span><span id="__span-0-872"><span class="sd">        - Returns a new `DataModule` with `mode=AsInstance`</span>
</span><span id="__span-0-873"><span class="sd">        - Extra fields can be `None` if data is missing</span>
</span><span id="__span-0-874">
</span><span id="__span-0-875"><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-876">    <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">__mode__</span> <span class="ow">in</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">DataModuleMode</span><span class="o">.</span><span class="n">AS_CONVERTER</span><span class="p">),</span> <span class="p">(</span>
</span><span id="__span-0-877">        <span class="s2">&quot;DataModule must be in converter mode to create an instance&quot;</span>
</span><span id="__span-0-878">    <span class="p">)</span>
</span><span id="__span-0-879">
</span><span id="__span-0-880">    <span class="n">fields</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="__span-0-881">    <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">transform</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__field_transforms__</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="__span-0-882">        <span class="n">fields</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">transform</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
</span><span id="__span-0-883">    <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">field</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="n">__get_param_fields__</span><span class="p">()</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="__span-0-884">        <span class="k">if</span> <span class="p">(</span>
</span><span id="__span-0-885">            <span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">fields</span>
</span><span id="__span-0-886">            <span class="ow">and</span> <span class="n">field</span><span class="o">.</span><span class="n">default</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">MISSING</span>
</span><span id="__span-0-887">            <span class="ow">and</span> <span class="n">field</span><span class="o">.</span><span class="n">default_factory</span> <span class="ow">is</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">MISSING</span>
</span><span id="__span-0-888">        <span class="p">):</span>
</span><span id="__span-0-889">            <span class="n">fields</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">_UNAVAILABLE</span>
</span><span id="__span-0-890">
</span><span id="__span-0-891">    <span class="n">instance</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="n">_InstanceT</span><span class="p">,</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">fields</span><span class="p">))</span>
</span><span id="__span-0-892">    <span class="nb">setattr</span><span class="p">(</span><span class="n">instance</span><span class="p">,</span> <span class="s2">&quot;__mode__&quot;</span><span class="p">,</span> <span class="n">DataModuleMode</span><span class="o">.</span><span class="n">AS_INSTANCE</span><span class="p">)</span>
</span><span id="__span-0-893">
</span><span id="__span-0-894">    <span class="k">return</span> <span class="n">instance</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.transforms.base.DataModule.batch" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">batch</span>


<a href="#formed.integrations.ml.transforms.base.DataModule.batch" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">batch</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Collate multiple instances into a batched representation.</p>
<p>Takes a sequence of raw data or instances and creates a <code>DataModule</code> in
<code>AsBatch</code> mode. Each transform field's <code>batch()</code> method is called to collate
the corresponding field values.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>instances</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Sequence of raw data or <code>DataModule</code> instances.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="collections.abc.Sequence">Sequence</span>[<span title="formed.integrations.ml.transforms.base._T">_T</span> | <span title="formed.integrations.ml.transforms.base._InstanceT">_InstanceT</span>]</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="formed.integrations.ml.transforms.base._BatchT">_BatchT</span></code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>A <code>DataModule</code> in <code>AsBatch</code> mode with batched tensor fields.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span id="__span-0-1"><span class="gp">&gt;&gt;&gt; </span><span class="n">dm</span> <span class="o">=</span> <span class="n">TextDataModule</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="n">Tokenizer</span><span class="p">(),</span> <span class="n">label</span><span class="o">=</span><span class="n">LabelIndexer</span><span class="p">())</span>
</span><span id="__span-0-2"><span class="gp">&gt;&gt;&gt; </span><span class="n">instances</span> <span class="o">=</span> <span class="p">[</span><span class="n">dm</span><span class="o">.</span><span class="n">instance</span><span class="p">(</span><span class="n">ex</span><span class="p">)</span> <span class="k">for</span> <span class="n">ex</span> <span class="ow">in</span> <span class="n">examples</span><span class="p">]</span>
</span><span id="__span-0-3"><span class="gp">&gt;&gt;&gt; </span><span class="n">batch</span> <span class="o">=</span> <span class="n">dm</span><span class="o">.</span><span class="n">batch</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
</span><span id="__span-0-4"><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">batch</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">surfaces</span><span class="o">.</span><span class="n">ids</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>  <span class="c1"># (batch_size, seq_length)</span>
</span><span id="__span-0-5"><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">batch</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>  <span class="c1"># (batch_size,)</span>
</span><span id="__span-0-6"><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">batch</span><span class="p">))</span>  <span class="c1"># batch_size</span>
</span></code></pre></div>


<details class="note" open>
  <summary>Note</summary>
  <ul>
<li>Can only be called in <code>AsConverter</code> mode</li>
<li>Automatically converts raw data to instances if needed</li>
<li>Returns a new <code>DataModule</code> with <code>mode=AsBatch</code></li>
<li>Extra fields are <code>None</code> if all instances have None for that field</li>
</ul>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/transforms/base.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">896</span>
<span class="normal">897</span>
<span class="normal">898</span>
<span class="normal">899</span>
<span class="normal">900</span>
<span class="normal">901</span>
<span class="normal">902</span>
<span class="normal">903</span>
<span class="normal">904</span>
<span class="normal">905</span>
<span class="normal">906</span>
<span class="normal">907</span>
<span class="normal">908</span>
<span class="normal">909</span>
<span class="normal">910</span>
<span class="normal">911</span>
<span class="normal">912</span>
<span class="normal">913</span>
<span class="normal">914</span>
<span class="normal">915</span>
<span class="normal">916</span>
<span class="normal">917</span>
<span class="normal">918</span>
<span class="normal">919</span>
<span class="normal">920</span>
<span class="normal">921</span>
<span class="normal">922</span>
<span class="normal">923</span>
<span class="normal">924</span>
<span class="normal">925</span>
<span class="normal">926</span>
<span class="normal">927</span>
<span class="normal">928</span>
<span class="normal">929</span>
<span class="normal">930</span>
<span class="normal">931</span>
<span class="normal">932</span>
<span class="normal">933</span>
<span class="normal">934</span>
<span class="normal">935</span>
<span class="normal">936</span>
<span class="normal">937</span>
<span class="normal">938</span>
<span class="normal">939</span>
<span class="normal">940</span>
<span class="normal">941</span>
<span class="normal">942</span>
<span class="normal">943</span>
<span class="normal">944</span>
<span class="normal">945</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-896"><span class="k">def</span><span class="w"> </span><span class="nf">batch</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="s2">&quot;DataModule[AsConverter]&quot;</span><span class="p">,</span> <span class="n">instances</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">_T</span> <span class="o">|</span> <span class="n">_InstanceT</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">_BatchT</span><span class="p">:</span>
</span><span id="__span-0-897"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Collate multiple instances into a batched representation.</span>
</span><span id="__span-0-898">
</span><span id="__span-0-899"><span class="sd">    Takes a sequence of raw data or instances and creates a `DataModule` in</span>
</span><span id="__span-0-900"><span class="sd">    `AsBatch` mode. Each transform field&#39;s `batch()` method is called to collate</span>
</span><span id="__span-0-901"><span class="sd">    the corresponding field values.</span>
</span><span id="__span-0-902">
</span><span id="__span-0-903"><span class="sd">    Args:</span>
</span><span id="__span-0-904"><span class="sd">        instances: Sequence of raw data or `DataModule` instances.</span>
</span><span id="__span-0-905">
</span><span id="__span-0-906"><span class="sd">    Returns:</span>
</span><span id="__span-0-907"><span class="sd">        A `DataModule` in `AsBatch` mode with batched tensor fields.</span>
</span><span id="__span-0-908">
</span><span id="__span-0-909"><span class="sd">    Examples:</span>
</span><span id="__span-0-910"><span class="sd">        &gt;&gt;&gt; dm = TextDataModule(text=Tokenizer(), label=LabelIndexer())</span>
</span><span id="__span-0-911"><span class="sd">        &gt;&gt;&gt; instances = [dm.instance(ex) for ex in examples]</span>
</span><span id="__span-0-912"><span class="sd">        &gt;&gt;&gt; batch = dm.batch(instances)</span>
</span><span id="__span-0-913"><span class="sd">        &gt;&gt;&gt; print(batch.text.surfaces.ids.shape)  # (batch_size, seq_length)</span>
</span><span id="__span-0-914"><span class="sd">        &gt;&gt;&gt; print(batch.label.shape)  # (batch_size,)</span>
</span><span id="__span-0-915"><span class="sd">        &gt;&gt;&gt; print(len(batch))  # batch_size</span>
</span><span id="__span-0-916">
</span><span id="__span-0-917"><span class="sd">    Note:</span>
</span><span id="__span-0-918"><span class="sd">        - Can only be called in `AsConverter` mode</span>
</span><span id="__span-0-919"><span class="sd">        - Automatically converts raw data to instances if needed</span>
</span><span id="__span-0-920"><span class="sd">        - Returns a new `DataModule` with `mode=AsBatch`</span>
</span><span id="__span-0-921"><span class="sd">        - Extra fields are `None` if all instances have None for that field</span>
</span><span id="__span-0-922">
</span><span id="__span-0-923"><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-924">    <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">__mode__</span> <span class="ow">in</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">DataModuleMode</span><span class="o">.</span><span class="n">AS_CONVERTER</span><span class="p">),</span> <span class="p">(</span>
</span><span id="__span-0-925">        <span class="s2">&quot;DataModule must be in converter mode to create a batch&quot;</span>
</span><span id="__span-0-926">    <span class="p">)</span>
</span><span id="__span-0-927">
</span><span id="__span-0-928">    <span class="n">instances</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">DataModule</span><span class="p">)</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">instance</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">]</span>
</span><span id="__span-0-929">    <span class="n">fields</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="__span-0-930">    <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">transform</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__field_transforms__</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="__span-0-931">        <span class="n">can_be_optional</span> <span class="o">=</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="n">__get_extra_fields__</span><span class="p">()</span>
</span><span id="__span-0-932">        <span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="nb">getattr</span><span class="p">(</span><span class="n">instance</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span> <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">]</span>
</span><span id="__span-0-933">        <span class="k">if</span> <span class="n">can_be_optional</span> <span class="ow">and</span> <span class="nb">all</span><span class="p">(</span><span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">values</span><span class="p">):</span>
</span><span id="__span-0-934">            <span class="n">fields</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="__span-0-935">        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-936">            <span class="n">fields</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">batch</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
</span><span id="__span-0-937">    <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="n">__get_param_fields__</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="__span-0-938">        <span class="k">if</span> <span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">fields</span><span class="p">:</span>
</span><span id="__span-0-939">            <span class="n">fields</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">_UNAVAILABLE</span>
</span><span id="__span-0-940">
</span><span id="__span-0-941">    <span class="n">batch</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="n">_BatchT</span><span class="p">,</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">fields</span><span class="p">))</span>
</span><span id="__span-0-942">    <span class="nb">setattr</span><span class="p">(</span><span class="n">batch</span><span class="p">,</span> <span class="s2">&quot;__mode__&quot;</span><span class="p">,</span> <span class="n">DataModuleMode</span><span class="o">.</span><span class="n">AS_BATCH</span><span class="p">)</span>
</span><span id="__span-0-943">
</span><span id="__span-0-944">    <span class="n">batch</span><span class="o">.</span><span class="n">_batch_size</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
</span><span id="__span-0-945">    <span class="k">return</span> <span class="n">batch</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.transforms.base.DataModule.save" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">save</span>


<a href="#formed.integrations.ml.transforms.base.DataModule.save" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">save</span><span class="p">(</span><span class="n">directory</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Save the transform to a directory using cloudpickle.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>directory</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Directory path to save the transform.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="str">str</span> | <span title="os.PathLike">PathLike</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Note</summary>
  <p>The transform is saved as 'transform.pkl' in the specified directory.
cloudpickle is used to handle complex objects like lambdas and closures.</p>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/transforms/base.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-631"><span class="k">def</span><span class="w"> </span><span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">directory</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">PathLike</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-632"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Save the transform to a directory using cloudpickle.</span>
</span><span id="__span-0-633">
</span><span id="__span-0-634"><span class="sd">    Args:</span>
</span><span id="__span-0-635"><span class="sd">        directory: Directory path to save the transform.</span>
</span><span id="__span-0-636">
</span><span id="__span-0-637"><span class="sd">    Note:</span>
</span><span id="__span-0-638"><span class="sd">        The transform is saved as &#39;transform.pkl&#39; in the specified directory.</span>
</span><span id="__span-0-639"><span class="sd">        cloudpickle is used to handle complex objects like lambdas and closures.</span>
</span><span id="__span-0-640">
</span><span id="__span-0-641"><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-642">    <span class="n">filepath</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">directory</span><span class="p">)</span> <span class="o">/</span> <span class="s2">&quot;transform.pkl&quot;</span>
</span><span id="__span-0-643">    <span class="k">with</span> <span class="n">filepath</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="__span-0-644">        <span class="n">cloudpickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.transforms.base.DataModule.load" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">load</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#formed.integrations.ml.transforms.base.DataModule.load" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">load</span><span class="p">(</span><span class="n">directory</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Load a transform from a directory.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>directory</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Directory path containing the saved transform.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="str">str</span> | <span title="os.PathLike">PathLike</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="typing.Self">Self</span></code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>The loaded transform instance.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RAISES</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
              <span class="doc-raises-annotation">
                  <code><span title="TypeError">TypeError</span></code>
              </span>
            </td>
            <td class="doc-raises-details">
              <div class="doc-md-description">
                <p>If the loaded object is not an instance of this class.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Note</summary>
  <p>Expects a 'transform.pkl' file in the specified directory.</p>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/transforms/base.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-646"><span class="nd">@classmethod</span>
</span><span id="__span-0-647"><span class="k">def</span><span class="w"> </span><span class="nf">load</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">directory</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">PathLike</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
</span><span id="__span-0-648"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Load a transform from a directory.</span>
</span><span id="__span-0-649">
</span><span id="__span-0-650"><span class="sd">    Args:</span>
</span><span id="__span-0-651"><span class="sd">        directory: Directory path containing the saved transform.</span>
</span><span id="__span-0-652">
</span><span id="__span-0-653"><span class="sd">    Returns:</span>
</span><span id="__span-0-654"><span class="sd">        The loaded transform instance.</span>
</span><span id="__span-0-655">
</span><span id="__span-0-656"><span class="sd">    Raises:</span>
</span><span id="__span-0-657"><span class="sd">        TypeError: If the loaded object is not an instance of this class.</span>
</span><span id="__span-0-658">
</span><span id="__span-0-659"><span class="sd">    Note:</span>
</span><span id="__span-0-660"><span class="sd">        Expects a &#39;transform.pkl&#39; file in the specified directory.</span>
</span><span id="__span-0-661">
</span><span id="__span-0-662"><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-663">    <span class="n">filepath</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">directory</span><span class="p">)</span> <span class="o">/</span> <span class="s2">&quot;transform.pkl&quot;</span>
</span><span id="__span-0-664">    <span class="k">with</span> <span class="n">filepath</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="__span-0-665">        <span class="n">obj</span> <span class="o">=</span> <span class="n">cloudpickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</span><span id="__span-0-666">    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="bp">cls</span><span class="p">):</span>
</span><span id="__span-0-667">        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Loaded object is not an instance of </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-0-668">    <span class="k">return</span> <span class="n">obj</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h3 id="formed.integrations.ml.transforms.base.register_dataclass" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">register_dataclass</span>


<a href="#formed.integrations.ml.transforms.base.register_dataclass" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">register_dataclass</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Register a dataclass with JAX pytree if JAX is available.</p>
<p>This function automatically registers dataclasses as JAX pytrees, enabling
them to be used with JAX transformations like jax.jit, jax.vmap, and jax.grad.
It distinguishes between data fields, metadata fields, and fields to drop based
on field metadata and the Param/Extra field markers.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>cls</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>A dataclass type to register.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="formed.integrations.ml.transforms.base._TypeT">_TypeT</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="formed.integrations.ml.transforms.base._TypeT">_TypeT</span></code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>The same class, now registered as a JAX pytree (if JAX is installed).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Note</summary>
  <ul>
<li>If JAX is not installed, this function does nothing.</li>
<li>Fields marked with JAX_STATIC_FIELD metadata become meta_fields.</li>
<li>Fields with init=False and not marked as Param are dropped.</li>
<li>Registration is idempotent; registering twice has no effect.</li>
<li>If the class is a DataModule, recursively registers nested dataclasses.</li>
</ul>
</details>

<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span id="__span-0-1"><span class="gp">&gt;&gt;&gt; </span><span class="nd">@dataclasses</span><span class="o">.</span><span class="n">dataclass</span>
</span><span id="__span-0-2"><span class="gp">... </span><span class="k">class</span><span class="w"> </span><span class="nc">MyData</span><span class="p">:</span>
</span><span id="__span-0-3"><span class="gp">... </span>    <span class="n">values</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>
</span><span id="__span-0-4"><span class="gp">... </span>    <span class="n">metadata</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="n">metadata</span><span class="o">=</span><span class="p">{</span><span class="n">JAX_STATIC_FIELD</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
</span><span id="__span-0-5"><span class="gp">&gt;&gt;&gt; </span><span class="n">register_dataclass</span><span class="p">(</span><span class="n">MyData</span><span class="p">)</span>
</span><span id="__span-0-6"><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Now MyData can be used with JAX transformations</span>
</span></code></pre></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/transforms/base.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-117"><span class="k">def</span><span class="w"> </span><span class="nf">register_dataclass</span><span class="p">(</span><span class="bp">cls</span><span class="p">:</span> <span class="n">_TypeT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_TypeT</span><span class="p">:</span>
</span><span id="__span-0-118"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Register a dataclass with JAX pytree if JAX is available.</span>
</span><span id="__span-0-119">
</span><span id="__span-0-120"><span class="sd">    This function automatically registers dataclasses as JAX pytrees, enabling</span>
</span><span id="__span-0-121"><span class="sd">    them to be used with JAX transformations like jax.jit, jax.vmap, and jax.grad.</span>
</span><span id="__span-0-122"><span class="sd">    It distinguishes between data fields, metadata fields, and fields to drop based</span>
</span><span id="__span-0-123"><span class="sd">    on field metadata and the Param/Extra field markers.</span>
</span><span id="__span-0-124">
</span><span id="__span-0-125"><span class="sd">    Args:</span>
</span><span id="__span-0-126"><span class="sd">        cls: A dataclass type to register.</span>
</span><span id="__span-0-127">
</span><span id="__span-0-128"><span class="sd">    Returns:</span>
</span><span id="__span-0-129"><span class="sd">        The same class, now registered as a JAX pytree (if JAX is installed).</span>
</span><span id="__span-0-130">
</span><span id="__span-0-131"><span class="sd">    Note:</span>
</span><span id="__span-0-132"><span class="sd">        - If JAX is not installed, this function does nothing.</span>
</span><span id="__span-0-133"><span class="sd">        - Fields marked with JAX_STATIC_FIELD metadata become meta_fields.</span>
</span><span id="__span-0-134"><span class="sd">        - Fields with init=False and not marked as Param are dropped.</span>
</span><span id="__span-0-135"><span class="sd">        - Registration is idempotent; registering twice has no effect.</span>
</span><span id="__span-0-136"><span class="sd">        - If the class is a DataModule, recursively registers nested dataclasses.</span>
</span><span id="__span-0-137">
</span><span id="__span-0-138"><span class="sd">    Examples:</span>
</span><span id="__span-0-139"><span class="sd">        &gt;&gt;&gt; @dataclasses.dataclass</span>
</span><span id="__span-0-140"><span class="sd">        ... class MyData:</span>
</span><span id="__span-0-141"><span class="sd">        ...     values: list[float]</span>
</span><span id="__span-0-142"><span class="sd">        ...     metadata: str = dataclasses.field(metadata={JAX_STATIC_FIELD: True})</span>
</span><span id="__span-0-143"><span class="sd">        &gt;&gt;&gt; register_dataclass(MyData)</span>
</span><span id="__span-0-144"><span class="sd">        &gt;&gt;&gt; # Now MyData can be used with JAX transformations</span>
</span><span id="__span-0-145">
</span><span id="__span-0-146"><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-147">    <span class="k">if</span> <span class="bp">cls</span> <span class="ow">in</span> <span class="n">_DATACLASS_REGISTRY</span><span class="p">:</span>
</span><span id="__span-0-148">        <span class="k">return</span> <span class="bp">cls</span>
</span><span id="__span-0-149">
</span><span id="__span-0-150">    <span class="n">_DATACLASS_REGISTRY</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span>
</span><span id="__span-0-151">
</span><span id="__span-0-152">    <span class="k">with</span> <span class="n">suppress</span><span class="p">(</span><span class="ne">ImportError</span><span class="p">):</span>
</span><span id="__span-0-153">        <span class="kn">import</span><span class="w"> </span><span class="nn">jax</span>
</span><span id="__span-0-154">
</span><span id="__span-0-155">        <span class="k">def</span><span class="w"> </span><span class="nf">_is_static_field</span><span class="p">(</span><span class="n">field</span><span class="p">:</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">Field</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="__span-0-156">            <span class="k">if</span> <span class="n">field</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">JAX_STATIC_FIELD</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
</span><span id="__span-0-157">                <span class="k">return</span> <span class="kc">True</span>
</span><span id="__span-0-158">            <span class="n">field_class</span> <span class="o">=</span> <span class="n">_find_dataclass_field</span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">type</span><span class="p">)</span>
</span><span id="__span-0-159">            <span class="k">if</span> <span class="n">field_class</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-160">                <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">field_class</span><span class="p">,</span> <span class="s2">&quot;__is_static__&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
</span><span id="__span-0-161">            <span class="k">return</span> <span class="kc">False</span>
</span><span id="__span-0-162">
</span><span id="__span-0-163">        <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="s2">&quot;__is_datamodule__&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
</span><span id="__span-0-164">            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">fields</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
</span><span id="__span-0-165">                <span class="n">field_class</span> <span class="o">=</span> <span class="n">_find_dataclass_field</span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">type</span><span class="p">)</span>
</span><span id="__span-0-166">                <span class="k">if</span> <span class="n">field_class</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-167">                    <span class="n">register_dataclass</span><span class="p">(</span><span class="n">field_class</span><span class="p">)</span>
</span><span id="__span-0-168">
</span><span id="__span-0-169">        <span class="n">drop_fields</span> <span class="o">=</span> <span class="p">[</span><span class="n">f</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">fields</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">f</span><span class="o">.</span><span class="n">init</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">_is_param_field</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">type</span><span class="p">)]</span>
</span><span id="__span-0-170">        <span class="n">data_fields</span> <span class="o">=</span> <span class="p">[</span><span class="n">f</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">fields</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">_is_static_field</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="ow">and</span> <span class="n">f</span><span class="o">.</span><span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">drop_fields</span><span class="p">]</span>
</span><span id="__span-0-171">        <span class="n">meta_fields</span> <span class="o">=</span> <span class="p">[</span><span class="n">f</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">fields</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="k">if</span> <span class="n">_is_static_field</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="ow">and</span> <span class="n">f</span><span class="o">.</span><span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">drop_fields</span><span class="p">]</span>
</span><span id="__span-0-172">
</span><span id="__span-0-173">        <span class="k">try</span><span class="p">:</span>
</span><span id="__span-0-174">            <span class="n">jax</span><span class="o">.</span><span class="n">tree_util</span><span class="o">.</span><span class="n">register_dataclass</span><span class="p">(</span>
</span><span id="__span-0-175">                <span class="bp">cls</span><span class="p">,</span>
</span><span id="__span-0-176">                <span class="n">data_fields</span><span class="o">=</span><span class="n">data_fields</span><span class="p">,</span>
</span><span id="__span-0-177">                <span class="n">meta_fields</span><span class="o">=</span><span class="n">meta_fields</span><span class="p">,</span>
</span><span id="__span-0-178">                <span class="n">drop_fields</span><span class="o">=</span><span class="n">drop_fields</span><span class="p">,</span>
</span><span id="__span-0-179">            <span class="p">)</span>
</span><span id="__span-0-180">        <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>
</span><span id="__span-0-181">            <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">error</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;Duplicate custom dataclass&quot;</span><span class="p">):</span>
</span><span id="__span-0-182">                <span class="k">pass</span>
</span><span id="__span-0-183">            <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-184">                <span class="k">raise</span>
</span><span id="__span-0-185">
</span><span id="__span-0-186">    <span class="k">return</span> <span class="bp">cls</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="formed.integrations.ml.transforms.basic" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">formed.integrations.ml.transforms.basic</span>


<a href="#formed.integrations.ml.transforms.basic" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents first">

        <p>Basic data transformations for common machine learning tasks.</p>
<p>This module provides fundamental transform classes for handling common data types
in machine learning pipelines, including labels, scalars, tensors, and metadata.</p>


<details class="available-transforms" open>
  <summary>Available Transforms</summary>
  <ul>
<li>MetadataTransform: Pass-through transform for metadata (e.g., IDs, names)</li>
<li>LabelIndexer: Map labels to integer indices with vocabulary building</li>
<li>ScalarTransform: Convert scalar values to numpy arrays</li>
<li>TensorTransform: Convert numpy arrays to batched tensors</li>
</ul>
</details>

<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span id="__span-0-1"><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">formed.integrations.ml</span><span class="w"> </span><span class="kn">import</span> <span class="n">LabelIndexer</span><span class="p">,</span> <span class="n">ScalarTransform</span>
</span><span id="__span-0-2"><span class="gp">&gt;&gt;&gt;</span>
</span><span id="__span-0-3"><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Label indexing with vocabulary building</span>
</span><span id="__span-0-4"><span class="gp">&gt;&gt;&gt; </span><span class="n">label_indexer</span> <span class="o">=</span> <span class="n">LabelIndexer</span><span class="p">()</span>
</span><span id="__span-0-5"><span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">label_indexer</span><span class="o">.</span><span class="n">train</span><span class="p">():</span>
</span><span id="__span-0-6"><span class="gp">... </span>    <span class="n">idx1</span> <span class="o">=</span> <span class="n">label_indexer</span><span class="o">.</span><span class="n">instance</span><span class="p">(</span><span class="s2">&quot;positive&quot;</span><span class="p">)</span>  <span class="c1"># Returns 0</span>
</span><span id="__span-0-7"><span class="gp">... </span>    <span class="n">idx2</span> <span class="o">=</span> <span class="n">label_indexer</span><span class="o">.</span><span class="n">instance</span><span class="p">(</span><span class="s2">&quot;negative&quot;</span><span class="p">)</span>  <span class="c1"># Returns 1</span>
</span><span id="__span-0-8"><span class="gp">&gt;&gt;&gt; </span><span class="n">batch</span> <span class="o">=</span> <span class="n">label_indexer</span><span class="o">.</span><span class="n">batch</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>  <span class="c1"># np.array([0, 1, 0])</span>
</span><span id="__span-0-9"><span class="gp">&gt;&gt;&gt;</span>
</span><span id="__span-0-10"><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Scalar to tensor</span>
</span><span id="__span-0-11"><span class="gp">&gt;&gt;&gt; </span><span class="n">scalar_transform</span> <span class="o">=</span> <span class="n">ScalarTransform</span><span class="p">()</span>
</span><span id="__span-0-12"><span class="gp">&gt;&gt;&gt; </span><span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">2.3</span><span class="p">,</span> <span class="mf">4.1</span><span class="p">]</span>
</span><span id="__span-0-13"><span class="gp">&gt;&gt;&gt; </span><span class="n">batch</span> <span class="o">=</span> <span class="n">scalar_transform</span><span class="o">.</span><span class="n">batch</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>  <span class="c1"># np.array([1.5, 2.3, 4.1])</span>
</span></code></pre></div>










<div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="formed.integrations.ml.transforms.basic.logger" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">logger</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

<a href="#formed.integrations.ml.transforms.basic.logger" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="n">logger</span> <span class="o">=</span> <span class="n"><span title="logging.getLogger">getLogger</span></span><span class="p">(</span><span class="n"><span title="__name__">__name__</span></span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>



<div class="doc doc-object doc-class">



<h3 id="formed.integrations.ml.transforms.basic.MetadataTransform" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">MetadataTransform</span>


<a href="#formed.integrations.ml.transforms.basic.MetadataTransform" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="typing.Generic">Generic</span>[<span title="formed.integrations.ml.transforms.basic._S">_S</span>, <span title="formed.integrations.ml.transforms.basic._T">_T</span>]</code>, <code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;BaseTransform&lt;/span&gt; (&lt;code&gt;formed.integrations.ml.transforms.base.BaseTransform&lt;/code&gt;)" href="#formed.integrations.ml.transforms.base.BaseTransform">BaseTransform</a>[<span title="formed.integrations.ml.transforms.basic._S">_S</span>, <span title="formed.integrations.ml.transforms.basic._T">_T</span>, <span title="formed.integrations.ml.transforms.basic._T">_T</span>, <span title="collections.abc.Sequence">Sequence</span>[<span title="formed.integrations.ml.transforms.basic._T">_T</span>]]</code></p>



        <p>Pass-through transform for metadata fields.</p>
<p>MetadataTransform does not modify data during instance transformation and
simply collects values into a list during batching. This is useful for
metadata like IDs, filenames, or other non-numerical information that should
be preserved but not transformed into tensors.</p>


<table>
      <thead>
        <tr>
          <th>
            <span class="doc-section-title">
              CLASS TYPE PARAMETER
            </span>
          </th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>_S</code>
            </td>
            <td class="doc-type_param-details">
              <div class="doc-md-description">
                <p>Source data type before accessor</p>
              </div>
              <p>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>_T</code>
            </td>
            <td class="doc-type_param-details">
              <div class="doc-md-description">
                <p>Value type (same as instance and element of batch)</p>
              </div>
              <p>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span id="__span-0-1"><span class="gp">&gt;&gt;&gt; </span><span class="n">transform</span> <span class="o">=</span> <span class="n">MetadataTransform</span><span class="p">(</span><span class="n">accessor</span><span class="o">=</span><span class="s2">&quot;id&quot;</span><span class="p">)</span>
</span><span id="__span-0-2"><span class="gp">&gt;&gt;&gt; </span><span class="n">instance</span> <span class="o">=</span> <span class="n">transform</span><span class="p">({</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;example_001&quot;</span><span class="p">})</span>  <span class="c1"># Returns &quot;example_001&quot;</span>
</span><span id="__span-0-3"><span class="gp">&gt;&gt;&gt; </span><span class="n">batch</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">batch</span><span class="p">([</span><span class="s2">&quot;example_001&quot;</span><span class="p">,</span> <span class="s2">&quot;example_002&quot;</span><span class="p">,</span> <span class="s2">&quot;example_003&quot;</span><span class="p">])</span>
</span><span id="__span-0-4"><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span>  <span class="c1"># [&quot;example_001&quot;, &quot;example_002&quot;, &quot;example_003&quot;]</span>
</span></code></pre></div>


<details class="note" open>
  <summary>Note</summary>
  <p>This transform is stateless and does not require training.</p>
</details>










<div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="formed.integrations.ml.transforms.basic.MetadataTransform.accessor" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">accessor</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#formed.integrations.ml.transforms.basic.MetadataTransform.accessor" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="n">accessor</span> <span class="o">=</span> <span class="kc">None</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>




<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.transforms.basic.MetadataTransform.instance" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">instance</span>


<a href="#formed.integrations.ml.transforms.basic.MetadataTransform.instance" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">instance</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/transforms/basic.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">78</span>
<span class="normal">79</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-78"><span class="k">def</span><span class="w"> </span><span class="nf">instance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">_T</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_T</span><span class="p">:</span>
</span><span id="__span-0-79">    <span class="k">return</span> <span class="n">value</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.transforms.basic.MetadataTransform.batch" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">batch</span>


<a href="#formed.integrations.ml.transforms.basic.MetadataTransform.batch" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">batch</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/transforms/basic.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">81</span>
<span class="normal">82</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-81"><span class="k">def</span><span class="w"> </span><span class="nf">batch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">_T</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">_T</span><span class="p">]:</span>
</span><span id="__span-0-82">    <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.transforms.basic.MetadataTransform.train" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">train</span>


<a href="#formed.integrations.ml.transforms.basic.MetadataTransform.train" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">train</span><span class="p">()</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Context manager to enable training mode for stateful transformations.</p>
<p>In training mode, transforms can build state (e.g., vocabularies, statistics)
from the training data. Hooks <code>_on_start_training()</code> and <code>_on_end_training()</code>
are called at the beginning and end of the training context.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">YIELDS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-yields-annotation">
                    <code>None</code>
                </span>
            </td>
            <td class="doc-yields-details">
              <div class="doc-md-description">
                <p>None</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span id="__span-0-1"><span class="gp">&gt;&gt;&gt; </span><span class="n">indexer</span> <span class="o">=</span> <span class="n">TokenSequenceIndexer</span><span class="p">()</span>
</span><span id="__span-0-2"><span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">indexer</span><span class="o">.</span><span class="n">train</span><span class="p">():</span>
</span><span id="__span-0-3"><span class="gp">... </span>    <span class="c1"># Build vocabulary from training data</span>
</span><span id="__span-0-4"><span class="gp">... </span>    <span class="n">tokens1</span> <span class="o">=</span> <span class="n">indexer</span><span class="o">.</span><span class="n">instance</span><span class="p">([</span><span class="s2">&quot;hello&quot;</span><span class="p">,</span> <span class="s2">&quot;world&quot;</span><span class="p">])</span>
</span><span id="__span-0-5"><span class="gp">... </span>    <span class="n">tokens2</span> <span class="o">=</span> <span class="n">indexer</span><span class="o">.</span><span class="n">instance</span><span class="p">([</span><span class="s2">&quot;hello&quot;</span><span class="p">,</span> <span class="s2">&quot;there&quot;</span><span class="p">])</span>
</span><span id="__span-0-6"><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Vocabulary is now frozen, use for inference</span>
</span><span id="__span-0-7"><span class="gp">&gt;&gt;&gt; </span><span class="n">test_tokens</span> <span class="o">=</span> <span class="n">indexer</span><span class="o">.</span><span class="n">instance</span><span class="p">([</span><span class="s2">&quot;hello&quot;</span><span class="p">,</span> <span class="s2">&quot;unknown&quot;</span><span class="p">])</span>
</span></code></pre></div>


<details class="note" open>
  <summary>Note</summary>
  <p>Training mode is reentrant but nested calls won't trigger hooks again.</p>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/transforms/base.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-596"><span class="nd">@contextmanager</span>
</span><span id="__span-0-597"><span class="k">def</span><span class="w"> </span><span class="nf">train</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="kc">None</span><span class="p">]:</span>
</span><span id="__span-0-598"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Context manager to enable training mode for stateful transformations.</span>
</span><span id="__span-0-599">
</span><span id="__span-0-600"><span class="sd">    In training mode, transforms can build state (e.g., vocabularies, statistics)</span>
</span><span id="__span-0-601"><span class="sd">    from the training data. Hooks `_on_start_training()` and `_on_end_training()`</span>
</span><span id="__span-0-602"><span class="sd">    are called at the beginning and end of the training context.</span>
</span><span id="__span-0-603">
</span><span id="__span-0-604"><span class="sd">    Yields:</span>
</span><span id="__span-0-605"><span class="sd">        None</span>
</span><span id="__span-0-606">
</span><span id="__span-0-607"><span class="sd">    Examples:</span>
</span><span id="__span-0-608"><span class="sd">        &gt;&gt;&gt; indexer = TokenSequenceIndexer()</span>
</span><span id="__span-0-609"><span class="sd">        &gt;&gt;&gt; with indexer.train():</span>
</span><span id="__span-0-610"><span class="sd">        ...     # Build vocabulary from training data</span>
</span><span id="__span-0-611"><span class="sd">        ...     tokens1 = indexer.instance([&quot;hello&quot;, &quot;world&quot;])</span>
</span><span id="__span-0-612"><span class="sd">        ...     tokens2 = indexer.instance([&quot;hello&quot;, &quot;there&quot;])</span>
</span><span id="__span-0-613"><span class="sd">        &gt;&gt;&gt; # Vocabulary is now frozen, use for inference</span>
</span><span id="__span-0-614"><span class="sd">        &gt;&gt;&gt; test_tokens = indexer.instance([&quot;hello&quot;, &quot;unknown&quot;])</span>
</span><span id="__span-0-615">
</span><span id="__span-0-616"><span class="sd">    Note:</span>
</span><span id="__span-0-617"><span class="sd">        Training mode is reentrant but nested calls won&#39;t trigger hooks again.</span>
</span><span id="__span-0-618">
</span><span id="__span-0-619"><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-620">    <span class="n">original</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_training</span>
</span><span id="__span-0-621">    <span class="bp">self</span><span class="o">.</span><span class="n">_training</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="__span-0-622">    <span class="k">try</span><span class="p">:</span>
</span><span id="__span-0-623">        <span class="k">if</span> <span class="ow">not</span> <span class="n">original</span><span class="p">:</span>
</span><span id="__span-0-624">            <span class="bp">self</span><span class="o">.</span><span class="n">_on_start_training</span><span class="p">()</span>
</span><span id="__span-0-625">        <span class="k">yield</span>
</span><span id="__span-0-626">        <span class="k">if</span> <span class="ow">not</span> <span class="n">original</span><span class="p">:</span>
</span><span id="__span-0-627">            <span class="bp">self</span><span class="o">.</span><span class="n">_on_end_training</span><span class="p">()</span>
</span><span id="__span-0-628">    <span class="k">finally</span><span class="p">:</span>
</span><span id="__span-0-629">        <span class="bp">self</span><span class="o">.</span><span class="n">_training</span> <span class="o">=</span> <span class="n">original</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.transforms.basic.MetadataTransform.save" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">save</span>


<a href="#formed.integrations.ml.transforms.basic.MetadataTransform.save" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">save</span><span class="p">(</span><span class="n">directory</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Save the transform to a directory using cloudpickle.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>directory</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Directory path to save the transform.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="str">str</span> | <span title="os.PathLike">PathLike</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Note</summary>
  <p>The transform is saved as 'transform.pkl' in the specified directory.
cloudpickle is used to handle complex objects like lambdas and closures.</p>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/transforms/base.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-631"><span class="k">def</span><span class="w"> </span><span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">directory</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">PathLike</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-632"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Save the transform to a directory using cloudpickle.</span>
</span><span id="__span-0-633">
</span><span id="__span-0-634"><span class="sd">    Args:</span>
</span><span id="__span-0-635"><span class="sd">        directory: Directory path to save the transform.</span>
</span><span id="__span-0-636">
</span><span id="__span-0-637"><span class="sd">    Note:</span>
</span><span id="__span-0-638"><span class="sd">        The transform is saved as &#39;transform.pkl&#39; in the specified directory.</span>
</span><span id="__span-0-639"><span class="sd">        cloudpickle is used to handle complex objects like lambdas and closures.</span>
</span><span id="__span-0-640">
</span><span id="__span-0-641"><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-642">    <span class="n">filepath</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">directory</span><span class="p">)</span> <span class="o">/</span> <span class="s2">&quot;transform.pkl&quot;</span>
</span><span id="__span-0-643">    <span class="k">with</span> <span class="n">filepath</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="__span-0-644">        <span class="n">cloudpickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.transforms.basic.MetadataTransform.load" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">load</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#formed.integrations.ml.transforms.basic.MetadataTransform.load" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">load</span><span class="p">(</span><span class="n">directory</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Load a transform from a directory.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>directory</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Directory path containing the saved transform.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="str">str</span> | <span title="os.PathLike">PathLike</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="typing.Self">Self</span></code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>The loaded transform instance.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RAISES</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
              <span class="doc-raises-annotation">
                  <code><span title="TypeError">TypeError</span></code>
              </span>
            </td>
            <td class="doc-raises-details">
              <div class="doc-md-description">
                <p>If the loaded object is not an instance of this class.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Note</summary>
  <p>Expects a 'transform.pkl' file in the specified directory.</p>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/transforms/base.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-646"><span class="nd">@classmethod</span>
</span><span id="__span-0-647"><span class="k">def</span><span class="w"> </span><span class="nf">load</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">directory</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">PathLike</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
</span><span id="__span-0-648"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Load a transform from a directory.</span>
</span><span id="__span-0-649">
</span><span id="__span-0-650"><span class="sd">    Args:</span>
</span><span id="__span-0-651"><span class="sd">        directory: Directory path containing the saved transform.</span>
</span><span id="__span-0-652">
</span><span id="__span-0-653"><span class="sd">    Returns:</span>
</span><span id="__span-0-654"><span class="sd">        The loaded transform instance.</span>
</span><span id="__span-0-655">
</span><span id="__span-0-656"><span class="sd">    Raises:</span>
</span><span id="__span-0-657"><span class="sd">        TypeError: If the loaded object is not an instance of this class.</span>
</span><span id="__span-0-658">
</span><span id="__span-0-659"><span class="sd">    Note:</span>
</span><span id="__span-0-660"><span class="sd">        Expects a &#39;transform.pkl&#39; file in the specified directory.</span>
</span><span id="__span-0-661">
</span><span id="__span-0-662"><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-663">    <span class="n">filepath</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">directory</span><span class="p">)</span> <span class="o">/</span> <span class="s2">&quot;transform.pkl&quot;</span>
</span><span id="__span-0-664">    <span class="k">with</span> <span class="n">filepath</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="__span-0-665">        <span class="n">obj</span> <span class="o">=</span> <span class="n">cloudpickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</span><span id="__span-0-666">    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="bp">cls</span><span class="p">):</span>
</span><span id="__span-0-667">        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Loaded object is not an instance of </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-0-668">    <span class="k">return</span> <span class="n">obj</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="formed.integrations.ml.transforms.basic.LabelIndexer" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">LabelIndexer</span>


<a href="#formed.integrations.ml.transforms.basic.LabelIndexer" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;BaseTransform&lt;/span&gt; (&lt;code&gt;formed.integrations.ml.transforms.base.BaseTransform&lt;/code&gt;)" href="#formed.integrations.ml.transforms.base.BaseTransform">BaseTransform</a>[<span title="formed.integrations.ml.transforms.basic._S">_S</span>, <span title="formed.integrations.ml.types.LabelT">LabelT</span>, <span title="int">int</span>, <span title="numpy.ndarray">ndarray</span>]</code>, <code><span title="typing.Generic">Generic</span>[<span title="formed.integrations.ml.transforms.basic._S">_S</span>, <span title="formed.integrations.ml.types.LabelT">LabelT</span>]</code></p>



        <p>Map labels to integer indices with vocabulary building and statistics tracking.</p>
<p>LabelIndexer maintains a bidirectional mapping between labels and integer indices.
In training mode, it dynamically builds the label vocabulary and tracks label
frequencies. The vocabulary can be frozen to prevent changes during inference.</p>


<table>
      <thead>
        <tr>
          <th>
            <span class="doc-section-title">
              CLASS TYPE PARAMETER
            </span>
          </th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>_S</code>
            </td>
            <td class="doc-type_param-details">
              <div class="doc-md-description">
                <p>Source data type before accessor</p>
              </div>
              <p>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>LabelT</code>
            </td>
            <td class="doc-type_param-details">
              <div class="doc-md-description">
                <p>Label type (must be hashable)</p>
              </div>
              <p>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">ATTRIBUTE</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-attribute&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-attribute-name&quot;&gt;label2id&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-class-attribute&quot;&gt;&lt;code&gt;class-attribute&lt;/code&gt;&lt;/small&gt;
      &lt;small class=&quot;doc doc-label doc-label-instance-attribute&quot;&gt;&lt;code&gt;instance-attribute&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;formed.integrations.ml.transforms.basic.LabelIndexer.label2id&lt;/code&gt;)" href="#formed.integrations.ml.transforms.basic.LabelIndexer.label2id">label2id</a></code></td>
            <td class="doc-attribute-details">
              <div class="doc-md-description">
                <p>Pre-defined label-to-index mapping. If empty, built during training.</p>
              </div>
              <p>
                  <span class="doc-attribute-annotation">
                    <b>TYPE:</b>
                      <code><span title="collections.abc.Sequence">Sequence</span>[<span title="tuple">tuple</span>[<span title="formed.integrations.ml.types.LabelT">LabelT</span>, <span title="int">int</span>]]</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-attribute&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-attribute-name&quot;&gt;freeze&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-class-attribute&quot;&gt;&lt;code&gt;class-attribute&lt;/code&gt;&lt;/small&gt;
      &lt;small class=&quot;doc doc-label doc-label-instance-attribute&quot;&gt;&lt;code&gt;instance-attribute&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;formed.integrations.ml.transforms.basic.LabelIndexer.freeze&lt;/code&gt;)" href="#formed.integrations.ml.transforms.basic.LabelIndexer.freeze">freeze</a></code></td>
            <td class="doc-attribute-details">
              <div class="doc-md-description">
                <p>If True, prevent vocabulary updates even in training mode.</p>
              </div>
              <p>
                  <span class="doc-attribute-annotation">
                    <b>TYPE:</b>
                      <code><span title="bool">bool</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<details class="properties" open>
  <summary>Properties</summary>
  <p>num_labels: Total number of unique labels in vocabulary.
labels: List of labels sorted by their indices.
occurrences: Dictionary mapping labels to their occurrence counts.
distribution: Smoothed probability distribution over labels.</p>
</details>

<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span id="__span-0-1"><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Dynamic vocabulary building</span>
</span><span id="__span-0-2"><span class="gp">&gt;&gt;&gt; </span><span class="n">indexer</span> <span class="o">=</span> <span class="n">LabelIndexer</span><span class="p">()</span>
</span><span id="__span-0-3"><span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">indexer</span><span class="o">.</span><span class="n">train</span><span class="p">():</span>
</span><span id="__span-0-4"><span class="gp">... </span>    <span class="n">idx1</span> <span class="o">=</span> <span class="n">indexer</span><span class="o">.</span><span class="n">instance</span><span class="p">(</span><span class="s2">&quot;positive&quot;</span><span class="p">)</span>  <span class="c1"># 0</span>
</span><span id="__span-0-5"><span class="gp">... </span>    <span class="n">idx2</span> <span class="o">=</span> <span class="n">indexer</span><span class="o">.</span><span class="n">instance</span><span class="p">(</span><span class="s2">&quot;negative&quot;</span><span class="p">)</span>  <span class="c1"># 1</span>
</span><span id="__span-0-6"><span class="gp">... </span>    <span class="n">idx3</span> <span class="o">=</span> <span class="n">indexer</span><span class="o">.</span><span class="n">instance</span><span class="p">(</span><span class="s2">&quot;positive&quot;</span><span class="p">)</span>  <span class="c1"># 0 (already in vocab)</span>
</span><span id="__span-0-7"><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">indexer</span><span class="o">.</span><span class="n">labels</span><span class="p">)</span>  <span class="c1"># [&quot;positive&quot;, &quot;negative&quot;]</span>
</span><span id="__span-0-8"><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">indexer</span><span class="o">.</span><span class="n">occurrences</span><span class="p">)</span>  <span class="c1"># {&quot;positive&quot;: 2, &quot;negative&quot;: 1}</span>
</span><span id="__span-0-9"><span class="gp">&gt;&gt;&gt;</span>
</span><span id="__span-0-10"><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Pre-defined vocabulary</span>
</span><span id="__span-0-11"><span class="gp">&gt;&gt;&gt; </span><span class="n">indexer</span> <span class="o">=</span> <span class="n">LabelIndexer</span><span class="p">(</span><span class="n">label2id</span><span class="o">=</span><span class="p">[(</span><span class="s2">&quot;positive&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;negative&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)])</span>
</span><span id="__span-0-12"><span class="gp">&gt;&gt;&gt; </span><span class="n">idx</span> <span class="o">=</span> <span class="n">indexer</span><span class="o">.</span><span class="n">instance</span><span class="p">(</span><span class="s2">&quot;positive&quot;</span><span class="p">)</span>  <span class="c1"># 0</span>
</span><span id="__span-0-13"><span class="gp">&gt;&gt;&gt;</span>
</span><span id="__span-0-14"><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Batching and reconstruction</span>
</span><span id="__span-0-15"><span class="gp">&gt;&gt;&gt; </span><span class="n">batch</span> <span class="o">=</span> <span class="n">indexer</span><span class="o">.</span><span class="n">batch</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>  <span class="c1"># np.array([0, 1, 0])</span>
</span><span id="__span-0-16"><span class="gp">&gt;&gt;&gt; </span><span class="n">labels</span> <span class="o">=</span> <span class="n">indexer</span><span class="o">.</span><span class="n">reconstruct</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span>  <span class="c1"># [&quot;positive&quot;, &quot;negative&quot;, &quot;positive&quot;]</span>
</span></code></pre></div>


<details class="note" open>
  <summary>Note</summary>
  <ul>
<li>Raises KeyError if a label is not in vocabulary during inference</li>
<li>Use freeze=True to prevent accidental vocabulary updates</li>
<li>Distribution uses Laplace smoothing (add-one)</li>
</ul>
</details>










<div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="formed.integrations.ml.transforms.basic.LabelIndexer.label2id" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">label2id</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#formed.integrations.ml.transforms.basic.LabelIndexer.label2id" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="n">label2id</span> <span class="o">=</span> <span class="n"><span title="dataclasses.field">field</span></span><span class="p">(</span><span class="n"><span title="dataclasses.field(default_factory)">default_factory</span></span><span class="o">=</span><span class="n"><span title="list">list</span></span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="formed.integrations.ml.transforms.basic.LabelIndexer.freeze" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">freeze</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#formed.integrations.ml.transforms.basic.LabelIndexer.freeze" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="n">freeze</span> <span class="o">=</span> <span class="n"><span title="dataclasses.field">field</span></span><span class="p">(</span><span class="n"><span title="dataclasses.field(default)">default</span></span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="formed.integrations.ml.transforms.basic.LabelIndexer.num_labels" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">num_labels</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#formed.integrations.ml.transforms.basic.LabelIndexer.num_labels" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="n">num_labels</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Get the total number of unique labels in the vocabulary.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="formed.integrations.ml.transforms.basic.LabelIndexer.labels" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">labels</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#formed.integrations.ml.transforms.basic.LabelIndexer.labels" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="n">labels</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Get the list of labels sorted by their indices.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="formed.integrations.ml.transforms.basic.LabelIndexer.occurrences" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">occurrences</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#formed.integrations.ml.transforms.basic.LabelIndexer.occurrences" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="n">occurrences</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Get the occurrence counts for each label seen during training.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="formed.integrations.ml.transforms.basic.LabelIndexer.distribution" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">distribution</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#formed.integrations.ml.transforms.basic.LabelIndexer.distribution" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="n">distribution</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Get the smoothed probability distribution over labels.</p>
<p>Uses Laplace (add-one) smoothing to handle zero counts.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="numpy.ndarray">ndarray</span></code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>Array of probabilities summing to 1.0, one per label.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="formed.integrations.ml.transforms.basic.LabelIndexer.accessor" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">accessor</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#formed.integrations.ml.transforms.basic.LabelIndexer.accessor" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="n">accessor</span> <span class="o">=</span> <span class="kc">None</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>




<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.transforms.basic.LabelIndexer.get_index" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">get_index</span>


<a href="#formed.integrations.ml.transforms.basic.LabelIndexer.get_index" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">get_index</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Get the integer index for a label.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>value</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The label to look up.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="formed.integrations.ml.types.LabelT">LabelT</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="int">int</span></code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>The integer index associated with the label.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RAISES</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
              <span class="doc-raises-annotation">
                  <code><span title="KeyError">KeyError</span></code>
              </span>
            </td>
            <td class="doc-raises-details">
              <div class="doc-md-description">
                <p>If the label is not in the vocabulary.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/transforms/basic.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-174"><span class="k">def</span><span class="w"> </span><span class="nf">get_index</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">LabelT</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="__span-0-175"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the integer index for a label.</span>
</span><span id="__span-0-176">
</span><span id="__span-0-177"><span class="sd">    Args:</span>
</span><span id="__span-0-178"><span class="sd">        value: The label to look up.</span>
</span><span id="__span-0-179">
</span><span id="__span-0-180"><span class="sd">    Returns:</span>
</span><span id="__span-0-181"><span class="sd">        The integer index associated with the label.</span>
</span><span id="__span-0-182">
</span><span id="__span-0-183"><span class="sd">    Raises:</span>
</span><span id="__span-0-184"><span class="sd">        KeyError: If the label is not in the vocabulary.</span>
</span><span id="__span-0-185">
</span><span id="__span-0-186"><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-187">    <span class="k">with</span> <span class="n">suppress</span><span class="p">(</span><span class="ne">StopIteration</span><span class="p">):</span>
</span><span id="__span-0-188">        <span class="k">return</span> <span class="nb">next</span><span class="p">(</span><span class="n">label_id</span> <span class="k">for</span> <span class="n">label</span><span class="p">,</span> <span class="n">label_id</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">label2id</span> <span class="k">if</span> <span class="n">label</span> <span class="o">==</span> <span class="n">value</span><span class="p">)</span>
</span><span id="__span-0-189">    <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.transforms.basic.LabelIndexer.get_value" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">get_value</span>


<a href="#formed.integrations.ml.transforms.basic.LabelIndexer.get_value" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">get_value</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Get the label for an integer index.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>index</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The integer index to look up.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="int">int</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="formed.integrations.ml.types.LabelT">LabelT</span></code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>The label associated with the index.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RAISES</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
              <span class="doc-raises-annotation">
                  <code><span title="KeyError">KeyError</span></code>
              </span>
            </td>
            <td class="doc-raises-details">
              <div class="doc-md-description">
                <p>If the index is not in the vocabulary.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/transforms/basic.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-191"><span class="k">def</span><span class="w"> </span><span class="nf">get_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">LabelT</span><span class="p">:</span>
</span><span id="__span-0-192"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the label for an integer index.</span>
</span><span id="__span-0-193">
</span><span id="__span-0-194"><span class="sd">    Args:</span>
</span><span id="__span-0-195"><span class="sd">        index: The integer index to look up.</span>
</span><span id="__span-0-196">
</span><span id="__span-0-197"><span class="sd">    Returns:</span>
</span><span id="__span-0-198"><span class="sd">        The label associated with the index.</span>
</span><span id="__span-0-199">
</span><span id="__span-0-200"><span class="sd">    Raises:</span>
</span><span id="__span-0-201"><span class="sd">        KeyError: If the index is not in the vocabulary.</span>
</span><span id="__span-0-202">
</span><span id="__span-0-203"><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-204">    <span class="k">for</span> <span class="n">label</span><span class="p">,</span> <span class="n">label_id</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">label2id</span><span class="p">:</span>
</span><span id="__span-0-205">        <span class="k">if</span> <span class="n">label_id</span> <span class="o">==</span> <span class="n">index</span><span class="p">:</span>
</span><span id="__span-0-206">            <span class="k">return</span> <span class="n">label</span>
</span><span id="__span-0-207">    <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.transforms.basic.LabelIndexer.ingest" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">ingest</span>


<a href="#formed.integrations.ml.transforms.basic.LabelIndexer.ingest" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">ingest</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Add a label to the vocabulary and update statistics.</p>
<p>This method is called internally during training to build the vocabulary
and track label frequencies.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>value</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The label to ingest.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="formed.integrations.ml.types.LabelT">LabelT</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Note</summary>
  <p>Only effective when in training mode and freeze=False.
Logs a warning if called outside training mode.</p>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/transforms/basic.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-209"><span class="k">def</span><span class="w"> </span><span class="nf">ingest</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">LabelT</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-210"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Add a label to the vocabulary and update statistics.</span>
</span><span id="__span-0-211">
</span><span id="__span-0-212"><span class="sd">    This method is called internally during training to build the vocabulary</span>
</span><span id="__span-0-213"><span class="sd">    and track label frequencies.</span>
</span><span id="__span-0-214">
</span><span id="__span-0-215"><span class="sd">    Args:</span>
</span><span id="__span-0-216"><span class="sd">        value: The label to ingest.</span>
</span><span id="__span-0-217">
</span><span id="__span-0-218"><span class="sd">    Note:</span>
</span><span id="__span-0-219"><span class="sd">        Only effective when in training mode and freeze=False.</span>
</span><span id="__span-0-220"><span class="sd">        Logs a warning if called outside training mode.</span>
</span><span id="__span-0-221">
</span><span id="__span-0-222"><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-223">    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">freeze</span><span class="p">:</span>
</span><span id="__span-0-224">        <span class="k">return</span>
</span><span id="__span-0-225">    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_training</span><span class="p">:</span>
</span><span id="__span-0-226">        <span class="k">try</span><span class="p">:</span>
</span><span id="__span-0-227">            <span class="bp">self</span><span class="o">.</span><span class="n">get_index</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="__span-0-228">        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
</span><span id="__span-0-229">            <span class="bp">self</span><span class="o">.</span><span class="n">label2id</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">label2id</span><span class="p">)</span> <span class="o">+</span> <span class="p">[(</span><span class="n">value</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">label2id</span><span class="p">))]</span>
</span><span id="__span-0-230">            <span class="bp">self</span><span class="o">.</span><span class="n">_label_counts</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">value</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
</span><span id="__span-0-231">        <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="n">count</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_label_counts</span><span class="p">):</span>
</span><span id="__span-0-232">            <span class="k">if</span> <span class="n">label</span> <span class="o">==</span> <span class="n">value</span><span class="p">:</span>
</span><span id="__span-0-233">                <span class="bp">self</span><span class="o">.</span><span class="n">_label_counts</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="n">count</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="__span-0-234">                <span class="k">break</span>
</span><span id="__span-0-235">    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-236">        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Ignoring ingest call when not in training mode&quot;</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.transforms.basic.LabelIndexer.instance" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">instance</span>


<a href="#formed.integrations.ml.transforms.basic.LabelIndexer.instance" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">instance</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/transforms/basic.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-238"><span class="k">def</span><span class="w"> </span><span class="nf">instance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">label</span><span class="p">:</span> <span class="n">LabelT</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="__span-0-239">    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_training</span><span class="p">:</span>
</span><span id="__span-0-240">        <span class="bp">self</span><span class="o">.</span><span class="n">ingest</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
</span><span id="__span-0-241">    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_index</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.transforms.basic.LabelIndexer.batch" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">batch</span>


<a href="#formed.integrations.ml.transforms.basic.LabelIndexer.batch" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">batch</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/transforms/basic.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">243</span>
<span class="normal">244</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-243"><span class="k">def</span><span class="w"> </span><span class="nf">batch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
</span><span id="__span-0-244">    <span class="k">return</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">batch</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.transforms.basic.LabelIndexer.reconstruct" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">reconstruct</span>


<a href="#formed.integrations.ml.transforms.basic.LabelIndexer.reconstruct" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">reconstruct</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Convert a batch of indices back to labels.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>batch</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Array of integer indices.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="numpy.ndarray">ndarray</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="list">list</span>[<span title="formed.integrations.ml.types.LabelT">LabelT</span>]</code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>List of labels corresponding to the indices.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span id="__span-0-1"><span class="gp">&gt;&gt;&gt; </span><span class="n">indexer</span> <span class="o">=</span> <span class="n">LabelIndexer</span><span class="p">(</span><span class="n">label2id</span><span class="o">=</span><span class="p">[(</span><span class="s2">&quot;cat&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;dog&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)])</span>
</span><span id="__span-0-2"><span class="gp">&gt;&gt;&gt; </span><span class="n">indices</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
</span><span id="__span-0-3"><span class="gp">&gt;&gt;&gt; </span><span class="n">labels</span> <span class="o">=</span> <span class="n">indexer</span><span class="o">.</span><span class="n">reconstruct</span><span class="p">(</span><span class="n">indices</span><span class="p">)</span>
</span><span id="__span-0-4"><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>  <span class="c1"># [&quot;cat&quot;, &quot;dog&quot;, &quot;cat&quot;]</span>
</span></code></pre></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/transforms/basic.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-246"><span class="k">def</span><span class="w"> </span><span class="nf">reconstruct</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">LabelT</span><span class="p">]:</span>
</span><span id="__span-0-247"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert a batch of indices back to labels.</span>
</span><span id="__span-0-248">
</span><span id="__span-0-249"><span class="sd">    Args:</span>
</span><span id="__span-0-250"><span class="sd">        batch: Array of integer indices.</span>
</span><span id="__span-0-251">
</span><span id="__span-0-252"><span class="sd">    Returns:</span>
</span><span id="__span-0-253"><span class="sd">        List of labels corresponding to the indices.</span>
</span><span id="__span-0-254">
</span><span id="__span-0-255"><span class="sd">    Examples:</span>
</span><span id="__span-0-256"><span class="sd">        &gt;&gt;&gt; indexer = LabelIndexer(label2id=[(&quot;cat&quot;, 0), (&quot;dog&quot;, 1)])</span>
</span><span id="__span-0-257"><span class="sd">        &gt;&gt;&gt; indices = numpy.array([0, 1, 0])</span>
</span><span id="__span-0-258"><span class="sd">        &gt;&gt;&gt; labels = indexer.reconstruct(indices)</span>
</span><span id="__span-0-259"><span class="sd">        &gt;&gt;&gt; print(labels)  # [&quot;cat&quot;, &quot;dog&quot;, &quot;cat&quot;]</span>
</span><span id="__span-0-260">
</span><span id="__span-0-261"><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-262">    <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">get_value</span><span class="p">(</span><span class="n">index</span><span class="p">)</span> <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="n">batch</span><span class="o">.</span><span class="n">tolist</span><span class="p">()]</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.transforms.basic.LabelIndexer.train" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">train</span>


<a href="#formed.integrations.ml.transforms.basic.LabelIndexer.train" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">train</span><span class="p">()</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Context manager to enable training mode for stateful transformations.</p>
<p>In training mode, transforms can build state (e.g., vocabularies, statistics)
from the training data. Hooks <code>_on_start_training()</code> and <code>_on_end_training()</code>
are called at the beginning and end of the training context.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">YIELDS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-yields-annotation">
                    <code>None</code>
                </span>
            </td>
            <td class="doc-yields-details">
              <div class="doc-md-description">
                <p>None</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span id="__span-0-1"><span class="gp">&gt;&gt;&gt; </span><span class="n">indexer</span> <span class="o">=</span> <span class="n">TokenSequenceIndexer</span><span class="p">()</span>
</span><span id="__span-0-2"><span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">indexer</span><span class="o">.</span><span class="n">train</span><span class="p">():</span>
</span><span id="__span-0-3"><span class="gp">... </span>    <span class="c1"># Build vocabulary from training data</span>
</span><span id="__span-0-4"><span class="gp">... </span>    <span class="n">tokens1</span> <span class="o">=</span> <span class="n">indexer</span><span class="o">.</span><span class="n">instance</span><span class="p">([</span><span class="s2">&quot;hello&quot;</span><span class="p">,</span> <span class="s2">&quot;world&quot;</span><span class="p">])</span>
</span><span id="__span-0-5"><span class="gp">... </span>    <span class="n">tokens2</span> <span class="o">=</span> <span class="n">indexer</span><span class="o">.</span><span class="n">instance</span><span class="p">([</span><span class="s2">&quot;hello&quot;</span><span class="p">,</span> <span class="s2">&quot;there&quot;</span><span class="p">])</span>
</span><span id="__span-0-6"><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Vocabulary is now frozen, use for inference</span>
</span><span id="__span-0-7"><span class="gp">&gt;&gt;&gt; </span><span class="n">test_tokens</span> <span class="o">=</span> <span class="n">indexer</span><span class="o">.</span><span class="n">instance</span><span class="p">([</span><span class="s2">&quot;hello&quot;</span><span class="p">,</span> <span class="s2">&quot;unknown&quot;</span><span class="p">])</span>
</span></code></pre></div>


<details class="note" open>
  <summary>Note</summary>
  <p>Training mode is reentrant but nested calls won't trigger hooks again.</p>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/transforms/base.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-596"><span class="nd">@contextmanager</span>
</span><span id="__span-0-597"><span class="k">def</span><span class="w"> </span><span class="nf">train</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="kc">None</span><span class="p">]:</span>
</span><span id="__span-0-598"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Context manager to enable training mode for stateful transformations.</span>
</span><span id="__span-0-599">
</span><span id="__span-0-600"><span class="sd">    In training mode, transforms can build state (e.g., vocabularies, statistics)</span>
</span><span id="__span-0-601"><span class="sd">    from the training data. Hooks `_on_start_training()` and `_on_end_training()`</span>
</span><span id="__span-0-602"><span class="sd">    are called at the beginning and end of the training context.</span>
</span><span id="__span-0-603">
</span><span id="__span-0-604"><span class="sd">    Yields:</span>
</span><span id="__span-0-605"><span class="sd">        None</span>
</span><span id="__span-0-606">
</span><span id="__span-0-607"><span class="sd">    Examples:</span>
</span><span id="__span-0-608"><span class="sd">        &gt;&gt;&gt; indexer = TokenSequenceIndexer()</span>
</span><span id="__span-0-609"><span class="sd">        &gt;&gt;&gt; with indexer.train():</span>
</span><span id="__span-0-610"><span class="sd">        ...     # Build vocabulary from training data</span>
</span><span id="__span-0-611"><span class="sd">        ...     tokens1 = indexer.instance([&quot;hello&quot;, &quot;world&quot;])</span>
</span><span id="__span-0-612"><span class="sd">        ...     tokens2 = indexer.instance([&quot;hello&quot;, &quot;there&quot;])</span>
</span><span id="__span-0-613"><span class="sd">        &gt;&gt;&gt; # Vocabulary is now frozen, use for inference</span>
</span><span id="__span-0-614"><span class="sd">        &gt;&gt;&gt; test_tokens = indexer.instance([&quot;hello&quot;, &quot;unknown&quot;])</span>
</span><span id="__span-0-615">
</span><span id="__span-0-616"><span class="sd">    Note:</span>
</span><span id="__span-0-617"><span class="sd">        Training mode is reentrant but nested calls won&#39;t trigger hooks again.</span>
</span><span id="__span-0-618">
</span><span id="__span-0-619"><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-620">    <span class="n">original</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_training</span>
</span><span id="__span-0-621">    <span class="bp">self</span><span class="o">.</span><span class="n">_training</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="__span-0-622">    <span class="k">try</span><span class="p">:</span>
</span><span id="__span-0-623">        <span class="k">if</span> <span class="ow">not</span> <span class="n">original</span><span class="p">:</span>
</span><span id="__span-0-624">            <span class="bp">self</span><span class="o">.</span><span class="n">_on_start_training</span><span class="p">()</span>
</span><span id="__span-0-625">        <span class="k">yield</span>
</span><span id="__span-0-626">        <span class="k">if</span> <span class="ow">not</span> <span class="n">original</span><span class="p">:</span>
</span><span id="__span-0-627">            <span class="bp">self</span><span class="o">.</span><span class="n">_on_end_training</span><span class="p">()</span>
</span><span id="__span-0-628">    <span class="k">finally</span><span class="p">:</span>
</span><span id="__span-0-629">        <span class="bp">self</span><span class="o">.</span><span class="n">_training</span> <span class="o">=</span> <span class="n">original</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.transforms.basic.LabelIndexer.save" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">save</span>


<a href="#formed.integrations.ml.transforms.basic.LabelIndexer.save" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">save</span><span class="p">(</span><span class="n">directory</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Save the transform to a directory using cloudpickle.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>directory</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Directory path to save the transform.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="str">str</span> | <span title="os.PathLike">PathLike</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Note</summary>
  <p>The transform is saved as 'transform.pkl' in the specified directory.
cloudpickle is used to handle complex objects like lambdas and closures.</p>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/transforms/base.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-631"><span class="k">def</span><span class="w"> </span><span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">directory</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">PathLike</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-632"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Save the transform to a directory using cloudpickle.</span>
</span><span id="__span-0-633">
</span><span id="__span-0-634"><span class="sd">    Args:</span>
</span><span id="__span-0-635"><span class="sd">        directory: Directory path to save the transform.</span>
</span><span id="__span-0-636">
</span><span id="__span-0-637"><span class="sd">    Note:</span>
</span><span id="__span-0-638"><span class="sd">        The transform is saved as &#39;transform.pkl&#39; in the specified directory.</span>
</span><span id="__span-0-639"><span class="sd">        cloudpickle is used to handle complex objects like lambdas and closures.</span>
</span><span id="__span-0-640">
</span><span id="__span-0-641"><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-642">    <span class="n">filepath</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">directory</span><span class="p">)</span> <span class="o">/</span> <span class="s2">&quot;transform.pkl&quot;</span>
</span><span id="__span-0-643">    <span class="k">with</span> <span class="n">filepath</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="__span-0-644">        <span class="n">cloudpickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.transforms.basic.LabelIndexer.load" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">load</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#formed.integrations.ml.transforms.basic.LabelIndexer.load" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">load</span><span class="p">(</span><span class="n">directory</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Load a transform from a directory.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>directory</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Directory path containing the saved transform.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="str">str</span> | <span title="os.PathLike">PathLike</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="typing.Self">Self</span></code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>The loaded transform instance.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RAISES</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
              <span class="doc-raises-annotation">
                  <code><span title="TypeError">TypeError</span></code>
              </span>
            </td>
            <td class="doc-raises-details">
              <div class="doc-md-description">
                <p>If the loaded object is not an instance of this class.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Note</summary>
  <p>Expects a 'transform.pkl' file in the specified directory.</p>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/transforms/base.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-646"><span class="nd">@classmethod</span>
</span><span id="__span-0-647"><span class="k">def</span><span class="w"> </span><span class="nf">load</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">directory</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">PathLike</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
</span><span id="__span-0-648"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Load a transform from a directory.</span>
</span><span id="__span-0-649">
</span><span id="__span-0-650"><span class="sd">    Args:</span>
</span><span id="__span-0-651"><span class="sd">        directory: Directory path containing the saved transform.</span>
</span><span id="__span-0-652">
</span><span id="__span-0-653"><span class="sd">    Returns:</span>
</span><span id="__span-0-654"><span class="sd">        The loaded transform instance.</span>
</span><span id="__span-0-655">
</span><span id="__span-0-656"><span class="sd">    Raises:</span>
</span><span id="__span-0-657"><span class="sd">        TypeError: If the loaded object is not an instance of this class.</span>
</span><span id="__span-0-658">
</span><span id="__span-0-659"><span class="sd">    Note:</span>
</span><span id="__span-0-660"><span class="sd">        Expects a &#39;transform.pkl&#39; file in the specified directory.</span>
</span><span id="__span-0-661">
</span><span id="__span-0-662"><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-663">    <span class="n">filepath</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">directory</span><span class="p">)</span> <span class="o">/</span> <span class="s2">&quot;transform.pkl&quot;</span>
</span><span id="__span-0-664">    <span class="k">with</span> <span class="n">filepath</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="__span-0-665">        <span class="n">obj</span> <span class="o">=</span> <span class="n">cloudpickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</span><span id="__span-0-666">    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="bp">cls</span><span class="p">):</span>
</span><span id="__span-0-667">        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Loaded object is not an instance of </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-0-668">    <span class="k">return</span> <span class="n">obj</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="formed.integrations.ml.transforms.basic.ScalarTransform" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">ScalarTransform</span>


<a href="#formed.integrations.ml.transforms.basic.ScalarTransform" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="typing.Generic">Generic</span>[<span title="formed.integrations.ml.transforms.basic._S">_S</span>]</code>, <code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;BaseTransform&lt;/span&gt; (&lt;code&gt;formed.integrations.ml.transforms.base.BaseTransform&lt;/code&gt;)" href="#formed.integrations.ml.transforms.base.BaseTransform">BaseTransform</a>[<span title="formed.integrations.ml.transforms.basic._S">_S</span>, <span title="float">float</span>, <span title="float">float</span>, <span title="numpy.ndarray">ndarray</span>]</code></p>



        <p>Transform scalar values into batched numpy arrays.</p>
<p>ScalarTransform is a simple pass-through transform that preserves scalar
values during instance transformation and stacks them into a 1D numpy array
during batching.</p>


<table>
      <thead>
        <tr>
          <th>
            <span class="doc-section-title">
              CLASS TYPE PARAMETER
            </span>
          </th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>_S</code>
            </td>
            <td class="doc-type_param-details">
              <div class="doc-md-description">
                <p>Source data type before accessor</p>
              </div>
              <p>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span id="__span-0-1"><span class="gp">&gt;&gt;&gt; </span><span class="n">transform</span> <span class="o">=</span> <span class="n">ScalarTransform</span><span class="p">(</span><span class="n">accessor</span><span class="o">=</span><span class="s2">&quot;score&quot;</span><span class="p">)</span>
</span><span id="__span-0-2"><span class="gp">&gt;&gt;&gt; </span><span class="n">value</span> <span class="o">=</span> <span class="n">transform</span><span class="p">({</span><span class="s2">&quot;score&quot;</span><span class="p">:</span> <span class="mf">0.85</span><span class="p">})</span>  <span class="c1"># Returns 0.85</span>
</span><span id="__span-0-3"><span class="gp">&gt;&gt;&gt; </span><span class="n">batch</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">batch</span><span class="p">([</span><span class="mf">0.85</span><span class="p">,</span> <span class="mf">0.92</span><span class="p">,</span> <span class="mf">0.78</span><span class="p">])</span>
</span><span id="__span-0-4"><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span>  <span class="c1"># np.array([0.85, 0.92, 0.78], dtype=float32)</span>
</span><span id="__span-0-5"><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">batch</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>  <span class="c1"># (3,)</span>
</span></code></pre></div>


<details class="note" open>
  <summary>Note</summary>
  <ul>
<li>Instance values remain as Python floats</li>
<li>Batch values are converted to float32 numpy arrays</li>
<li>Stateless transform, no training required</li>
</ul>
</details>










<div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="formed.integrations.ml.transforms.basic.ScalarTransform.accessor" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">accessor</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#formed.integrations.ml.transforms.basic.ScalarTransform.accessor" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="n">accessor</span> <span class="o">=</span> <span class="kc">None</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>




<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.transforms.basic.ScalarTransform.instance" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">instance</span>


<a href="#formed.integrations.ml.transforms.basic.ScalarTransform.instance" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">instance</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/transforms/basic.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">293</span>
<span class="normal">294</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-293"><span class="k">def</span><span class="w"> </span><span class="nf">instance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="__span-0-294">    <span class="k">return</span> <span class="n">value</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.transforms.basic.ScalarTransform.batch" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">batch</span>


<a href="#formed.integrations.ml.transforms.basic.ScalarTransform.batch" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">batch</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/transforms/basic.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">296</span>
<span class="normal">297</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-296"><span class="k">def</span><span class="w"> </span><span class="nf">batch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
</span><span id="__span-0-297">    <span class="k">return</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">batch</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.transforms.basic.ScalarTransform.train" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">train</span>


<a href="#formed.integrations.ml.transforms.basic.ScalarTransform.train" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">train</span><span class="p">()</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Context manager to enable training mode for stateful transformations.</p>
<p>In training mode, transforms can build state (e.g., vocabularies, statistics)
from the training data. Hooks <code>_on_start_training()</code> and <code>_on_end_training()</code>
are called at the beginning and end of the training context.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">YIELDS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-yields-annotation">
                    <code>None</code>
                </span>
            </td>
            <td class="doc-yields-details">
              <div class="doc-md-description">
                <p>None</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span id="__span-0-1"><span class="gp">&gt;&gt;&gt; </span><span class="n">indexer</span> <span class="o">=</span> <span class="n">TokenSequenceIndexer</span><span class="p">()</span>
</span><span id="__span-0-2"><span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">indexer</span><span class="o">.</span><span class="n">train</span><span class="p">():</span>
</span><span id="__span-0-3"><span class="gp">... </span>    <span class="c1"># Build vocabulary from training data</span>
</span><span id="__span-0-4"><span class="gp">... </span>    <span class="n">tokens1</span> <span class="o">=</span> <span class="n">indexer</span><span class="o">.</span><span class="n">instance</span><span class="p">([</span><span class="s2">&quot;hello&quot;</span><span class="p">,</span> <span class="s2">&quot;world&quot;</span><span class="p">])</span>
</span><span id="__span-0-5"><span class="gp">... </span>    <span class="n">tokens2</span> <span class="o">=</span> <span class="n">indexer</span><span class="o">.</span><span class="n">instance</span><span class="p">([</span><span class="s2">&quot;hello&quot;</span><span class="p">,</span> <span class="s2">&quot;there&quot;</span><span class="p">])</span>
</span><span id="__span-0-6"><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Vocabulary is now frozen, use for inference</span>
</span><span id="__span-0-7"><span class="gp">&gt;&gt;&gt; </span><span class="n">test_tokens</span> <span class="o">=</span> <span class="n">indexer</span><span class="o">.</span><span class="n">instance</span><span class="p">([</span><span class="s2">&quot;hello&quot;</span><span class="p">,</span> <span class="s2">&quot;unknown&quot;</span><span class="p">])</span>
</span></code></pre></div>


<details class="note" open>
  <summary>Note</summary>
  <p>Training mode is reentrant but nested calls won't trigger hooks again.</p>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/transforms/base.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-596"><span class="nd">@contextmanager</span>
</span><span id="__span-0-597"><span class="k">def</span><span class="w"> </span><span class="nf">train</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="kc">None</span><span class="p">]:</span>
</span><span id="__span-0-598"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Context manager to enable training mode for stateful transformations.</span>
</span><span id="__span-0-599">
</span><span id="__span-0-600"><span class="sd">    In training mode, transforms can build state (e.g., vocabularies, statistics)</span>
</span><span id="__span-0-601"><span class="sd">    from the training data. Hooks `_on_start_training()` and `_on_end_training()`</span>
</span><span id="__span-0-602"><span class="sd">    are called at the beginning and end of the training context.</span>
</span><span id="__span-0-603">
</span><span id="__span-0-604"><span class="sd">    Yields:</span>
</span><span id="__span-0-605"><span class="sd">        None</span>
</span><span id="__span-0-606">
</span><span id="__span-0-607"><span class="sd">    Examples:</span>
</span><span id="__span-0-608"><span class="sd">        &gt;&gt;&gt; indexer = TokenSequenceIndexer()</span>
</span><span id="__span-0-609"><span class="sd">        &gt;&gt;&gt; with indexer.train():</span>
</span><span id="__span-0-610"><span class="sd">        ...     # Build vocabulary from training data</span>
</span><span id="__span-0-611"><span class="sd">        ...     tokens1 = indexer.instance([&quot;hello&quot;, &quot;world&quot;])</span>
</span><span id="__span-0-612"><span class="sd">        ...     tokens2 = indexer.instance([&quot;hello&quot;, &quot;there&quot;])</span>
</span><span id="__span-0-613"><span class="sd">        &gt;&gt;&gt; # Vocabulary is now frozen, use for inference</span>
</span><span id="__span-0-614"><span class="sd">        &gt;&gt;&gt; test_tokens = indexer.instance([&quot;hello&quot;, &quot;unknown&quot;])</span>
</span><span id="__span-0-615">
</span><span id="__span-0-616"><span class="sd">    Note:</span>
</span><span id="__span-0-617"><span class="sd">        Training mode is reentrant but nested calls won&#39;t trigger hooks again.</span>
</span><span id="__span-0-618">
</span><span id="__span-0-619"><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-620">    <span class="n">original</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_training</span>
</span><span id="__span-0-621">    <span class="bp">self</span><span class="o">.</span><span class="n">_training</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="__span-0-622">    <span class="k">try</span><span class="p">:</span>
</span><span id="__span-0-623">        <span class="k">if</span> <span class="ow">not</span> <span class="n">original</span><span class="p">:</span>
</span><span id="__span-0-624">            <span class="bp">self</span><span class="o">.</span><span class="n">_on_start_training</span><span class="p">()</span>
</span><span id="__span-0-625">        <span class="k">yield</span>
</span><span id="__span-0-626">        <span class="k">if</span> <span class="ow">not</span> <span class="n">original</span><span class="p">:</span>
</span><span id="__span-0-627">            <span class="bp">self</span><span class="o">.</span><span class="n">_on_end_training</span><span class="p">()</span>
</span><span id="__span-0-628">    <span class="k">finally</span><span class="p">:</span>
</span><span id="__span-0-629">        <span class="bp">self</span><span class="o">.</span><span class="n">_training</span> <span class="o">=</span> <span class="n">original</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.transforms.basic.ScalarTransform.save" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">save</span>


<a href="#formed.integrations.ml.transforms.basic.ScalarTransform.save" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">save</span><span class="p">(</span><span class="n">directory</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Save the transform to a directory using cloudpickle.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>directory</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Directory path to save the transform.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="str">str</span> | <span title="os.PathLike">PathLike</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Note</summary>
  <p>The transform is saved as 'transform.pkl' in the specified directory.
cloudpickle is used to handle complex objects like lambdas and closures.</p>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/transforms/base.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-631"><span class="k">def</span><span class="w"> </span><span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">directory</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">PathLike</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-632"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Save the transform to a directory using cloudpickle.</span>
</span><span id="__span-0-633">
</span><span id="__span-0-634"><span class="sd">    Args:</span>
</span><span id="__span-0-635"><span class="sd">        directory: Directory path to save the transform.</span>
</span><span id="__span-0-636">
</span><span id="__span-0-637"><span class="sd">    Note:</span>
</span><span id="__span-0-638"><span class="sd">        The transform is saved as &#39;transform.pkl&#39; in the specified directory.</span>
</span><span id="__span-0-639"><span class="sd">        cloudpickle is used to handle complex objects like lambdas and closures.</span>
</span><span id="__span-0-640">
</span><span id="__span-0-641"><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-642">    <span class="n">filepath</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">directory</span><span class="p">)</span> <span class="o">/</span> <span class="s2">&quot;transform.pkl&quot;</span>
</span><span id="__span-0-643">    <span class="k">with</span> <span class="n">filepath</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="__span-0-644">        <span class="n">cloudpickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.transforms.basic.ScalarTransform.load" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">load</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#formed.integrations.ml.transforms.basic.ScalarTransform.load" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">load</span><span class="p">(</span><span class="n">directory</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Load a transform from a directory.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>directory</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Directory path containing the saved transform.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="str">str</span> | <span title="os.PathLike">PathLike</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="typing.Self">Self</span></code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>The loaded transform instance.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RAISES</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
              <span class="doc-raises-annotation">
                  <code><span title="TypeError">TypeError</span></code>
              </span>
            </td>
            <td class="doc-raises-details">
              <div class="doc-md-description">
                <p>If the loaded object is not an instance of this class.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Note</summary>
  <p>Expects a 'transform.pkl' file in the specified directory.</p>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/transforms/base.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-646"><span class="nd">@classmethod</span>
</span><span id="__span-0-647"><span class="k">def</span><span class="w"> </span><span class="nf">load</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">directory</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">PathLike</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
</span><span id="__span-0-648"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Load a transform from a directory.</span>
</span><span id="__span-0-649">
</span><span id="__span-0-650"><span class="sd">    Args:</span>
</span><span id="__span-0-651"><span class="sd">        directory: Directory path containing the saved transform.</span>
</span><span id="__span-0-652">
</span><span id="__span-0-653"><span class="sd">    Returns:</span>
</span><span id="__span-0-654"><span class="sd">        The loaded transform instance.</span>
</span><span id="__span-0-655">
</span><span id="__span-0-656"><span class="sd">    Raises:</span>
</span><span id="__span-0-657"><span class="sd">        TypeError: If the loaded object is not an instance of this class.</span>
</span><span id="__span-0-658">
</span><span id="__span-0-659"><span class="sd">    Note:</span>
</span><span id="__span-0-660"><span class="sd">        Expects a &#39;transform.pkl&#39; file in the specified directory.</span>
</span><span id="__span-0-661">
</span><span id="__span-0-662"><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-663">    <span class="n">filepath</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">directory</span><span class="p">)</span> <span class="o">/</span> <span class="s2">&quot;transform.pkl&quot;</span>
</span><span id="__span-0-664">    <span class="k">with</span> <span class="n">filepath</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="__span-0-665">        <span class="n">obj</span> <span class="o">=</span> <span class="n">cloudpickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</span><span id="__span-0-666">    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="bp">cls</span><span class="p">):</span>
</span><span id="__span-0-667">        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Loaded object is not an instance of </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-0-668">    <span class="k">return</span> <span class="n">obj</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="formed.integrations.ml.transforms.basic.TensorTransform" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">TensorTransform</span>


<a href="#formed.integrations.ml.transforms.basic.TensorTransform" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="typing.Generic">Generic</span>[<span title="formed.integrations.ml.transforms.basic._S">_S</span>]</code>, <code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;BaseTransform&lt;/span&gt; (&lt;code&gt;formed.integrations.ml.transforms.base.BaseTransform&lt;/code&gt;)" href="#formed.integrations.ml.transforms.base.BaseTransform">BaseTransform</a>[<span title="formed.integrations.ml.transforms.basic._S">_S</span>, <span title="numpy.ndarray">ndarray</span>, <span title="numpy.ndarray">ndarray</span>, <span title="numpy.ndarray">ndarray</span>]</code></p>



        <p>Transform numpy arrays into batched tensors.</p>
<p>TensorTransform preserves numpy arrays during instance transformation and
stacks them along the batch dimension (axis 0) during batching. All arrays
in a batch must have the same shape.</p>


<table>
      <thead>
        <tr>
          <th>
            <span class="doc-section-title">
              CLASS TYPE PARAMETER
            </span>
          </th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>_S</code>
            </td>
            <td class="doc-type_param-details">
              <div class="doc-md-description">
                <p>Source data type before accessor</p>
              </div>
              <p>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span id="__span-0-1"><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
</span><span id="__span-0-2"><span class="gp">&gt;&gt;&gt; </span><span class="n">transform</span> <span class="o">=</span> <span class="n">TensorTransform</span><span class="p">(</span><span class="n">accessor</span><span class="o">=</span><span class="s2">&quot;features&quot;</span><span class="p">)</span>
</span><span id="__span-0-3"><span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">transform</span><span class="p">({</span><span class="s2">&quot;features&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">])})</span>
</span><span id="__span-0-4"><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>  <span class="c1"># np.array([1.0, 2.0, 3.0])</span>
</span><span id="__span-0-5"><span class="gp">&gt;&gt;&gt;</span>
</span><span id="__span-0-6"><span class="gp">&gt;&gt;&gt; </span><span class="n">batch</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">batch</span><span class="p">([</span>
</span><span id="__span-0-7"><span class="gp">... </span>    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">]),</span>
</span><span id="__span-0-8"><span class="gp">... </span>    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">4.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">,</span> <span class="mf">6.0</span><span class="p">]),</span>
</span><span id="__span-0-9"><span class="gp">... </span><span class="p">])</span>
</span><span id="__span-0-10"><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">batch</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>  <span class="c1"># (2, 3)</span>
</span></code></pre></div>


<details class="note" open>
  <summary>Note</summary>
  <ul>
<li>Requires all arrays in a batch to have compatible shapes</li>
<li>Stacks along axis 0 (batch dimension)</li>
<li>Stateless transform, no training required</li>
</ul>
</details>

<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RAISES</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
              <span class="doc-raises-annotation">
                  <code><span title="ValueError">ValueError</span></code>
              </span>
            </td>
            <td class="doc-raises-details">
              <div class="doc-md-description">
                <p>If arrays have incompatible shapes for stacking.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>











<div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="formed.integrations.ml.transforms.basic.TensorTransform.accessor" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">accessor</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#formed.integrations.ml.transforms.basic.TensorTransform.accessor" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="n">accessor</span> <span class="o">=</span> <span class="kc">None</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>




<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.transforms.basic.TensorTransform.instance" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">instance</span>


<a href="#formed.integrations.ml.transforms.basic.TensorTransform.instance" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">instance</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/transforms/basic.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">336</span>
<span class="normal">337</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-336"><span class="k">def</span><span class="w"> </span><span class="nf">instance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
</span><span id="__span-0-337">    <span class="k">return</span> <span class="n">value</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.transforms.basic.TensorTransform.batch" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">batch</span>


<a href="#formed.integrations.ml.transforms.basic.TensorTransform.batch" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">batch</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/transforms/basic.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">339</span>
<span class="normal">340</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-339"><span class="k">def</span><span class="w"> </span><span class="nf">batch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
</span><span id="__span-0-340">    <span class="k">return</span> <span class="n">numpy</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">batch</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.transforms.basic.TensorTransform.train" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">train</span>


<a href="#formed.integrations.ml.transforms.basic.TensorTransform.train" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">train</span><span class="p">()</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Context manager to enable training mode for stateful transformations.</p>
<p>In training mode, transforms can build state (e.g., vocabularies, statistics)
from the training data. Hooks <code>_on_start_training()</code> and <code>_on_end_training()</code>
are called at the beginning and end of the training context.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">YIELDS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-yields-annotation">
                    <code>None</code>
                </span>
            </td>
            <td class="doc-yields-details">
              <div class="doc-md-description">
                <p>None</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span id="__span-0-1"><span class="gp">&gt;&gt;&gt; </span><span class="n">indexer</span> <span class="o">=</span> <span class="n">TokenSequenceIndexer</span><span class="p">()</span>
</span><span id="__span-0-2"><span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">indexer</span><span class="o">.</span><span class="n">train</span><span class="p">():</span>
</span><span id="__span-0-3"><span class="gp">... </span>    <span class="c1"># Build vocabulary from training data</span>
</span><span id="__span-0-4"><span class="gp">... </span>    <span class="n">tokens1</span> <span class="o">=</span> <span class="n">indexer</span><span class="o">.</span><span class="n">instance</span><span class="p">([</span><span class="s2">&quot;hello&quot;</span><span class="p">,</span> <span class="s2">&quot;world&quot;</span><span class="p">])</span>
</span><span id="__span-0-5"><span class="gp">... </span>    <span class="n">tokens2</span> <span class="o">=</span> <span class="n">indexer</span><span class="o">.</span><span class="n">instance</span><span class="p">([</span><span class="s2">&quot;hello&quot;</span><span class="p">,</span> <span class="s2">&quot;there&quot;</span><span class="p">])</span>
</span><span id="__span-0-6"><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Vocabulary is now frozen, use for inference</span>
</span><span id="__span-0-7"><span class="gp">&gt;&gt;&gt; </span><span class="n">test_tokens</span> <span class="o">=</span> <span class="n">indexer</span><span class="o">.</span><span class="n">instance</span><span class="p">([</span><span class="s2">&quot;hello&quot;</span><span class="p">,</span> <span class="s2">&quot;unknown&quot;</span><span class="p">])</span>
</span></code></pre></div>


<details class="note" open>
  <summary>Note</summary>
  <p>Training mode is reentrant but nested calls won't trigger hooks again.</p>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/transforms/base.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-596"><span class="nd">@contextmanager</span>
</span><span id="__span-0-597"><span class="k">def</span><span class="w"> </span><span class="nf">train</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="kc">None</span><span class="p">]:</span>
</span><span id="__span-0-598"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Context manager to enable training mode for stateful transformations.</span>
</span><span id="__span-0-599">
</span><span id="__span-0-600"><span class="sd">    In training mode, transforms can build state (e.g., vocabularies, statistics)</span>
</span><span id="__span-0-601"><span class="sd">    from the training data. Hooks `_on_start_training()` and `_on_end_training()`</span>
</span><span id="__span-0-602"><span class="sd">    are called at the beginning and end of the training context.</span>
</span><span id="__span-0-603">
</span><span id="__span-0-604"><span class="sd">    Yields:</span>
</span><span id="__span-0-605"><span class="sd">        None</span>
</span><span id="__span-0-606">
</span><span id="__span-0-607"><span class="sd">    Examples:</span>
</span><span id="__span-0-608"><span class="sd">        &gt;&gt;&gt; indexer = TokenSequenceIndexer()</span>
</span><span id="__span-0-609"><span class="sd">        &gt;&gt;&gt; with indexer.train():</span>
</span><span id="__span-0-610"><span class="sd">        ...     # Build vocabulary from training data</span>
</span><span id="__span-0-611"><span class="sd">        ...     tokens1 = indexer.instance([&quot;hello&quot;, &quot;world&quot;])</span>
</span><span id="__span-0-612"><span class="sd">        ...     tokens2 = indexer.instance([&quot;hello&quot;, &quot;there&quot;])</span>
</span><span id="__span-0-613"><span class="sd">        &gt;&gt;&gt; # Vocabulary is now frozen, use for inference</span>
</span><span id="__span-0-614"><span class="sd">        &gt;&gt;&gt; test_tokens = indexer.instance([&quot;hello&quot;, &quot;unknown&quot;])</span>
</span><span id="__span-0-615">
</span><span id="__span-0-616"><span class="sd">    Note:</span>
</span><span id="__span-0-617"><span class="sd">        Training mode is reentrant but nested calls won&#39;t trigger hooks again.</span>
</span><span id="__span-0-618">
</span><span id="__span-0-619"><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-620">    <span class="n">original</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_training</span>
</span><span id="__span-0-621">    <span class="bp">self</span><span class="o">.</span><span class="n">_training</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="__span-0-622">    <span class="k">try</span><span class="p">:</span>
</span><span id="__span-0-623">        <span class="k">if</span> <span class="ow">not</span> <span class="n">original</span><span class="p">:</span>
</span><span id="__span-0-624">            <span class="bp">self</span><span class="o">.</span><span class="n">_on_start_training</span><span class="p">()</span>
</span><span id="__span-0-625">        <span class="k">yield</span>
</span><span id="__span-0-626">        <span class="k">if</span> <span class="ow">not</span> <span class="n">original</span><span class="p">:</span>
</span><span id="__span-0-627">            <span class="bp">self</span><span class="o">.</span><span class="n">_on_end_training</span><span class="p">()</span>
</span><span id="__span-0-628">    <span class="k">finally</span><span class="p">:</span>
</span><span id="__span-0-629">        <span class="bp">self</span><span class="o">.</span><span class="n">_training</span> <span class="o">=</span> <span class="n">original</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.transforms.basic.TensorTransform.save" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">save</span>


<a href="#formed.integrations.ml.transforms.basic.TensorTransform.save" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">save</span><span class="p">(</span><span class="n">directory</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Save the transform to a directory using cloudpickle.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>directory</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Directory path to save the transform.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="str">str</span> | <span title="os.PathLike">PathLike</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Note</summary>
  <p>The transform is saved as 'transform.pkl' in the specified directory.
cloudpickle is used to handle complex objects like lambdas and closures.</p>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/transforms/base.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-631"><span class="k">def</span><span class="w"> </span><span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">directory</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">PathLike</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-632"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Save the transform to a directory using cloudpickle.</span>
</span><span id="__span-0-633">
</span><span id="__span-0-634"><span class="sd">    Args:</span>
</span><span id="__span-0-635"><span class="sd">        directory: Directory path to save the transform.</span>
</span><span id="__span-0-636">
</span><span id="__span-0-637"><span class="sd">    Note:</span>
</span><span id="__span-0-638"><span class="sd">        The transform is saved as &#39;transform.pkl&#39; in the specified directory.</span>
</span><span id="__span-0-639"><span class="sd">        cloudpickle is used to handle complex objects like lambdas and closures.</span>
</span><span id="__span-0-640">
</span><span id="__span-0-641"><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-642">    <span class="n">filepath</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">directory</span><span class="p">)</span> <span class="o">/</span> <span class="s2">&quot;transform.pkl&quot;</span>
</span><span id="__span-0-643">    <span class="k">with</span> <span class="n">filepath</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="__span-0-644">        <span class="n">cloudpickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.transforms.basic.TensorTransform.load" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">load</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#formed.integrations.ml.transforms.basic.TensorTransform.load" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">load</span><span class="p">(</span><span class="n">directory</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Load a transform from a directory.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>directory</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Directory path containing the saved transform.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="str">str</span> | <span title="os.PathLike">PathLike</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="typing.Self">Self</span></code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>The loaded transform instance.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RAISES</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
              <span class="doc-raises-annotation">
                  <code><span title="TypeError">TypeError</span></code>
              </span>
            </td>
            <td class="doc-raises-details">
              <div class="doc-md-description">
                <p>If the loaded object is not an instance of this class.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Note</summary>
  <p>Expects a 'transform.pkl' file in the specified directory.</p>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/transforms/base.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-646"><span class="nd">@classmethod</span>
</span><span id="__span-0-647"><span class="k">def</span><span class="w"> </span><span class="nf">load</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">directory</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">PathLike</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
</span><span id="__span-0-648"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Load a transform from a directory.</span>
</span><span id="__span-0-649">
</span><span id="__span-0-650"><span class="sd">    Args:</span>
</span><span id="__span-0-651"><span class="sd">        directory: Directory path containing the saved transform.</span>
</span><span id="__span-0-652">
</span><span id="__span-0-653"><span class="sd">    Returns:</span>
</span><span id="__span-0-654"><span class="sd">        The loaded transform instance.</span>
</span><span id="__span-0-655">
</span><span id="__span-0-656"><span class="sd">    Raises:</span>
</span><span id="__span-0-657"><span class="sd">        TypeError: If the loaded object is not an instance of this class.</span>
</span><span id="__span-0-658">
</span><span id="__span-0-659"><span class="sd">    Note:</span>
</span><span id="__span-0-660"><span class="sd">        Expects a &#39;transform.pkl&#39; file in the specified directory.</span>
</span><span id="__span-0-661">
</span><span id="__span-0-662"><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-663">    <span class="n">filepath</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">directory</span><span class="p">)</span> <span class="o">/</span> <span class="s2">&quot;transform.pkl&quot;</span>
</span><span id="__span-0-664">    <span class="k">with</span> <span class="n">filepath</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="__span-0-665">        <span class="n">obj</span> <span class="o">=</span> <span class="n">cloudpickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</span><span id="__span-0-666">    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="bp">cls</span><span class="p">):</span>
</span><span id="__span-0-667">        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Loaded object is not an instance of </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-0-668">    <span class="k">return</span> <span class="n">obj</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="formed.integrations.ml.transforms.basic.VariableTensorTransform" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">VariableTensorTransform</span>


<a href="#formed.integrations.ml.transforms.basic.VariableTensorTransform" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="typing.Generic">Generic</span>[<span title="formed.integrations.ml.transforms.basic._S">_S</span>]</code>, <code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;BaseTransform&lt;/span&gt; (&lt;code&gt;formed.integrations.ml.transforms.base.BaseTransform&lt;/code&gt;)" href="#formed.integrations.ml.transforms.base.BaseTransform">BaseTransform</a>[<span title="formed.integrations.ml.transforms.basic._S">_S</span>, <span title="numpy.ndarray">ndarray</span>, <span title="numpy.ndarray">ndarray</span>, <span title="formed.integrations.ml.types.VariableTensorBatch">VariableTensorBatch</span>[<span title="numpy.ndarray">ndarray</span>]]</code></p>



        <p>Transform variable-size numpy arrays into padded batched tensors.</p>
<p>VariableTensorTransform preserves numpy arrays during instance transformation
and pads them to the maximum shape in the batch during batching. It returns
a TensorBatch containing the padded tensor and a mask indicating valid data.</p>


<table>
      <thead>
        <tr>
          <th>
            <span class="doc-section-title">
              CLASS TYPE PARAMETER
            </span>
          </th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>_S</code>
            </td>
            <td class="doc-type_param-details">
              <div class="doc-md-description">
                <p>Source data type before accessor</p>
              </div>
              <p>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span id="__span-0-1"><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
</span><span id="__span-0-2"><span class="gp">&gt;&gt;&gt; </span><span class="n">transform</span> <span class="o">=</span> <span class="n">VariableTensorTransform</span><span class="p">(</span><span class="n">accessor</span><span class="o">=</span><span class="s2">&quot;sequences&quot;</span><span class="p">)</span>
</span><span id="__span-0-3"><span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">transform</span><span class="p">({</span><span class="s2">&quot;sequences&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])})</span>
</span><span id="__span-0-4"><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>  <span class="c1"># np.array([1, 2, 3])</span>
</span><span id="__span-0-5"><span class="gp">&gt;&gt;&gt;</span>
</span><span id="__span-0-6"><span class="gp">&gt;&gt;&gt; </span><span class="n">batch</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">batch</span><span class="p">([</span>
</span><span id="__span-0-7"><span class="gp">... </span>    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]),</span>
</span><span id="__span-0-8"><span class="gp">... </span>    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]),</span>
</span><span id="__span-0-9"><span class="gp">... </span>    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">]),</span>
</span><span id="__span-0-10"><span class="gp">... </span><span class="p">])</span>
</span><span id="__span-0-11"><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">batch</span><span class="o">.</span><span class="n">tensor</span><span class="p">)</span>
</span><span id="__span-0-12"><span class="gp">&gt;&gt;&gt; </span><span class="c1"># np.array([</span>
</span><span id="__span-0-13"><span class="gp">&gt;&gt;&gt; </span><span class="c1">#   [1, 2, 3, 0],</span>
</span><span id="__span-0-14"><span class="gp">&gt;&gt;&gt; </span><span class="c1">#   [4, 5, 0, 0],</span>
</span><span id="__span-0-15"><span class="gp">&gt;&gt;&gt; </span><span class="c1">#   [6, 7, 8, 9]</span>
</span><span id="__span-0-16"><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ])</span>
</span><span id="__span-0-17"><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">batch</span><span class="o">.</span><span class="n">mask</span><span class="p">)</span>
</span><span id="__span-0-18"><span class="gp">&gt;&gt;&gt; </span><span class="c1"># np.array([</span>
</span><span id="__span-0-19"><span class="gp">&gt;&gt;&gt; </span><span class="c1">#   [True, True, True, False],</span>
</span><span id="__span-0-20"><span class="gp">&gt;&gt;&gt; </span><span class="c1">#   [True, True, False, False],</span>
</span><span id="__span-0-21"><span class="gp">&gt;&gt;&gt; </span><span class="c1">#   [True, True, True, True]</span>
</span><span id="__span-0-22"><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ])</span>
</span></code></pre></div>


<details class="note" open>
  <summary>Note</summary>
  <ul>
<li>Pads arrays with zeros to match the maximum shape in the batch</li>
<li>Mask indicates which elements are valid (True) vs. padded (False)</li>
<li>Stateless transform, no training required</li>
</ul>
</details>










<div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="formed.integrations.ml.transforms.basic.VariableTensorTransform.accessor" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">accessor</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#formed.integrations.ml.transforms.basic.VariableTensorTransform.accessor" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="n">accessor</span> <span class="o">=</span> <span class="kc">None</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>




<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.transforms.basic.VariableTensorTransform.instance" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">instance</span>


<a href="#formed.integrations.ml.transforms.basic.VariableTensorTransform.instance" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">instance</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/transforms/basic.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">388</span>
<span class="normal">389</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-388"><span class="k">def</span><span class="w"> </span><span class="nf">instance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
</span><span id="__span-0-389">    <span class="k">return</span> <span class="n">value</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.transforms.basic.VariableTensorTransform.batch" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">batch</span>


<a href="#formed.integrations.ml.transforms.basic.VariableTensorTransform.batch" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">batch</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/transforms/basic.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-391"><span class="k">def</span><span class="w"> </span><span class="nf">batch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">VariableTensorBatch</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
</span><span id="__span-0-392">    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="__span-0-393">        <span class="k">return</span> <span class="n">VariableTensorBatch</span><span class="p">(</span>
</span><span id="__span-0-394">            <span class="n">tensor</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">float32</span><span class="p">),</span>
</span><span id="__span-0-395">            <span class="n">mask</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">bool_</span><span class="p">),</span>
</span><span id="__span-0-396">        <span class="p">)</span>
</span><span id="__span-0-397">    <span class="n">max_ndim</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">arr</span><span class="o">.</span><span class="n">ndim</span> <span class="k">for</span> <span class="n">arr</span> <span class="ow">in</span> <span class="n">batch</span><span class="p">)</span>
</span><span id="__span-0-398">    <span class="n">max_shape</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-0-399">    <span class="k">for</span> <span class="n">dim</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">max_ndim</span><span class="p">):</span>
</span><span id="__span-0-400">        <span class="n">dim_sizes</span> <span class="o">=</span> <span class="p">[</span><span class="n">arr</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="n">dim</span><span class="p">]</span> <span class="k">if</span> <span class="n">dim</span> <span class="o">&lt;</span> <span class="n">arr</span><span class="o">.</span><span class="n">ndim</span> <span class="k">else</span> <span class="mi">1</span> <span class="k">for</span> <span class="n">arr</span> <span class="ow">in</span> <span class="n">batch</span><span class="p">]</span>
</span><span id="__span-0-401">        <span class="n">max_shape</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">dim_sizes</span><span class="p">))</span>
</span><span id="__span-0-402">
</span><span id="__span-0-403">    <span class="n">tensor</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">batch</span><span class="p">),</span> <span class="o">*</span><span class="n">max_shape</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">batch</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
</span><span id="__span-0-404">    <span class="n">mask</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">batch</span><span class="p">),</span> <span class="o">*</span><span class="n">max_shape</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">bool_</span><span class="p">)</span>
</span><span id="__span-0-405">
</span><span id="__span-0-406">    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">arr</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">batch</span><span class="p">):</span>
</span><span id="__span-0-407">        <span class="n">slices</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">dim_size</span><span class="p">)</span> <span class="k">for</span> <span class="n">dim_size</span> <span class="ow">in</span> <span class="n">arr</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</span><span id="__span-0-408">        <span class="n">tensor</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">slices</span><span class="p">]</span> <span class="o">=</span> <span class="n">arr</span>
</span><span id="__span-0-409">        <span class="n">mask</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">slices</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="__span-0-410">
</span><span id="__span-0-411">    <span class="k">return</span> <span class="n">VariableTensorBatch</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">](</span><span class="n">tensor</span><span class="o">=</span><span class="n">tensor</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="n">mask</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.transforms.basic.VariableTensorTransform.train" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">train</span>


<a href="#formed.integrations.ml.transforms.basic.VariableTensorTransform.train" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">train</span><span class="p">()</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Context manager to enable training mode for stateful transformations.</p>
<p>In training mode, transforms can build state (e.g., vocabularies, statistics)
from the training data. Hooks <code>_on_start_training()</code> and <code>_on_end_training()</code>
are called at the beginning and end of the training context.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">YIELDS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-yields-annotation">
                    <code>None</code>
                </span>
            </td>
            <td class="doc-yields-details">
              <div class="doc-md-description">
                <p>None</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span id="__span-0-1"><span class="gp">&gt;&gt;&gt; </span><span class="n">indexer</span> <span class="o">=</span> <span class="n">TokenSequenceIndexer</span><span class="p">()</span>
</span><span id="__span-0-2"><span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">indexer</span><span class="o">.</span><span class="n">train</span><span class="p">():</span>
</span><span id="__span-0-3"><span class="gp">... </span>    <span class="c1"># Build vocabulary from training data</span>
</span><span id="__span-0-4"><span class="gp">... </span>    <span class="n">tokens1</span> <span class="o">=</span> <span class="n">indexer</span><span class="o">.</span><span class="n">instance</span><span class="p">([</span><span class="s2">&quot;hello&quot;</span><span class="p">,</span> <span class="s2">&quot;world&quot;</span><span class="p">])</span>
</span><span id="__span-0-5"><span class="gp">... </span>    <span class="n">tokens2</span> <span class="o">=</span> <span class="n">indexer</span><span class="o">.</span><span class="n">instance</span><span class="p">([</span><span class="s2">&quot;hello&quot;</span><span class="p">,</span> <span class="s2">&quot;there&quot;</span><span class="p">])</span>
</span><span id="__span-0-6"><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Vocabulary is now frozen, use for inference</span>
</span><span id="__span-0-7"><span class="gp">&gt;&gt;&gt; </span><span class="n">test_tokens</span> <span class="o">=</span> <span class="n">indexer</span><span class="o">.</span><span class="n">instance</span><span class="p">([</span><span class="s2">&quot;hello&quot;</span><span class="p">,</span> <span class="s2">&quot;unknown&quot;</span><span class="p">])</span>
</span></code></pre></div>


<details class="note" open>
  <summary>Note</summary>
  <p>Training mode is reentrant but nested calls won't trigger hooks again.</p>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/transforms/base.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-596"><span class="nd">@contextmanager</span>
</span><span id="__span-0-597"><span class="k">def</span><span class="w"> </span><span class="nf">train</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="kc">None</span><span class="p">]:</span>
</span><span id="__span-0-598"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Context manager to enable training mode for stateful transformations.</span>
</span><span id="__span-0-599">
</span><span id="__span-0-600"><span class="sd">    In training mode, transforms can build state (e.g., vocabularies, statistics)</span>
</span><span id="__span-0-601"><span class="sd">    from the training data. Hooks `_on_start_training()` and `_on_end_training()`</span>
</span><span id="__span-0-602"><span class="sd">    are called at the beginning and end of the training context.</span>
</span><span id="__span-0-603">
</span><span id="__span-0-604"><span class="sd">    Yields:</span>
</span><span id="__span-0-605"><span class="sd">        None</span>
</span><span id="__span-0-606">
</span><span id="__span-0-607"><span class="sd">    Examples:</span>
</span><span id="__span-0-608"><span class="sd">        &gt;&gt;&gt; indexer = TokenSequenceIndexer()</span>
</span><span id="__span-0-609"><span class="sd">        &gt;&gt;&gt; with indexer.train():</span>
</span><span id="__span-0-610"><span class="sd">        ...     # Build vocabulary from training data</span>
</span><span id="__span-0-611"><span class="sd">        ...     tokens1 = indexer.instance([&quot;hello&quot;, &quot;world&quot;])</span>
</span><span id="__span-0-612"><span class="sd">        ...     tokens2 = indexer.instance([&quot;hello&quot;, &quot;there&quot;])</span>
</span><span id="__span-0-613"><span class="sd">        &gt;&gt;&gt; # Vocabulary is now frozen, use for inference</span>
</span><span id="__span-0-614"><span class="sd">        &gt;&gt;&gt; test_tokens = indexer.instance([&quot;hello&quot;, &quot;unknown&quot;])</span>
</span><span id="__span-0-615">
</span><span id="__span-0-616"><span class="sd">    Note:</span>
</span><span id="__span-0-617"><span class="sd">        Training mode is reentrant but nested calls won&#39;t trigger hooks again.</span>
</span><span id="__span-0-618">
</span><span id="__span-0-619"><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-620">    <span class="n">original</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_training</span>
</span><span id="__span-0-621">    <span class="bp">self</span><span class="o">.</span><span class="n">_training</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="__span-0-622">    <span class="k">try</span><span class="p">:</span>
</span><span id="__span-0-623">        <span class="k">if</span> <span class="ow">not</span> <span class="n">original</span><span class="p">:</span>
</span><span id="__span-0-624">            <span class="bp">self</span><span class="o">.</span><span class="n">_on_start_training</span><span class="p">()</span>
</span><span id="__span-0-625">        <span class="k">yield</span>
</span><span id="__span-0-626">        <span class="k">if</span> <span class="ow">not</span> <span class="n">original</span><span class="p">:</span>
</span><span id="__span-0-627">            <span class="bp">self</span><span class="o">.</span><span class="n">_on_end_training</span><span class="p">()</span>
</span><span id="__span-0-628">    <span class="k">finally</span><span class="p">:</span>
</span><span id="__span-0-629">        <span class="bp">self</span><span class="o">.</span><span class="n">_training</span> <span class="o">=</span> <span class="n">original</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.transforms.basic.VariableTensorTransform.save" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">save</span>


<a href="#formed.integrations.ml.transforms.basic.VariableTensorTransform.save" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">save</span><span class="p">(</span><span class="n">directory</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Save the transform to a directory using cloudpickle.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>directory</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Directory path to save the transform.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="str">str</span> | <span title="os.PathLike">PathLike</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Note</summary>
  <p>The transform is saved as 'transform.pkl' in the specified directory.
cloudpickle is used to handle complex objects like lambdas and closures.</p>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/transforms/base.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-631"><span class="k">def</span><span class="w"> </span><span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">directory</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">PathLike</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-632"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Save the transform to a directory using cloudpickle.</span>
</span><span id="__span-0-633">
</span><span id="__span-0-634"><span class="sd">    Args:</span>
</span><span id="__span-0-635"><span class="sd">        directory: Directory path to save the transform.</span>
</span><span id="__span-0-636">
</span><span id="__span-0-637"><span class="sd">    Note:</span>
</span><span id="__span-0-638"><span class="sd">        The transform is saved as &#39;transform.pkl&#39; in the specified directory.</span>
</span><span id="__span-0-639"><span class="sd">        cloudpickle is used to handle complex objects like lambdas and closures.</span>
</span><span id="__span-0-640">
</span><span id="__span-0-641"><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-642">    <span class="n">filepath</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">directory</span><span class="p">)</span> <span class="o">/</span> <span class="s2">&quot;transform.pkl&quot;</span>
</span><span id="__span-0-643">    <span class="k">with</span> <span class="n">filepath</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="__span-0-644">        <span class="n">cloudpickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.transforms.basic.VariableTensorTransform.load" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">load</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#formed.integrations.ml.transforms.basic.VariableTensorTransform.load" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">load</span><span class="p">(</span><span class="n">directory</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Load a transform from a directory.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>directory</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Directory path containing the saved transform.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="str">str</span> | <span title="os.PathLike">PathLike</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="typing.Self">Self</span></code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>The loaded transform instance.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RAISES</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
              <span class="doc-raises-annotation">
                  <code><span title="TypeError">TypeError</span></code>
              </span>
            </td>
            <td class="doc-raises-details">
              <div class="doc-md-description">
                <p>If the loaded object is not an instance of this class.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Note</summary>
  <p>Expects a 'transform.pkl' file in the specified directory.</p>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/transforms/base.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-646"><span class="nd">@classmethod</span>
</span><span id="__span-0-647"><span class="k">def</span><span class="w"> </span><span class="nf">load</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">directory</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">PathLike</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
</span><span id="__span-0-648"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Load a transform from a directory.</span>
</span><span id="__span-0-649">
</span><span id="__span-0-650"><span class="sd">    Args:</span>
</span><span id="__span-0-651"><span class="sd">        directory: Directory path containing the saved transform.</span>
</span><span id="__span-0-652">
</span><span id="__span-0-653"><span class="sd">    Returns:</span>
</span><span id="__span-0-654"><span class="sd">        The loaded transform instance.</span>
</span><span id="__span-0-655">
</span><span id="__span-0-656"><span class="sd">    Raises:</span>
</span><span id="__span-0-657"><span class="sd">        TypeError: If the loaded object is not an instance of this class.</span>
</span><span id="__span-0-658">
</span><span id="__span-0-659"><span class="sd">    Note:</span>
</span><span id="__span-0-660"><span class="sd">        Expects a &#39;transform.pkl&#39; file in the specified directory.</span>
</span><span id="__span-0-661">
</span><span id="__span-0-662"><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-663">    <span class="n">filepath</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">directory</span><span class="p">)</span> <span class="o">/</span> <span class="s2">&quot;transform.pkl&quot;</span>
</span><span id="__span-0-664">    <span class="k">with</span> <span class="n">filepath</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="__span-0-665">        <span class="n">obj</span> <span class="o">=</span> <span class="n">cloudpickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</span><span id="__span-0-666">    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="bp">cls</span><span class="p">):</span>
</span><span id="__span-0-667">        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Loaded object is not an instance of </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-0-668">    <span class="k">return</span> <span class="n">obj</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="formed.integrations.ml.transforms.basic.TensorSequenceTransform" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">TensorSequenceTransform</span>


<a href="#formed.integrations.ml.transforms.basic.TensorSequenceTransform" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="typing.Generic">Generic</span>[<span title="formed.integrations.ml.transforms.basic._S">_S</span>]</code>, <code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;BaseTransform&lt;/span&gt; (&lt;code&gt;formed.integrations.ml.transforms.base.BaseTransform&lt;/code&gt;)" href="#formed.integrations.ml.transforms.base.BaseTransform">BaseTransform</a>[<span title="formed.integrations.ml.transforms.basic._S">_S</span>, <span title="collections.abc.Sequence">Sequence</span>[<span title="numpy.ndarray">ndarray</span>], <span title="numpy.ndarray">ndarray</span>, <span title="formed.integrations.ml.types.VariableTensorBatch">VariableTensorBatch</span>[<span title="numpy.ndarray">ndarray</span>]]</code></p>



        <p>Transform sequences of numpy arrays into padded batched tensors.</p>
<p>TensorSequenceTransform handles sequences of arrays (e.g., token-level embeddings)
by stacking them into a 2D array during instance transformation, then padding
across the batch dimension during batching.</p>
<p>This is useful for token-level features where each token has its own vector,
and different instances may have different numbers of tokens.</p>


<table>
      <thead>
        <tr>
          <th>
            <span class="doc-section-title">
              CLASS TYPE PARAMETER
            </span>
          </th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>_S</code>
            </td>
            <td class="doc-type_param-details">
              <div class="doc-md-description">
                <p>Source data type before accessor</p>
              </div>
              <p>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span id="__span-0-1"><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
</span><span id="__span-0-2"><span class="gp">&gt;&gt;&gt; </span><span class="n">transform</span> <span class="o">=</span> <span class="n">TensorSequenceTransform</span><span class="p">(</span><span class="n">accessor</span><span class="o">=</span><span class="s2">&quot;token_vectors&quot;</span><span class="p">)</span>
</span><span id="__span-0-3"><span class="gp">&gt;&gt;&gt;</span>
</span><span id="__span-0-4"><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Each instance has a sequence of token vectors</span>
</span><span id="__span-0-5"><span class="gp">&gt;&gt;&gt; </span><span class="n">data1</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;token_vectors&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">3.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">])]}</span>
</span><span id="__span-0-6"><span class="gp">&gt;&gt;&gt; </span><span class="n">data2</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;token_vectors&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">5.0</span><span class="p">,</span> <span class="mf">6.0</span><span class="p">])]}</span>
</span><span id="__span-0-7"><span class="gp">&gt;&gt;&gt;</span>
</span><span id="__span-0-8"><span class="gp">&gt;&gt;&gt; </span><span class="n">instance1</span> <span class="o">=</span> <span class="n">transform</span><span class="p">(</span><span class="n">data1</span><span class="p">)</span>  <span class="c1"># Shape: (2, 2) - 2 tokens, 2 dims</span>
</span><span id="__span-0-9"><span class="gp">&gt;&gt;&gt; </span><span class="n">instance2</span> <span class="o">=</span> <span class="n">transform</span><span class="p">(</span><span class="n">data2</span><span class="p">)</span>  <span class="c1"># Shape: (1, 2) - 1 token, 2 dims</span>
</span><span id="__span-0-10"><span class="gp">&gt;&gt;&gt;</span>
</span><span id="__span-0-11"><span class="gp">&gt;&gt;&gt; </span><span class="n">batch</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">batch</span><span class="p">([</span><span class="n">instance1</span><span class="p">,</span> <span class="n">instance2</span><span class="p">])</span>
</span><span id="__span-0-12"><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">batch</span><span class="o">.</span><span class="n">tensor</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>  <span class="c1"># (2, 2, 2) - batch_size, max_tokens, dims</span>
</span><span id="__span-0-13"><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">batch</span><span class="o">.</span><span class="n">mask</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>    <span class="c1"># (2, 2, 2)</span>
</span><span id="__span-0-14"><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">batch</span><span class="o">.</span><span class="n">mask</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>  <span class="c1"># [[True, True], [True, True]]</span>
</span><span id="__span-0-15"><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">batch</span><span class="o">.</span><span class="n">mask</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>  <span class="c1"># [[True, True], [False, False]]</span>
</span></code></pre></div>


<details class="note" open>
  <summary>Note</summary>
  <ul>
<li>Converts sequence of arrays to 2D array during instance transformation</li>
<li>Pads to max token count during batching</li>
<li>Mask indicates valid tokens vs. padding</li>
<li>Empty sequences result in empty arrays</li>
</ul>
</details>










<div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="formed.integrations.ml.transforms.basic.TensorSequenceTransform.accessor" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">accessor</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#formed.integrations.ml.transforms.basic.TensorSequenceTransform.accessor" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="n">accessor</span> <span class="o">=</span> <span class="kc">None</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>




<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.transforms.basic.TensorSequenceTransform.instance" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">instance</span>


<a href="#formed.integrations.ml.transforms.basic.TensorSequenceTransform.instance" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">instance</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/transforms/basic.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-456"><span class="k">def</span><span class="w"> </span><span class="nf">instance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
</span><span id="__span-0-457">    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="__span-0-458">        <span class="k">return</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
</span><span id="__span-0-459">    <span class="c1"># Stack sequence of arrays into 2D array (num_tokens, embedding_dim)</span>
</span><span id="__span-0-460">    <span class="k">return</span> <span class="n">numpy</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">numpy</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span> <span class="k">for</span> <span class="n">arr</span> <span class="ow">in</span> <span class="n">value</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.transforms.basic.TensorSequenceTransform.batch" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">batch</span>


<a href="#formed.integrations.ml.transforms.basic.TensorSequenceTransform.batch" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">batch</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/transforms/basic.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-462"><span class="k">def</span><span class="w"> </span><span class="nf">batch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">VariableTensorBatch</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
</span><span id="__span-0-463">    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="__span-0-464">        <span class="k">return</span> <span class="n">VariableTensorBatch</span><span class="p">(</span>
</span><span id="__span-0-465">            <span class="n">tensor</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">float32</span><span class="p">),</span>
</span><span id="__span-0-466">            <span class="n">mask</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">bool_</span><span class="p">),</span>
</span><span id="__span-0-467">        <span class="p">)</span>
</span><span id="__span-0-468">    <span class="n">max_ndim</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">arr</span><span class="o">.</span><span class="n">ndim</span> <span class="k">for</span> <span class="n">arr</span> <span class="ow">in</span> <span class="n">batch</span><span class="p">)</span>
</span><span id="__span-0-469">    <span class="n">max_shape</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-0-470">    <span class="k">for</span> <span class="n">dim</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">max_ndim</span><span class="p">):</span>
</span><span id="__span-0-471">        <span class="n">dim_sizes</span> <span class="o">=</span> <span class="p">[</span><span class="n">arr</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="n">dim</span><span class="p">]</span> <span class="k">if</span> <span class="n">dim</span> <span class="o">&lt;</span> <span class="n">arr</span><span class="o">.</span><span class="n">ndim</span> <span class="k">else</span> <span class="mi">1</span> <span class="k">for</span> <span class="n">arr</span> <span class="ow">in</span> <span class="n">batch</span><span class="p">]</span>
</span><span id="__span-0-472">        <span class="n">max_shape</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">dim_sizes</span><span class="p">))</span>
</span><span id="__span-0-473">
</span><span id="__span-0-474">    <span class="n">tensor</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">batch</span><span class="p">),</span> <span class="o">*</span><span class="n">max_shape</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">batch</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
</span><span id="__span-0-475">    <span class="n">mask</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">batch</span><span class="p">),</span> <span class="o">*</span><span class="n">max_shape</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">bool_</span><span class="p">)</span>
</span><span id="__span-0-476">
</span><span id="__span-0-477">    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">arr</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">batch</span><span class="p">):</span>
</span><span id="__span-0-478">        <span class="n">slices</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">dim_size</span><span class="p">)</span> <span class="k">for</span> <span class="n">dim_size</span> <span class="ow">in</span> <span class="n">arr</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</span><span id="__span-0-479">        <span class="n">tensor</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">slices</span><span class="p">]</span> <span class="o">=</span> <span class="n">arr</span>
</span><span id="__span-0-480">        <span class="n">mask</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">slices</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="__span-0-481">
</span><span id="__span-0-482">    <span class="k">return</span> <span class="n">VariableTensorBatch</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">](</span><span class="n">tensor</span><span class="o">=</span><span class="n">tensor</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="n">mask</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.transforms.basic.TensorSequenceTransform.train" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">train</span>


<a href="#formed.integrations.ml.transforms.basic.TensorSequenceTransform.train" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">train</span><span class="p">()</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Context manager to enable training mode for stateful transformations.</p>
<p>In training mode, transforms can build state (e.g., vocabularies, statistics)
from the training data. Hooks <code>_on_start_training()</code> and <code>_on_end_training()</code>
are called at the beginning and end of the training context.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">YIELDS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-yields-annotation">
                    <code>None</code>
                </span>
            </td>
            <td class="doc-yields-details">
              <div class="doc-md-description">
                <p>None</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span id="__span-0-1"><span class="gp">&gt;&gt;&gt; </span><span class="n">indexer</span> <span class="o">=</span> <span class="n">TokenSequenceIndexer</span><span class="p">()</span>
</span><span id="__span-0-2"><span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">indexer</span><span class="o">.</span><span class="n">train</span><span class="p">():</span>
</span><span id="__span-0-3"><span class="gp">... </span>    <span class="c1"># Build vocabulary from training data</span>
</span><span id="__span-0-4"><span class="gp">... </span>    <span class="n">tokens1</span> <span class="o">=</span> <span class="n">indexer</span><span class="o">.</span><span class="n">instance</span><span class="p">([</span><span class="s2">&quot;hello&quot;</span><span class="p">,</span> <span class="s2">&quot;world&quot;</span><span class="p">])</span>
</span><span id="__span-0-5"><span class="gp">... </span>    <span class="n">tokens2</span> <span class="o">=</span> <span class="n">indexer</span><span class="o">.</span><span class="n">instance</span><span class="p">([</span><span class="s2">&quot;hello&quot;</span><span class="p">,</span> <span class="s2">&quot;there&quot;</span><span class="p">])</span>
</span><span id="__span-0-6"><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Vocabulary is now frozen, use for inference</span>
</span><span id="__span-0-7"><span class="gp">&gt;&gt;&gt; </span><span class="n">test_tokens</span> <span class="o">=</span> <span class="n">indexer</span><span class="o">.</span><span class="n">instance</span><span class="p">([</span><span class="s2">&quot;hello&quot;</span><span class="p">,</span> <span class="s2">&quot;unknown&quot;</span><span class="p">])</span>
</span></code></pre></div>


<details class="note" open>
  <summary>Note</summary>
  <p>Training mode is reentrant but nested calls won't trigger hooks again.</p>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/transforms/base.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-596"><span class="nd">@contextmanager</span>
</span><span id="__span-0-597"><span class="k">def</span><span class="w"> </span><span class="nf">train</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="kc">None</span><span class="p">]:</span>
</span><span id="__span-0-598"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Context manager to enable training mode for stateful transformations.</span>
</span><span id="__span-0-599">
</span><span id="__span-0-600"><span class="sd">    In training mode, transforms can build state (e.g., vocabularies, statistics)</span>
</span><span id="__span-0-601"><span class="sd">    from the training data. Hooks `_on_start_training()` and `_on_end_training()`</span>
</span><span id="__span-0-602"><span class="sd">    are called at the beginning and end of the training context.</span>
</span><span id="__span-0-603">
</span><span id="__span-0-604"><span class="sd">    Yields:</span>
</span><span id="__span-0-605"><span class="sd">        None</span>
</span><span id="__span-0-606">
</span><span id="__span-0-607"><span class="sd">    Examples:</span>
</span><span id="__span-0-608"><span class="sd">        &gt;&gt;&gt; indexer = TokenSequenceIndexer()</span>
</span><span id="__span-0-609"><span class="sd">        &gt;&gt;&gt; with indexer.train():</span>
</span><span id="__span-0-610"><span class="sd">        ...     # Build vocabulary from training data</span>
</span><span id="__span-0-611"><span class="sd">        ...     tokens1 = indexer.instance([&quot;hello&quot;, &quot;world&quot;])</span>
</span><span id="__span-0-612"><span class="sd">        ...     tokens2 = indexer.instance([&quot;hello&quot;, &quot;there&quot;])</span>
</span><span id="__span-0-613"><span class="sd">        &gt;&gt;&gt; # Vocabulary is now frozen, use for inference</span>
</span><span id="__span-0-614"><span class="sd">        &gt;&gt;&gt; test_tokens = indexer.instance([&quot;hello&quot;, &quot;unknown&quot;])</span>
</span><span id="__span-0-615">
</span><span id="__span-0-616"><span class="sd">    Note:</span>
</span><span id="__span-0-617"><span class="sd">        Training mode is reentrant but nested calls won&#39;t trigger hooks again.</span>
</span><span id="__span-0-618">
</span><span id="__span-0-619"><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-620">    <span class="n">original</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_training</span>
</span><span id="__span-0-621">    <span class="bp">self</span><span class="o">.</span><span class="n">_training</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="__span-0-622">    <span class="k">try</span><span class="p">:</span>
</span><span id="__span-0-623">        <span class="k">if</span> <span class="ow">not</span> <span class="n">original</span><span class="p">:</span>
</span><span id="__span-0-624">            <span class="bp">self</span><span class="o">.</span><span class="n">_on_start_training</span><span class="p">()</span>
</span><span id="__span-0-625">        <span class="k">yield</span>
</span><span id="__span-0-626">        <span class="k">if</span> <span class="ow">not</span> <span class="n">original</span><span class="p">:</span>
</span><span id="__span-0-627">            <span class="bp">self</span><span class="o">.</span><span class="n">_on_end_training</span><span class="p">()</span>
</span><span id="__span-0-628">    <span class="k">finally</span><span class="p">:</span>
</span><span id="__span-0-629">        <span class="bp">self</span><span class="o">.</span><span class="n">_training</span> <span class="o">=</span> <span class="n">original</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.transforms.basic.TensorSequenceTransform.save" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">save</span>


<a href="#formed.integrations.ml.transforms.basic.TensorSequenceTransform.save" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">save</span><span class="p">(</span><span class="n">directory</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Save the transform to a directory using cloudpickle.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>directory</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Directory path to save the transform.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="str">str</span> | <span title="os.PathLike">PathLike</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Note</summary>
  <p>The transform is saved as 'transform.pkl' in the specified directory.
cloudpickle is used to handle complex objects like lambdas and closures.</p>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/transforms/base.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-631"><span class="k">def</span><span class="w"> </span><span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">directory</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">PathLike</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-632"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Save the transform to a directory using cloudpickle.</span>
</span><span id="__span-0-633">
</span><span id="__span-0-634"><span class="sd">    Args:</span>
</span><span id="__span-0-635"><span class="sd">        directory: Directory path to save the transform.</span>
</span><span id="__span-0-636">
</span><span id="__span-0-637"><span class="sd">    Note:</span>
</span><span id="__span-0-638"><span class="sd">        The transform is saved as &#39;transform.pkl&#39; in the specified directory.</span>
</span><span id="__span-0-639"><span class="sd">        cloudpickle is used to handle complex objects like lambdas and closures.</span>
</span><span id="__span-0-640">
</span><span id="__span-0-641"><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-642">    <span class="n">filepath</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">directory</span><span class="p">)</span> <span class="o">/</span> <span class="s2">&quot;transform.pkl&quot;</span>
</span><span id="__span-0-643">    <span class="k">with</span> <span class="n">filepath</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="__span-0-644">        <span class="n">cloudpickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.transforms.basic.TensorSequenceTransform.load" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">load</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#formed.integrations.ml.transforms.basic.TensorSequenceTransform.load" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">load</span><span class="p">(</span><span class="n">directory</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Load a transform from a directory.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>directory</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Directory path containing the saved transform.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="str">str</span> | <span title="os.PathLike">PathLike</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="typing.Self">Self</span></code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>The loaded transform instance.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RAISES</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
              <span class="doc-raises-annotation">
                  <code><span title="TypeError">TypeError</span></code>
              </span>
            </td>
            <td class="doc-raises-details">
              <div class="doc-md-description">
                <p>If the loaded object is not an instance of this class.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Note</summary>
  <p>Expects a 'transform.pkl' file in the specified directory.</p>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/transforms/base.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-646"><span class="nd">@classmethod</span>
</span><span id="__span-0-647"><span class="k">def</span><span class="w"> </span><span class="nf">load</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">directory</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">PathLike</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
</span><span id="__span-0-648"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Load a transform from a directory.</span>
</span><span id="__span-0-649">
</span><span id="__span-0-650"><span class="sd">    Args:</span>
</span><span id="__span-0-651"><span class="sd">        directory: Directory path containing the saved transform.</span>
</span><span id="__span-0-652">
</span><span id="__span-0-653"><span class="sd">    Returns:</span>
</span><span id="__span-0-654"><span class="sd">        The loaded transform instance.</span>
</span><span id="__span-0-655">
</span><span id="__span-0-656"><span class="sd">    Raises:</span>
</span><span id="__span-0-657"><span class="sd">        TypeError: If the loaded object is not an instance of this class.</span>
</span><span id="__span-0-658">
</span><span id="__span-0-659"><span class="sd">    Note:</span>
</span><span id="__span-0-660"><span class="sd">        Expects a &#39;transform.pkl&#39; file in the specified directory.</span>
</span><span id="__span-0-661">
</span><span id="__span-0-662"><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-663">    <span class="n">filepath</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">directory</span><span class="p">)</span> <span class="o">/</span> <span class="s2">&quot;transform.pkl&quot;</span>
</span><span id="__span-0-664">    <span class="k">with</span> <span class="n">filepath</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="__span-0-665">        <span class="n">obj</span> <span class="o">=</span> <span class="n">cloudpickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</span><span id="__span-0-666">    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="bp">cls</span><span class="p">):</span>
</span><span id="__span-0-667">        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Loaded object is not an instance of </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-0-668">    <span class="k">return</span> <span class="n">obj</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="formed.integrations.ml.transforms.nlp" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">formed.integrations.ml.transforms.nlp</span>


<a href="#formed.integrations.ml.transforms.nlp" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents first">

        <p>NLP-specific data transformations for text processing.</p>
<p>This module provides transformations for natural language processing tasks,
including tokenization, vocabulary building, and sequence indexing with special
tokens (PAD, UNK, BOS, EOS).</p>


<details class="available-transforms" open>
  <summary>Available Transforms</summary>
  <ul>
<li><code>TokenSequenceIndexer</code>: Convert token sequences to integer indices with vocab building</li>
<li><code>TokenCharactersIndexer</code>: Character-level indexing for tokens</li>
<li><code>Tokenizer</code>: Complete tokenization pipeline with surfaces, postags, and characters</li>
</ul>
</details>

<details class="features" open>
  <summary>Features</summary>
  <ul>
<li>Dynamic vocabulary building with <code>min_df</code>/<code>max_df</code> filtering</li>
<li>Document frequency tracking</li>
<li>Special token handling (PAD, UNK, BOS, EOS)</li>
<li>Automatic padding and masking</li>
<li>Reconstruction support (indices -&gt; tokens)</li>
</ul>
</details>

<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span id="__span-0-1"><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">formed.integrations.ml</span><span class="w"> </span><span class="kn">import</span> <span class="n">Tokenizer</span><span class="p">,</span> <span class="n">TokenSequenceIndexer</span>
</span><span id="__span-0-2"><span class="gp">&gt;&gt;&gt;</span>
</span><span id="__span-0-3"><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Simple tokenization</span>
</span><span id="__span-0-4"><span class="gp">&gt;&gt;&gt; </span><span class="n">tokenizer</span> <span class="o">=</span> <span class="n">Tokenizer</span><span class="p">(</span><span class="n">surfaces</span><span class="o">=</span><span class="n">TokenSequenceIndexer</span><span class="p">(</span>
</span><span id="__span-0-5"><span class="gp">... </span>    <span class="n">unk_token</span><span class="o">=</span><span class="s2">&quot;&lt;UNK&gt;&quot;</span><span class="p">,</span> <span class="n">pad_token</span><span class="o">=</span><span class="s2">&quot;&lt;PAD&gt;&quot;</span>
</span><span id="__span-0-6"><span class="gp">... </span><span class="p">))</span>
</span><span id="__span-0-7"><span class="gp">&gt;&gt;&gt;</span>
</span><span id="__span-0-8"><span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">tokenizer</span><span class="o">.</span><span class="n">train</span><span class="p">():</span>
</span><span id="__span-0-9"><span class="gp">... </span>    <span class="n">instance</span> <span class="o">=</span> <span class="n">tokenizer</span><span class="o">.</span><span class="n">instance</span><span class="p">(</span><span class="s2">&quot;Hello world!&quot;</span><span class="p">)</span>
</span><span id="__span-0-10"><span class="gp">&gt;&gt;&gt; </span><span class="n">batch</span> <span class="o">=</span> <span class="n">tokenizer</span><span class="o">.</span><span class="n">batch</span><span class="p">([</span><span class="n">instance1</span><span class="p">,</span> <span class="n">instance2</span><span class="p">,</span> <span class="n">instance3</span><span class="p">])</span>
</span><span id="__span-0-11"><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">batch</span><span class="o">.</span><span class="n">surfaces</span><span class="o">.</span><span class="n">ids</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>  <span class="c1"># (3, max_length)</span>
</span><span id="__span-0-12"><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">batch</span><span class="o">.</span><span class="n">surfaces</span><span class="o">.</span><span class="n">mask</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>  <span class="c1"># (3, max_length)</span>
</span><span id="__span-0-13"><span class="gp">&gt;&gt;&gt;</span>
</span><span id="__span-0-14"><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Reconstruct tokens from indices</span>
</span><span id="__span-0-15"><span class="gp">&gt;&gt;&gt; </span><span class="n">tokens</span> <span class="o">=</span> <span class="n">tokenizer</span><span class="o">.</span><span class="n">surfaces</span><span class="o">.</span><span class="n">reconstruct</span><span class="p">(</span><span class="n">batch</span><span class="o">.</span><span class="n">surfaces</span><span class="p">)</span>
</span></code></pre></div>










<div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="formed.integrations.ml.transforms.nlp.logger" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">logger</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

<a href="#formed.integrations.ml.transforms.nlp.logger" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="n">logger</span> <span class="o">=</span> <span class="n"><span title="logging.getLogger">getLogger</span></span><span class="p">(</span><span class="n"><span title="__name__">__name__</span></span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>



<div class="doc doc-object doc-class">



<h3 id="formed.integrations.ml.transforms.nlp.TokenSequenceIndexer" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">TokenSequenceIndexer</span>


<a href="#formed.integrations.ml.transforms.nlp.TokenSequenceIndexer" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;BaseTransform&lt;/span&gt; (&lt;code&gt;formed.integrations.ml.transforms.base.BaseTransform&lt;/code&gt;)" href="#formed.integrations.ml.transforms.base.BaseTransform">BaseTransform</a>[<span title="formed.integrations.ml.transforms.nlp._S">_S</span>, <span title="collections.abc.Sequence">Sequence</span>[<span title="str">str</span>], <span title="collections.abc.Sequence">Sequence</span>[<span title="str">str</span>], <span title="formed.integrations.ml.types.IDSequenceBatch">IDSequenceBatch</span>]</code>, <code><span title="typing.Generic">Generic</span>[<span title="formed.integrations.ml.transforms.nlp._S">_S</span>]</code></p>



        <p>Convert token sequences to integer indices with vocabulary building and filtering.</p>
<p>TokenSequenceIndexer builds and maintains a vocabulary, converting tokens to indices.
It supports vocabulary filtering by document frequency (<code>min_df</code>/<code>max_df</code>), vocabulary
size limits, and special tokens (PAD, UNK, BOS, EOS). During batching, sequences
are padded to the same length and a mask is generated.</p>


<table>
      <thead>
        <tr>
          <th>
            <span class="doc-section-title">
              CLASS TYPE PARAMETER
            </span>
          </th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>_S</code>
            </td>
            <td class="doc-type_param-details">
              <div class="doc-md-description">
                <p>Source data type before accessor</p>
              </div>
              <p>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">ATTRIBUTE</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-attribute&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-attribute-name&quot;&gt;vocab&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-class-attribute&quot;&gt;&lt;code&gt;class-attribute&lt;/code&gt;&lt;/small&gt;
      &lt;small class=&quot;doc doc-label doc-label-instance-attribute&quot;&gt;&lt;code&gt;instance-attribute&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;formed.integrations.ml.transforms.nlp.TokenSequenceIndexer.vocab&lt;/code&gt;)" href="#formed.integrations.ml.transforms.nlp.TokenSequenceIndexer.vocab">vocab</a></code></td>
            <td class="doc-attribute-details">
              <div class="doc-md-description">
                <p>Pre-defined or built vocabulary mapping tokens to indices.</p>
              </div>
              <p>
                  <span class="doc-attribute-annotation">
                    <b>TYPE:</b>
                      <code><span title="collections.abc.Mapping">Mapping</span>[<span title="str">str</span>, <span title="int">int</span>]</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-attribute&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-attribute-name&quot;&gt;pad_token&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-class-attribute&quot;&gt;&lt;code&gt;class-attribute&lt;/code&gt;&lt;/small&gt;
      &lt;small class=&quot;doc doc-label doc-label-instance-attribute&quot;&gt;&lt;code&gt;instance-attribute&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;formed.integrations.ml.transforms.nlp.TokenSequenceIndexer.pad_token&lt;/code&gt;)" href="#formed.integrations.ml.transforms.nlp.TokenSequenceIndexer.pad_token">pad_token</a></code></td>
            <td class="doc-attribute-details">
              <div class="doc-md-description">
                <p>Padding token (required).</p>
              </div>
              <p>
                  <span class="doc-attribute-annotation">
                    <b>TYPE:</b>
                      <code><span title="str">str</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-attribute&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-attribute-name&quot;&gt;unk_token&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-class-attribute&quot;&gt;&lt;code&gt;class-attribute&lt;/code&gt;&lt;/small&gt;
      &lt;small class=&quot;doc doc-label doc-label-instance-attribute&quot;&gt;&lt;code&gt;instance-attribute&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;formed.integrations.ml.transforms.nlp.TokenSequenceIndexer.unk_token&lt;/code&gt;)" href="#formed.integrations.ml.transforms.nlp.TokenSequenceIndexer.unk_token">unk_token</a></code></td>
            <td class="doc-attribute-details">
              <div class="doc-md-description">
                <p>Unknown token for out-of-vocabulary tokens (optional).</p>
              </div>
              <p>
                  <span class="doc-attribute-annotation">
                    <b>TYPE:</b>
                      <code><span title="str">str</span> | None</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-attribute&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-attribute-name&quot;&gt;bos_token&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-class-attribute&quot;&gt;&lt;code&gt;class-attribute&lt;/code&gt;&lt;/small&gt;
      &lt;small class=&quot;doc doc-label doc-label-instance-attribute&quot;&gt;&lt;code&gt;instance-attribute&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;formed.integrations.ml.transforms.nlp.TokenSequenceIndexer.bos_token&lt;/code&gt;)" href="#formed.integrations.ml.transforms.nlp.TokenSequenceIndexer.bos_token">bos_token</a></code></td>
            <td class="doc-attribute-details">
              <div class="doc-md-description">
                <p>Beginning-of-sequence token (optional).</p>
              </div>
              <p>
                  <span class="doc-attribute-annotation">
                    <b>TYPE:</b>
                      <code><span title="str">str</span> | None</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-attribute&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-attribute-name&quot;&gt;eos_token&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-class-attribute&quot;&gt;&lt;code&gt;class-attribute&lt;/code&gt;&lt;/small&gt;
      &lt;small class=&quot;doc doc-label doc-label-instance-attribute&quot;&gt;&lt;code&gt;instance-attribute&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;formed.integrations.ml.transforms.nlp.TokenSequenceIndexer.eos_token&lt;/code&gt;)" href="#formed.integrations.ml.transforms.nlp.TokenSequenceIndexer.eos_token">eos_token</a></code></td>
            <td class="doc-attribute-details">
              <div class="doc-md-description">
                <p>End-of-sequence token (optional).</p>
              </div>
              <p>
                  <span class="doc-attribute-annotation">
                    <b>TYPE:</b>
                      <code><span title="str">str</span> | None</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-attribute&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-attribute-name&quot;&gt;min_df&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-class-attribute&quot;&gt;&lt;code&gt;class-attribute&lt;/code&gt;&lt;/small&gt;
      &lt;small class=&quot;doc doc-label doc-label-instance-attribute&quot;&gt;&lt;code&gt;instance-attribute&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;formed.integrations.ml.transforms.nlp.TokenSequenceIndexer.min_df&lt;/code&gt;)" href="#formed.integrations.ml.transforms.nlp.TokenSequenceIndexer.min_df">min_df</a></code></td>
            <td class="doc-attribute-details">
              <div class="doc-md-description">
                <p>Minimum document frequency (int or fraction) to include token.</p>
              </div>
              <p>
                  <span class="doc-attribute-annotation">
                    <b>TYPE:</b>
                      <code><span title="int">int</span> | <span title="float">float</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-attribute&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-attribute-name&quot;&gt;max_df&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-class-attribute&quot;&gt;&lt;code&gt;class-attribute&lt;/code&gt;&lt;/small&gt;
      &lt;small class=&quot;doc doc-label doc-label-instance-attribute&quot;&gt;&lt;code&gt;instance-attribute&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;formed.integrations.ml.transforms.nlp.TokenSequenceIndexer.max_df&lt;/code&gt;)" href="#formed.integrations.ml.transforms.nlp.TokenSequenceIndexer.max_df">max_df</a></code></td>
            <td class="doc-attribute-details">
              <div class="doc-md-description">
                <p>Maximum document frequency (int or fraction) to include token.</p>
              </div>
              <p>
                  <span class="doc-attribute-annotation">
                    <b>TYPE:</b>
                      <code><span title="int">int</span> | <span title="float">float</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-attribute&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-attribute-name&quot;&gt;max_vocab_size&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-class-attribute&quot;&gt;&lt;code&gt;class-attribute&lt;/code&gt;&lt;/small&gt;
      &lt;small class=&quot;doc doc-label doc-label-instance-attribute&quot;&gt;&lt;code&gt;instance-attribute&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;formed.integrations.ml.transforms.nlp.TokenSequenceIndexer.max_vocab_size&lt;/code&gt;)" href="#formed.integrations.ml.transforms.nlp.TokenSequenceIndexer.max_vocab_size">max_vocab_size</a></code></td>
            <td class="doc-attribute-details">
              <div class="doc-md-description">
                <p>Maximum vocabulary size (excluding special tokens).</p>
              </div>
              <p>
                  <span class="doc-attribute-annotation">
                    <b>TYPE:</b>
                      <code><span title="int">int</span> | None</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-attribute&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-attribute-name&quot;&gt;freeze&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-class-attribute&quot;&gt;&lt;code&gt;class-attribute&lt;/code&gt;&lt;/small&gt;
      &lt;small class=&quot;doc doc-label doc-label-instance-attribute&quot;&gt;&lt;code&gt;instance-attribute&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;formed.integrations.ml.transforms.nlp.TokenSequenceIndexer.freeze&lt;/code&gt;)" href="#formed.integrations.ml.transforms.nlp.TokenSequenceIndexer.freeze">freeze</a></code></td>
            <td class="doc-attribute-details">
              <div class="doc-md-description">
                <p>If True, prevent vocabulary updates.</p>
              </div>
              <p>
                  <span class="doc-attribute-annotation">
                    <b>TYPE:</b>
                      <code><span title="bool">bool</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span id="__span-0-1"><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Build vocabulary with filtering</span>
</span><span id="__span-0-2"><span class="gp">&gt;&gt;&gt; </span><span class="n">indexer</span> <span class="o">=</span> <span class="n">TokenSequenceIndexer</span><span class="p">(</span>
</span><span id="__span-0-3"><span class="gp">... </span>    <span class="n">unk_token</span><span class="o">=</span><span class="s2">&quot;&lt;UNK&gt;&quot;</span><span class="p">,</span>
</span><span id="__span-0-4"><span class="gp">... </span>    <span class="n">min_df</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>  <span class="c1"># Tokens must appear in at least 2 documents</span>
</span><span id="__span-0-5"><span class="gp">... </span>    <span class="n">max_vocab_size</span><span class="o">=</span><span class="mi">10000</span>
</span><span id="__span-0-6"><span class="gp">... </span><span class="p">)</span>
</span><span id="__span-0-7"><span class="gp">&gt;&gt;&gt;</span>
</span><span id="__span-0-8"><span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">indexer</span><span class="o">.</span><span class="n">train</span><span class="p">():</span>
</span><span id="__span-0-9"><span class="gp">... </span>    <span class="n">tokens1</span> <span class="o">=</span> <span class="n">indexer</span><span class="o">.</span><span class="n">instance</span><span class="p">([</span><span class="s2">&quot;hello&quot;</span><span class="p">,</span> <span class="s2">&quot;world&quot;</span><span class="p">])</span>
</span><span id="__span-0-10"><span class="gp">... </span>    <span class="n">tokens2</span> <span class="o">=</span> <span class="n">indexer</span><span class="o">.</span><span class="n">instance</span><span class="p">([</span><span class="s2">&quot;hello&quot;</span><span class="p">,</span> <span class="s2">&quot;there&quot;</span><span class="p">])</span>
</span><span id="__span-0-11"><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Vocabulary: {&quot;&lt;PAD&gt;&quot;: 0, &quot;&lt;UNK&gt;&quot;: 1, &quot;hello&quot;: 2, &quot;world&quot;: 3, &quot;there&quot;: 4}</span>
</span><span id="__span-0-12"><span class="gp">&gt;&gt;&gt;</span>
</span><span id="__span-0-13"><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create batch with padding</span>
</span><span id="__span-0-14"><span class="gp">&gt;&gt;&gt; </span><span class="n">batch</span> <span class="o">=</span> <span class="n">indexer</span><span class="o">.</span><span class="n">batch</span><span class="p">([</span>
</span><span id="__span-0-15"><span class="gp">... </span>    <span class="p">[</span><span class="s2">&quot;hello&quot;</span><span class="p">,</span> <span class="s2">&quot;world&quot;</span><span class="p">],</span>
</span><span id="__span-0-16"><span class="gp">... </span>    <span class="p">[</span><span class="s2">&quot;hello&quot;</span><span class="p">,</span> <span class="s2">&quot;there&quot;</span><span class="p">,</span> <span class="s2">&quot;friend&quot;</span><span class="p">]</span>
</span><span id="__span-0-17"><span class="gp">... </span><span class="p">])</span>
</span><span id="__span-0-18"><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">batch</span><span class="o">.</span><span class="n">ids</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>  <span class="c1"># (2, 3) - padded to max length</span>
</span><span id="__span-0-19"><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">batch</span><span class="o">.</span><span class="n">mask</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>  <span class="c1"># (2, 3) - True for real tokens</span>
</span><span id="__span-0-20"><span class="gp">&gt;&gt;&gt;</span>
</span><span id="__span-0-21"><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Reconstruct original tokens</span>
</span><span id="__span-0-22"><span class="gp">&gt;&gt;&gt; </span><span class="n">tokens</span> <span class="o">=</span> <span class="n">indexer</span><span class="o">.</span><span class="n">reconstruct</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span>
</span><span id="__span-0-23"><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">tokens</span><span class="p">)</span>  <span class="c1"># [[&quot;hello&quot;, &quot;world&quot;], [&quot;hello&quot;, &quot;there&quot;, &quot;friend&quot;]]</span>
</span></code></pre></div>


<details class="note" open>
  <summary>Note</summary>
  <ul>
<li>Special tokens are always added first and never filtered</li>
<li><code>min_df</code>/<code>max_df</code> require <code>unk_token</code> to handle filtered tokens</li>
<li>Document frequency counts unique tokens per document</li>
<li>BOS/EOS tokens are added during batching if specified</li>
<li>Reconstruction removes special tokens and padding</li>
</ul>
</details>

<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RAISES</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
              <span class="doc-raises-annotation">
                  <code><span title="ValueError">ValueError</span></code>
              </span>
            </td>
            <td class="doc-raises-details">
              <div class="doc-md-description">
                <p>If configuration is invalid (e.g., min_df&gt;1 without unk_token).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>











<div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="formed.integrations.ml.transforms.nlp.TokenSequenceIndexer.vocab" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">vocab</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#formed.integrations.ml.transforms.nlp.TokenSequenceIndexer.vocab" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="n">vocab</span> <span class="o">=</span> <span class="n"><span title="dataclasses.field">field</span></span><span class="p">(</span><span class="n"><span title="dataclasses.field(default_factory)">default_factory</span></span><span class="o">=</span><span class="n"><span title="dict">dict</span></span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="formed.integrations.ml.transforms.nlp.TokenSequenceIndexer.pad_token" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">pad_token</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#formed.integrations.ml.transforms.nlp.TokenSequenceIndexer.pad_token" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="n">pad_token</span> <span class="o">=</span> <span class="s1">&#39;&lt;PAD&gt;&#39;</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="formed.integrations.ml.transforms.nlp.TokenSequenceIndexer.unk_token" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">unk_token</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#formed.integrations.ml.transforms.nlp.TokenSequenceIndexer.unk_token" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="n">unk_token</span> <span class="o">=</span> <span class="kc">None</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="formed.integrations.ml.transforms.nlp.TokenSequenceIndexer.bos_token" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">bos_token</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#formed.integrations.ml.transforms.nlp.TokenSequenceIndexer.bos_token" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="n">bos_token</span> <span class="o">=</span> <span class="kc">None</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="formed.integrations.ml.transforms.nlp.TokenSequenceIndexer.eos_token" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">eos_token</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#formed.integrations.ml.transforms.nlp.TokenSequenceIndexer.eos_token" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="n">eos_token</span> <span class="o">=</span> <span class="kc">None</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="formed.integrations.ml.transforms.nlp.TokenSequenceIndexer.min_df" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">min_df</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#formed.integrations.ml.transforms.nlp.TokenSequenceIndexer.min_df" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="n">min_df</span> <span class="o">=</span> <span class="mi">1</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="formed.integrations.ml.transforms.nlp.TokenSequenceIndexer.max_df" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">max_df</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#formed.integrations.ml.transforms.nlp.TokenSequenceIndexer.max_df" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="n">max_df</span> <span class="o">=</span> <span class="mf">1.0</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="formed.integrations.ml.transforms.nlp.TokenSequenceIndexer.max_vocab_size" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">max_vocab_size</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#formed.integrations.ml.transforms.nlp.TokenSequenceIndexer.max_vocab_size" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="n">max_vocab_size</span> <span class="o">=</span> <span class="kc">None</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="formed.integrations.ml.transforms.nlp.TokenSequenceIndexer.freeze" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">freeze</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#formed.integrations.ml.transforms.nlp.TokenSequenceIndexer.freeze" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="n">freeze</span> <span class="o">=</span> <span class="kc">False</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="formed.integrations.ml.transforms.nlp.TokenSequenceIndexer.pad_index" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">pad_index</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#formed.integrations.ml.transforms.nlp.TokenSequenceIndexer.pad_index" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="n">pad_index</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Index of the padding token.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="formed.integrations.ml.transforms.nlp.TokenSequenceIndexer.unk_index" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">unk_index</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#formed.integrations.ml.transforms.nlp.TokenSequenceIndexer.unk_index" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="n">unk_index</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Index of the unknown token, or <code>None</code> if not set.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="formed.integrations.ml.transforms.nlp.TokenSequenceIndexer.bos_index" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">bos_index</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#formed.integrations.ml.transforms.nlp.TokenSequenceIndexer.bos_index" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="n">bos_index</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Index of the beginning-of-sequence token, or <code>None</code> if not set.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="formed.integrations.ml.transforms.nlp.TokenSequenceIndexer.eos_index" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">eos_index</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#formed.integrations.ml.transforms.nlp.TokenSequenceIndexer.eos_index" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="n">eos_index</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Index of the end-of-sequence token, or <code>None</code> if not set.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="formed.integrations.ml.transforms.nlp.TokenSequenceIndexer.vocab_size" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">vocab_size</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#formed.integrations.ml.transforms.nlp.TokenSequenceIndexer.vocab_size" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="n">vocab_size</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Total number of tokens in the vocabulary.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="formed.integrations.ml.transforms.nlp.TokenSequenceIndexer.accessor" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">accessor</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#formed.integrations.ml.transforms.nlp.TokenSequenceIndexer.accessor" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="n">accessor</span> <span class="o">=</span> <span class="kc">None</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>




<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.transforms.nlp.TokenSequenceIndexer.get_index" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">get_index</span>


<a href="#formed.integrations.ml.transforms.nlp.TokenSequenceIndexer.get_index" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">get_index</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Get the index of a token, using unk_token if not found.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/transforms/nlp.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-235"><span class="k">def</span><span class="w"> </span><span class="nf">get_index</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="__span-0-236"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the index of a token, using unk_token if not found.&quot;&quot;&quot;</span>
</span><span id="__span-0-237">    <span class="k">if</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">vocab</span><span class="p">:</span>
</span><span id="__span-0-238">        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">vocab</span><span class="p">[</span><span class="n">value</span><span class="p">]</span>
</span><span id="__span-0-239">    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">unk_token</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-240">        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">vocab</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">unk_token</span><span class="p">]</span>
</span><span id="__span-0-241">    <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.transforms.nlp.TokenSequenceIndexer.get_value" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">get_value</span>


<a href="#formed.integrations.ml.transforms.nlp.TokenSequenceIndexer.get_value" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">get_value</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Get the token corresponding to an index.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/transforms/nlp.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-243"><span class="k">def</span><span class="w"> </span><span class="nf">get_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="__span-0-244"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the token corresponding to an index.&quot;&quot;&quot;</span>
</span><span id="__span-0-245">    <span class="k">if</span> <span class="n">index</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_inverted_vocab</span><span class="p">:</span>
</span><span id="__span-0-246">        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_inverted_vocab</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
</span><span id="__span-0-247">    <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.transforms.nlp.TokenSequenceIndexer.ingest" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">ingest</span>


<a href="#formed.integrations.ml.transforms.nlp.TokenSequenceIndexer.ingest" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">ingest</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Ingest a sequence of tokens to update counts for vocabulary building.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/transforms/nlp.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-249"><span class="k">def</span><span class="w"> </span><span class="nf">ingest</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">values</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-250"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Ingest a sequence of tokens to update counts for vocabulary building.&quot;&quot;&quot;</span>
</span><span id="__span-0-251">    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">freeze</span><span class="p">:</span>
</span><span id="__span-0-252">        <span class="k">return</span>
</span><span id="__span-0-253">    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_training</span><span class="p">:</span>
</span><span id="__span-0-254">        <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">values</span><span class="p">:</span>
</span><span id="__span-0-255">            <span class="bp">self</span><span class="o">.</span><span class="n">_token_counts</span><span class="p">[</span><span class="n">token</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_token_counts</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">token</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="__span-0-256">        <span class="bp">self</span><span class="o">.</span><span class="n">_document_count</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="__span-0-257">        <span class="k">for</span> <span class="n">toke</span> <span class="ow">in</span> <span class="nb">set</span><span class="p">(</span><span class="n">values</span><span class="p">):</span>
</span><span id="__span-0-258">            <span class="bp">self</span><span class="o">.</span><span class="n">_document_frequencies</span><span class="p">[</span><span class="n">toke</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_document_frequencies</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">toke</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="__span-0-259">    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-260">        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Ignoring ingest call when not in training mode&quot;</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.transforms.nlp.TokenSequenceIndexer.instance" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">instance</span>


<a href="#formed.integrations.ml.transforms.nlp.TokenSequenceIndexer.instance" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">instance</span><span class="p">(</span><span class="n">tokens</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/transforms/nlp.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-262"><span class="k">def</span><span class="w"> </span><span class="nf">instance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tokens</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="__span-0-263">    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_training</span><span class="p">:</span>
</span><span id="__span-0-264">        <span class="bp">self</span><span class="o">.</span><span class="n">ingest</span><span class="p">(</span><span class="n">tokens</span><span class="p">)</span>
</span><span id="__span-0-265">    <span class="k">return</span> <span class="n">tokens</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.transforms.nlp.TokenSequenceIndexer.batch" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">batch</span>


<a href="#formed.integrations.ml.transforms.nlp.TokenSequenceIndexer.batch" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">batch</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/transforms/nlp.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-267"><span class="k">def</span><span class="w"> </span><span class="nf">batch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">IDSequenceBatch</span><span class="p">:</span>
</span><span id="__span-0-268">    <span class="n">batch_size</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span>
</span><span id="__span-0-269">    <span class="n">max_length</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">tokens</span><span class="p">)</span> <span class="k">for</span> <span class="n">tokens</span> <span class="ow">in</span> <span class="n">batch</span><span class="p">)</span>
</span><span id="__span-0-270">    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">bos_token</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-271">        <span class="n">max_length</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="__span-0-272">    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">eos_token</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-273">        <span class="n">max_length</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="__span-0-274">    <span class="n">ids</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">full</span><span class="p">((</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">max_length</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">pad_index</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span>
</span><span id="__span-0-275">    <span class="n">mask</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">max_length</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">bool_</span><span class="p">)</span>
</span><span id="__span-0-276">    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">tokens</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">batch</span><span class="p">):</span>
</span><span id="__span-0-277">        <span class="n">indices</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">get_index</span><span class="p">(</span><span class="n">token</span><span class="p">)</span> <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">tokens</span><span class="p">]</span>
</span><span id="__span-0-278">        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">bos_token</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-279">            <span class="n">indices</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">vocab</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">bos_token</span><span class="p">]]</span> <span class="o">+</span> <span class="n">indices</span>
</span><span id="__span-0-280">        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">eos_token</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-281">            <span class="n">indices</span> <span class="o">=</span> <span class="n">indices</span> <span class="o">+</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">vocab</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">eos_token</span><span class="p">]]</span>
</span><span id="__span-0-282">        <span class="n">length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">indices</span><span class="p">)</span>
</span><span id="__span-0-283">        <span class="n">ids</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:</span><span class="n">length</span><span class="p">]</span> <span class="o">=</span> <span class="n">indices</span>
</span><span id="__span-0-284">        <span class="n">mask</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:</span><span class="n">length</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="__span-0-285">    <span class="k">return</span> <span class="n">IDSequenceBatch</span><span class="p">(</span><span class="n">ids</span><span class="o">=</span><span class="n">ids</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="n">mask</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.transforms.nlp.TokenSequenceIndexer.reconstruct" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">reconstruct</span>


<a href="#formed.integrations.ml.transforms.nlp.TokenSequenceIndexer.reconstruct" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">reconstruct</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Reconstruct token sequences from a batch of indices.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/transforms/nlp.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-287"><span class="k">def</span><span class="w"> </span><span class="nf">reconstruct</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch</span><span class="p">:</span> <span class="n">IDSequenceBatch</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="__span-0-288"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Reconstruct token sequences from a batch of indices.&quot;&quot;&quot;</span>
</span><span id="__span-0-289">    <span class="n">sequences</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-0-290">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">batch</span><span class="o">.</span><span class="n">ids</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
</span><span id="__span-0-291">        <span class="n">length</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">batch</span><span class="o">.</span><span class="n">mask</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
</span><span id="__span-0-292">        <span class="n">indices</span> <span class="o">=</span> <span class="n">batch</span><span class="o">.</span><span class="n">ids</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:</span><span class="n">length</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</span><span id="__span-0-293">        <span class="n">tokens</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">get_value</span><span class="p">(</span><span class="n">index</span><span class="p">)</span> <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="n">indices</span><span class="p">]</span>
</span><span id="__span-0-294">        <span class="k">if</span> <span class="n">tokens</span> <span class="ow">and</span> <span class="n">tokens</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">bos_token</span><span class="p">:</span>
</span><span id="__span-0-295">            <span class="n">tokens</span> <span class="o">=</span> <span class="n">tokens</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
</span><span id="__span-0-296">        <span class="k">if</span> <span class="n">tokens</span> <span class="ow">and</span> <span class="n">tokens</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">eos_token</span><span class="p">:</span>
</span><span id="__span-0-297">            <span class="n">tokens</span> <span class="o">=</span> <span class="n">tokens</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="__span-0-298">        <span class="n">tokens</span> <span class="o">=</span> <span class="p">[</span><span class="n">token</span> <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">tokens</span> <span class="k">if</span> <span class="n">token</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pad_token</span><span class="p">]</span>
</span><span id="__span-0-299">        <span class="n">sequences</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tokens</span><span class="p">)</span>
</span><span id="__span-0-300">    <span class="k">return</span> <span class="n">sequences</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.transforms.nlp.TokenSequenceIndexer.train" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">train</span>


<a href="#formed.integrations.ml.transforms.nlp.TokenSequenceIndexer.train" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">train</span><span class="p">()</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Context manager to enable training mode for stateful transformations.</p>
<p>In training mode, transforms can build state (e.g., vocabularies, statistics)
from the training data. Hooks <code>_on_start_training()</code> and <code>_on_end_training()</code>
are called at the beginning and end of the training context.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">YIELDS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-yields-annotation">
                    <code>None</code>
                </span>
            </td>
            <td class="doc-yields-details">
              <div class="doc-md-description">
                <p>None</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span id="__span-0-1"><span class="gp">&gt;&gt;&gt; </span><span class="n">indexer</span> <span class="o">=</span> <span class="n">TokenSequenceIndexer</span><span class="p">()</span>
</span><span id="__span-0-2"><span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">indexer</span><span class="o">.</span><span class="n">train</span><span class="p">():</span>
</span><span id="__span-0-3"><span class="gp">... </span>    <span class="c1"># Build vocabulary from training data</span>
</span><span id="__span-0-4"><span class="gp">... </span>    <span class="n">tokens1</span> <span class="o">=</span> <span class="n">indexer</span><span class="o">.</span><span class="n">instance</span><span class="p">([</span><span class="s2">&quot;hello&quot;</span><span class="p">,</span> <span class="s2">&quot;world&quot;</span><span class="p">])</span>
</span><span id="__span-0-5"><span class="gp">... </span>    <span class="n">tokens2</span> <span class="o">=</span> <span class="n">indexer</span><span class="o">.</span><span class="n">instance</span><span class="p">([</span><span class="s2">&quot;hello&quot;</span><span class="p">,</span> <span class="s2">&quot;there&quot;</span><span class="p">])</span>
</span><span id="__span-0-6"><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Vocabulary is now frozen, use for inference</span>
</span><span id="__span-0-7"><span class="gp">&gt;&gt;&gt; </span><span class="n">test_tokens</span> <span class="o">=</span> <span class="n">indexer</span><span class="o">.</span><span class="n">instance</span><span class="p">([</span><span class="s2">&quot;hello&quot;</span><span class="p">,</span> <span class="s2">&quot;unknown&quot;</span><span class="p">])</span>
</span></code></pre></div>


<details class="note" open>
  <summary>Note</summary>
  <p>Training mode is reentrant but nested calls won't trigger hooks again.</p>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/transforms/base.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-596"><span class="nd">@contextmanager</span>
</span><span id="__span-0-597"><span class="k">def</span><span class="w"> </span><span class="nf">train</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="kc">None</span><span class="p">]:</span>
</span><span id="__span-0-598"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Context manager to enable training mode for stateful transformations.</span>
</span><span id="__span-0-599">
</span><span id="__span-0-600"><span class="sd">    In training mode, transforms can build state (e.g., vocabularies, statistics)</span>
</span><span id="__span-0-601"><span class="sd">    from the training data. Hooks `_on_start_training()` and `_on_end_training()`</span>
</span><span id="__span-0-602"><span class="sd">    are called at the beginning and end of the training context.</span>
</span><span id="__span-0-603">
</span><span id="__span-0-604"><span class="sd">    Yields:</span>
</span><span id="__span-0-605"><span class="sd">        None</span>
</span><span id="__span-0-606">
</span><span id="__span-0-607"><span class="sd">    Examples:</span>
</span><span id="__span-0-608"><span class="sd">        &gt;&gt;&gt; indexer = TokenSequenceIndexer()</span>
</span><span id="__span-0-609"><span class="sd">        &gt;&gt;&gt; with indexer.train():</span>
</span><span id="__span-0-610"><span class="sd">        ...     # Build vocabulary from training data</span>
</span><span id="__span-0-611"><span class="sd">        ...     tokens1 = indexer.instance([&quot;hello&quot;, &quot;world&quot;])</span>
</span><span id="__span-0-612"><span class="sd">        ...     tokens2 = indexer.instance([&quot;hello&quot;, &quot;there&quot;])</span>
</span><span id="__span-0-613"><span class="sd">        &gt;&gt;&gt; # Vocabulary is now frozen, use for inference</span>
</span><span id="__span-0-614"><span class="sd">        &gt;&gt;&gt; test_tokens = indexer.instance([&quot;hello&quot;, &quot;unknown&quot;])</span>
</span><span id="__span-0-615">
</span><span id="__span-0-616"><span class="sd">    Note:</span>
</span><span id="__span-0-617"><span class="sd">        Training mode is reentrant but nested calls won&#39;t trigger hooks again.</span>
</span><span id="__span-0-618">
</span><span id="__span-0-619"><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-620">    <span class="n">original</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_training</span>
</span><span id="__span-0-621">    <span class="bp">self</span><span class="o">.</span><span class="n">_training</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="__span-0-622">    <span class="k">try</span><span class="p">:</span>
</span><span id="__span-0-623">        <span class="k">if</span> <span class="ow">not</span> <span class="n">original</span><span class="p">:</span>
</span><span id="__span-0-624">            <span class="bp">self</span><span class="o">.</span><span class="n">_on_start_training</span><span class="p">()</span>
</span><span id="__span-0-625">        <span class="k">yield</span>
</span><span id="__span-0-626">        <span class="k">if</span> <span class="ow">not</span> <span class="n">original</span><span class="p">:</span>
</span><span id="__span-0-627">            <span class="bp">self</span><span class="o">.</span><span class="n">_on_end_training</span><span class="p">()</span>
</span><span id="__span-0-628">    <span class="k">finally</span><span class="p">:</span>
</span><span id="__span-0-629">        <span class="bp">self</span><span class="o">.</span><span class="n">_training</span> <span class="o">=</span> <span class="n">original</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.transforms.nlp.TokenSequenceIndexer.save" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">save</span>


<a href="#formed.integrations.ml.transforms.nlp.TokenSequenceIndexer.save" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">save</span><span class="p">(</span><span class="n">directory</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Save the transform to a directory using cloudpickle.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>directory</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Directory path to save the transform.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="str">str</span> | <span title="os.PathLike">PathLike</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Note</summary>
  <p>The transform is saved as 'transform.pkl' in the specified directory.
cloudpickle is used to handle complex objects like lambdas and closures.</p>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/transforms/base.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-631"><span class="k">def</span><span class="w"> </span><span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">directory</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">PathLike</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-632"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Save the transform to a directory using cloudpickle.</span>
</span><span id="__span-0-633">
</span><span id="__span-0-634"><span class="sd">    Args:</span>
</span><span id="__span-0-635"><span class="sd">        directory: Directory path to save the transform.</span>
</span><span id="__span-0-636">
</span><span id="__span-0-637"><span class="sd">    Note:</span>
</span><span id="__span-0-638"><span class="sd">        The transform is saved as &#39;transform.pkl&#39; in the specified directory.</span>
</span><span id="__span-0-639"><span class="sd">        cloudpickle is used to handle complex objects like lambdas and closures.</span>
</span><span id="__span-0-640">
</span><span id="__span-0-641"><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-642">    <span class="n">filepath</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">directory</span><span class="p">)</span> <span class="o">/</span> <span class="s2">&quot;transform.pkl&quot;</span>
</span><span id="__span-0-643">    <span class="k">with</span> <span class="n">filepath</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="__span-0-644">        <span class="n">cloudpickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.transforms.nlp.TokenSequenceIndexer.load" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">load</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#formed.integrations.ml.transforms.nlp.TokenSequenceIndexer.load" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">load</span><span class="p">(</span><span class="n">directory</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Load a transform from a directory.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>directory</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Directory path containing the saved transform.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="str">str</span> | <span title="os.PathLike">PathLike</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="typing.Self">Self</span></code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>The loaded transform instance.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RAISES</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
              <span class="doc-raises-annotation">
                  <code><span title="TypeError">TypeError</span></code>
              </span>
            </td>
            <td class="doc-raises-details">
              <div class="doc-md-description">
                <p>If the loaded object is not an instance of this class.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Note</summary>
  <p>Expects a 'transform.pkl' file in the specified directory.</p>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/transforms/base.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-646"><span class="nd">@classmethod</span>
</span><span id="__span-0-647"><span class="k">def</span><span class="w"> </span><span class="nf">load</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">directory</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">PathLike</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
</span><span id="__span-0-648"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Load a transform from a directory.</span>
</span><span id="__span-0-649">
</span><span id="__span-0-650"><span class="sd">    Args:</span>
</span><span id="__span-0-651"><span class="sd">        directory: Directory path containing the saved transform.</span>
</span><span id="__span-0-652">
</span><span id="__span-0-653"><span class="sd">    Returns:</span>
</span><span id="__span-0-654"><span class="sd">        The loaded transform instance.</span>
</span><span id="__span-0-655">
</span><span id="__span-0-656"><span class="sd">    Raises:</span>
</span><span id="__span-0-657"><span class="sd">        TypeError: If the loaded object is not an instance of this class.</span>
</span><span id="__span-0-658">
</span><span id="__span-0-659"><span class="sd">    Note:</span>
</span><span id="__span-0-660"><span class="sd">        Expects a &#39;transform.pkl&#39; file in the specified directory.</span>
</span><span id="__span-0-661">
</span><span id="__span-0-662"><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-663">    <span class="n">filepath</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">directory</span><span class="p">)</span> <span class="o">/</span> <span class="s2">&quot;transform.pkl&quot;</span>
</span><span id="__span-0-664">    <span class="k">with</span> <span class="n">filepath</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="__span-0-665">        <span class="n">obj</span> <span class="o">=</span> <span class="n">cloudpickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</span><span id="__span-0-666">    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="bp">cls</span><span class="p">):</span>
</span><span id="__span-0-667">        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Loaded object is not an instance of </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-0-668">    <span class="k">return</span> <span class="n">obj</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="formed.integrations.ml.transforms.nlp.TokenCharactersIndexer" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">TokenCharactersIndexer</span>


<a href="#formed.integrations.ml.transforms.nlp.TokenCharactersIndexer" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;TokenSequenceIndexer&lt;/span&gt; (&lt;code&gt;formed.integrations.ml.transforms.nlp.TokenSequenceIndexer&lt;/code&gt;)" href="#formed.integrations.ml.transforms.nlp.TokenSequenceIndexer">TokenSequenceIndexer</a>[<span title="formed.integrations.ml.transforms.nlp._S">_S</span>]</code>, <code><span title="typing.Generic">Generic</span>[<span title="formed.integrations.ml.transforms.nlp._S">_S</span>]</code></p>



        <p>Character-level indexing for token sequences.</p>
<p>TokenCharactersIndexer extends TokenSequenceIndexer to index individual characters
within tokens. This is useful for character-level models or handling rare words.
The batch output is a 3D tensor: (batch_size, num_tokens, max_characters).</p>


<table>
      <thead>
        <tr>
          <th>
            <span class="doc-section-title">
              CLASS TYPE PARAMETER
            </span>
          </th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>_S</code>
            </td>
            <td class="doc-type_param-details">
              <div class="doc-md-description">
                <p>Source data type before accessor</p>
              </div>
              <p>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">ATTRIBUTE</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-attribute&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-attribute-name&quot;&gt;min_characters&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-class-attribute&quot;&gt;&lt;code&gt;class-attribute&lt;/code&gt;&lt;/small&gt;
      &lt;small class=&quot;doc doc-label doc-label-instance-attribute&quot;&gt;&lt;code&gt;instance-attribute&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;formed.integrations.ml.transforms.nlp.TokenCharactersIndexer.min_characters&lt;/code&gt;)" href="#formed.integrations.ml.transforms.nlp.TokenCharactersIndexer.min_characters">min_characters</a></code></td>
            <td class="doc-attribute-details">
              <div class="doc-md-description">
                <p>Minimum character length per token (for padding).</p>
              </div>
              <p>
                  <span class="doc-attribute-annotation">
                    <b>TYPE:</b>
                      <code><span title="int">int</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Note</summary>
  <p>Inherits all attributes from TokenSequenceIndexer.</p>
</details>

<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span id="__span-0-1"><span class="gp">&gt;&gt;&gt; </span><span class="n">indexer</span> <span class="o">=</span> <span class="n">TokenCharactersIndexer</span><span class="p">(</span>
</span><span id="__span-0-2"><span class="gp">... </span>    <span class="n">unk_token</span><span class="o">=</span><span class="s2">&quot;&lt;UNK&gt;&quot;</span><span class="p">,</span>
</span><span id="__span-0-3"><span class="gp">... </span>    <span class="n">bos_token</span><span class="o">=</span><span class="s2">&quot;&lt;BOS&gt;&quot;</span><span class="p">,</span>
</span><span id="__span-0-4"><span class="gp">... </span>    <span class="n">eos_token</span><span class="o">=</span><span class="s2">&quot;&lt;EOS&gt;&quot;</span>
</span><span id="__span-0-5"><span class="gp">... </span><span class="p">)</span>
</span><span id="__span-0-6"><span class="gp">&gt;&gt;&gt;</span>
</span><span id="__span-0-7"><span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">indexer</span><span class="o">.</span><span class="n">train</span><span class="p">():</span>
</span><span id="__span-0-8"><span class="gp">... </span>    <span class="n">tokens</span> <span class="o">=</span> <span class="n">indexer</span><span class="o">.</span><span class="n">instance</span><span class="p">([</span><span class="s2">&quot;hello&quot;</span><span class="p">,</span> <span class="s2">&quot;world&quot;</span><span class="p">])</span>
</span><span id="__span-0-9"><span class="gp">&gt;&gt;&gt;</span>
</span><span id="__span-0-10"><span class="gp">&gt;&gt;&gt; </span><span class="n">batch</span> <span class="o">=</span> <span class="n">indexer</span><span class="o">.</span><span class="n">batch</span><span class="p">([[</span><span class="s2">&quot;hello&quot;</span><span class="p">,</span> <span class="s2">&quot;world&quot;</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;hi&quot;</span><span class="p">]])</span>
</span><span id="__span-0-11"><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">batch</span><span class="o">.</span><span class="n">ids</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>  <span class="c1"># (2, 2, 7) - batch x tokens x chars</span>
</span><span id="__span-0-12"><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">batch</span><span class="o">.</span><span class="n">mask</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>  <span class="c1"># (2, 2, 7)</span>
</span></code></pre></div>


<details class="note" open>
  <summary>Note</summary>
  <ul>
<li>Each token is converted to a sequence of character indices</li>
<li>BOS/EOS are added per token, not per sequence</li>
<li>Vocabulary contains individual characters, not tokens</li>
<li>Useful for morphologically rich languages or rare word handling</li>
</ul>
</details>










<div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="formed.integrations.ml.transforms.nlp.TokenCharactersIndexer.min_characters" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">min_characters</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#formed.integrations.ml.transforms.nlp.TokenCharactersIndexer.min_characters" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="n">min_characters</span> <span class="o">=</span> <span class="mi">1</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="formed.integrations.ml.transforms.nlp.TokenCharactersIndexer.accessor" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">accessor</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#formed.integrations.ml.transforms.nlp.TokenCharactersIndexer.accessor" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="n">accessor</span> <span class="o">=</span> <span class="kc">None</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="formed.integrations.ml.transforms.nlp.TokenCharactersIndexer.vocab" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">vocab</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#formed.integrations.ml.transforms.nlp.TokenCharactersIndexer.vocab" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="n">vocab</span> <span class="o">=</span> <span class="n"><span title="dataclasses.field">field</span></span><span class="p">(</span><span class="n"><span title="dataclasses.field(default_factory)">default_factory</span></span><span class="o">=</span><span class="n"><span title="dict">dict</span></span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="formed.integrations.ml.transforms.nlp.TokenCharactersIndexer.pad_token" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">pad_token</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#formed.integrations.ml.transforms.nlp.TokenCharactersIndexer.pad_token" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="n">pad_token</span> <span class="o">=</span> <span class="s1">&#39;&lt;PAD&gt;&#39;</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="formed.integrations.ml.transforms.nlp.TokenCharactersIndexer.unk_token" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">unk_token</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#formed.integrations.ml.transforms.nlp.TokenCharactersIndexer.unk_token" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="n">unk_token</span> <span class="o">=</span> <span class="kc">None</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="formed.integrations.ml.transforms.nlp.TokenCharactersIndexer.bos_token" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">bos_token</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#formed.integrations.ml.transforms.nlp.TokenCharactersIndexer.bos_token" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="n">bos_token</span> <span class="o">=</span> <span class="kc">None</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="formed.integrations.ml.transforms.nlp.TokenCharactersIndexer.eos_token" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">eos_token</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#formed.integrations.ml.transforms.nlp.TokenCharactersIndexer.eos_token" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="n">eos_token</span> <span class="o">=</span> <span class="kc">None</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="formed.integrations.ml.transforms.nlp.TokenCharactersIndexer.min_df" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">min_df</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#formed.integrations.ml.transforms.nlp.TokenCharactersIndexer.min_df" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="n">min_df</span> <span class="o">=</span> <span class="mi">1</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="formed.integrations.ml.transforms.nlp.TokenCharactersIndexer.max_df" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">max_df</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#formed.integrations.ml.transforms.nlp.TokenCharactersIndexer.max_df" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="n">max_df</span> <span class="o">=</span> <span class="mf">1.0</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="formed.integrations.ml.transforms.nlp.TokenCharactersIndexer.max_vocab_size" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">max_vocab_size</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#formed.integrations.ml.transforms.nlp.TokenCharactersIndexer.max_vocab_size" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="n">max_vocab_size</span> <span class="o">=</span> <span class="kc">None</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="formed.integrations.ml.transforms.nlp.TokenCharactersIndexer.freeze" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">freeze</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#formed.integrations.ml.transforms.nlp.TokenCharactersIndexer.freeze" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="n">freeze</span> <span class="o">=</span> <span class="kc">False</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="formed.integrations.ml.transforms.nlp.TokenCharactersIndexer.pad_index" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">pad_index</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#formed.integrations.ml.transforms.nlp.TokenCharactersIndexer.pad_index" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="n">pad_index</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Index of the padding token.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="formed.integrations.ml.transforms.nlp.TokenCharactersIndexer.unk_index" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">unk_index</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#formed.integrations.ml.transforms.nlp.TokenCharactersIndexer.unk_index" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="n">unk_index</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Index of the unknown token, or <code>None</code> if not set.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="formed.integrations.ml.transforms.nlp.TokenCharactersIndexer.bos_index" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">bos_index</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#formed.integrations.ml.transforms.nlp.TokenCharactersIndexer.bos_index" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="n">bos_index</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Index of the beginning-of-sequence token, or <code>None</code> if not set.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="formed.integrations.ml.transforms.nlp.TokenCharactersIndexer.eos_index" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">eos_index</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#formed.integrations.ml.transforms.nlp.TokenCharactersIndexer.eos_index" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="n">eos_index</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Index of the end-of-sequence token, or <code>None</code> if not set.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="formed.integrations.ml.transforms.nlp.TokenCharactersIndexer.vocab_size" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">vocab_size</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#formed.integrations.ml.transforms.nlp.TokenCharactersIndexer.vocab_size" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="n">vocab_size</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Total number of tokens in the vocabulary.</p>

    </div>

</div>




<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.transforms.nlp.TokenCharactersIndexer.ingest" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">ingest</span>


<a href="#formed.integrations.ml.transforms.nlp.TokenCharactersIndexer.ingest" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">ingest</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/transforms/nlp.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">349</span>
<span class="normal">350</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-349"><span class="k">def</span><span class="w"> </span><span class="nf">ingest</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">values</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-350">    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">ingest</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">values</span><span class="p">))</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.transforms.nlp.TokenCharactersIndexer.batch" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">batch</span>


<a href="#formed.integrations.ml.transforms.nlp.TokenCharactersIndexer.batch" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">batch</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/transforms/nlp.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-352"><span class="k">def</span><span class="w"> </span><span class="nf">batch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">IDSequenceBatch</span><span class="p">:</span>
</span><span id="__span-0-353">    <span class="n">batch_size</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span>
</span><span id="__span-0-354">    <span class="n">max_tokens</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">tokens</span><span class="p">)</span> <span class="k">for</span> <span class="n">tokens</span> <span class="ow">in</span> <span class="n">batch</span><span class="p">)</span>
</span><span id="__span-0-355">    <span class="n">max_characters</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">min_characters</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">token</span><span class="p">)</span> <span class="k">for</span> <span class="n">tokens</span> <span class="ow">in</span> <span class="n">batch</span> <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">tokens</span><span class="p">))</span>
</span><span id="__span-0-356">    <span class="n">ids</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">full</span><span class="p">((</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">max_tokens</span><span class="p">,</span> <span class="n">max_characters</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">pad_index</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span>
</span><span id="__span-0-357">    <span class="n">mask</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">max_tokens</span><span class="p">,</span> <span class="n">max_characters</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">bool_</span><span class="p">)</span>
</span><span id="__span-0-358">    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">tokens</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">batch</span><span class="p">):</span>
</span><span id="__span-0-359">        <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">token</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">tokens</span><span class="p">):</span>
</span><span id="__span-0-360">            <span class="n">indices</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">get_index</span><span class="p">(</span><span class="n">char</span><span class="p">)</span> <span class="k">for</span> <span class="n">char</span> <span class="ow">in</span> <span class="n">token</span><span class="p">]</span>
</span><span id="__span-0-361">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">bos_token</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-362">                <span class="n">indices</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">vocab</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">bos_token</span><span class="p">]]</span> <span class="o">+</span> <span class="n">indices</span>
</span><span id="__span-0-363">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">eos_token</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-364">                <span class="n">indices</span> <span class="o">=</span> <span class="n">indices</span> <span class="o">+</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">vocab</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">eos_token</span><span class="p">]]</span>
</span><span id="__span-0-365">            <span class="n">length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">indices</span><span class="p">)</span>
</span><span id="__span-0-366">            <span class="n">ids</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="p">:</span><span class="n">length</span><span class="p">]</span> <span class="o">=</span> <span class="n">indices</span>
</span><span id="__span-0-367">            <span class="n">mask</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="p">:</span><span class="n">length</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="__span-0-368">    <span class="k">return</span> <span class="n">IDSequenceBatch</span><span class="p">(</span><span class="n">ids</span><span class="o">=</span><span class="n">ids</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="n">mask</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.transforms.nlp.TokenCharactersIndexer.reconstruct" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">reconstruct</span>


<a href="#formed.integrations.ml.transforms.nlp.TokenCharactersIndexer.reconstruct" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">reconstruct</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/transforms/nlp.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-370"><span class="k">def</span><span class="w"> </span><span class="nf">reconstruct</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch</span><span class="p">:</span> <span class="n">IDSequenceBatch</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="__span-0-371">    <span class="n">sequences</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-0-372">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">batch</span><span class="o">.</span><span class="n">ids</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
</span><span id="__span-0-373">        <span class="n">token_indices</span> <span class="o">=</span> <span class="n">batch</span><span class="o">.</span><span class="n">ids</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span><span id="__span-0-374">        <span class="n">token_mask</span> <span class="o">=</span> <span class="n">batch</span><span class="o">.</span><span class="n">mask</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span><span id="__span-0-375">        <span class="n">tokens</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-0-376">        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">token_indices</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
</span><span id="__span-0-377">            <span class="k">if</span> <span class="ow">not</span> <span class="n">token_mask</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
</span><span id="__span-0-378">                <span class="k">break</span>
</span><span id="__span-0-379">            <span class="n">length</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">token_mask</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
</span><span id="__span-0-380">            <span class="n">char_indices</span> <span class="o">=</span> <span class="n">token_indices</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="p">:</span><span class="n">length</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</span><span id="__span-0-381">            <span class="n">chars</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">get_value</span><span class="p">(</span><span class="n">index</span><span class="p">)</span> <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="n">char_indices</span><span class="p">]</span>
</span><span id="__span-0-382">            <span class="n">tokens</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">chars</span><span class="p">))</span>
</span><span id="__span-0-383">        <span class="k">if</span> <span class="n">tokens</span> <span class="ow">and</span> <span class="n">tokens</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">bos_token</span><span class="p">:</span>
</span><span id="__span-0-384">            <span class="n">tokens</span> <span class="o">=</span> <span class="n">tokens</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
</span><span id="__span-0-385">        <span class="k">if</span> <span class="n">tokens</span> <span class="ow">and</span> <span class="n">tokens</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">eos_token</span><span class="p">:</span>
</span><span id="__span-0-386">            <span class="n">tokens</span> <span class="o">=</span> <span class="n">tokens</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="__span-0-387">        <span class="n">tokens</span> <span class="o">=</span> <span class="p">[</span><span class="n">token</span> <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">tokens</span> <span class="k">if</span> <span class="n">token</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pad_token</span><span class="p">]</span>
</span><span id="__span-0-388">        <span class="n">sequences</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tokens</span><span class="p">)</span>
</span><span id="__span-0-389">    <span class="k">return</span> <span class="n">sequences</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.transforms.nlp.TokenCharactersIndexer.instance" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">instance</span>


<a href="#formed.integrations.ml.transforms.nlp.TokenCharactersIndexer.instance" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">instance</span><span class="p">(</span><span class="n">tokens</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/transforms/nlp.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-262"><span class="k">def</span><span class="w"> </span><span class="nf">instance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tokens</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="__span-0-263">    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_training</span><span class="p">:</span>
</span><span id="__span-0-264">        <span class="bp">self</span><span class="o">.</span><span class="n">ingest</span><span class="p">(</span><span class="n">tokens</span><span class="p">)</span>
</span><span id="__span-0-265">    <span class="k">return</span> <span class="n">tokens</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.transforms.nlp.TokenCharactersIndexer.train" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">train</span>


<a href="#formed.integrations.ml.transforms.nlp.TokenCharactersIndexer.train" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">train</span><span class="p">()</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Context manager to enable training mode for stateful transformations.</p>
<p>In training mode, transforms can build state (e.g., vocabularies, statistics)
from the training data. Hooks <code>_on_start_training()</code> and <code>_on_end_training()</code>
are called at the beginning and end of the training context.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">YIELDS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-yields-annotation">
                    <code>None</code>
                </span>
            </td>
            <td class="doc-yields-details">
              <div class="doc-md-description">
                <p>None</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span id="__span-0-1"><span class="gp">&gt;&gt;&gt; </span><span class="n">indexer</span> <span class="o">=</span> <span class="n">TokenSequenceIndexer</span><span class="p">()</span>
</span><span id="__span-0-2"><span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">indexer</span><span class="o">.</span><span class="n">train</span><span class="p">():</span>
</span><span id="__span-0-3"><span class="gp">... </span>    <span class="c1"># Build vocabulary from training data</span>
</span><span id="__span-0-4"><span class="gp">... </span>    <span class="n">tokens1</span> <span class="o">=</span> <span class="n">indexer</span><span class="o">.</span><span class="n">instance</span><span class="p">([</span><span class="s2">&quot;hello&quot;</span><span class="p">,</span> <span class="s2">&quot;world&quot;</span><span class="p">])</span>
</span><span id="__span-0-5"><span class="gp">... </span>    <span class="n">tokens2</span> <span class="o">=</span> <span class="n">indexer</span><span class="o">.</span><span class="n">instance</span><span class="p">([</span><span class="s2">&quot;hello&quot;</span><span class="p">,</span> <span class="s2">&quot;there&quot;</span><span class="p">])</span>
</span><span id="__span-0-6"><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Vocabulary is now frozen, use for inference</span>
</span><span id="__span-0-7"><span class="gp">&gt;&gt;&gt; </span><span class="n">test_tokens</span> <span class="o">=</span> <span class="n">indexer</span><span class="o">.</span><span class="n">instance</span><span class="p">([</span><span class="s2">&quot;hello&quot;</span><span class="p">,</span> <span class="s2">&quot;unknown&quot;</span><span class="p">])</span>
</span></code></pre></div>


<details class="note" open>
  <summary>Note</summary>
  <p>Training mode is reentrant but nested calls won't trigger hooks again.</p>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/transforms/base.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-596"><span class="nd">@contextmanager</span>
</span><span id="__span-0-597"><span class="k">def</span><span class="w"> </span><span class="nf">train</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="kc">None</span><span class="p">]:</span>
</span><span id="__span-0-598"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Context manager to enable training mode for stateful transformations.</span>
</span><span id="__span-0-599">
</span><span id="__span-0-600"><span class="sd">    In training mode, transforms can build state (e.g., vocabularies, statistics)</span>
</span><span id="__span-0-601"><span class="sd">    from the training data. Hooks `_on_start_training()` and `_on_end_training()`</span>
</span><span id="__span-0-602"><span class="sd">    are called at the beginning and end of the training context.</span>
</span><span id="__span-0-603">
</span><span id="__span-0-604"><span class="sd">    Yields:</span>
</span><span id="__span-0-605"><span class="sd">        None</span>
</span><span id="__span-0-606">
</span><span id="__span-0-607"><span class="sd">    Examples:</span>
</span><span id="__span-0-608"><span class="sd">        &gt;&gt;&gt; indexer = TokenSequenceIndexer()</span>
</span><span id="__span-0-609"><span class="sd">        &gt;&gt;&gt; with indexer.train():</span>
</span><span id="__span-0-610"><span class="sd">        ...     # Build vocabulary from training data</span>
</span><span id="__span-0-611"><span class="sd">        ...     tokens1 = indexer.instance([&quot;hello&quot;, &quot;world&quot;])</span>
</span><span id="__span-0-612"><span class="sd">        ...     tokens2 = indexer.instance([&quot;hello&quot;, &quot;there&quot;])</span>
</span><span id="__span-0-613"><span class="sd">        &gt;&gt;&gt; # Vocabulary is now frozen, use for inference</span>
</span><span id="__span-0-614"><span class="sd">        &gt;&gt;&gt; test_tokens = indexer.instance([&quot;hello&quot;, &quot;unknown&quot;])</span>
</span><span id="__span-0-615">
</span><span id="__span-0-616"><span class="sd">    Note:</span>
</span><span id="__span-0-617"><span class="sd">        Training mode is reentrant but nested calls won&#39;t trigger hooks again.</span>
</span><span id="__span-0-618">
</span><span id="__span-0-619"><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-620">    <span class="n">original</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_training</span>
</span><span id="__span-0-621">    <span class="bp">self</span><span class="o">.</span><span class="n">_training</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="__span-0-622">    <span class="k">try</span><span class="p">:</span>
</span><span id="__span-0-623">        <span class="k">if</span> <span class="ow">not</span> <span class="n">original</span><span class="p">:</span>
</span><span id="__span-0-624">            <span class="bp">self</span><span class="o">.</span><span class="n">_on_start_training</span><span class="p">()</span>
</span><span id="__span-0-625">        <span class="k">yield</span>
</span><span id="__span-0-626">        <span class="k">if</span> <span class="ow">not</span> <span class="n">original</span><span class="p">:</span>
</span><span id="__span-0-627">            <span class="bp">self</span><span class="o">.</span><span class="n">_on_end_training</span><span class="p">()</span>
</span><span id="__span-0-628">    <span class="k">finally</span><span class="p">:</span>
</span><span id="__span-0-629">        <span class="bp">self</span><span class="o">.</span><span class="n">_training</span> <span class="o">=</span> <span class="n">original</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.transforms.nlp.TokenCharactersIndexer.save" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">save</span>


<a href="#formed.integrations.ml.transforms.nlp.TokenCharactersIndexer.save" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">save</span><span class="p">(</span><span class="n">directory</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Save the transform to a directory using cloudpickle.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>directory</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Directory path to save the transform.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="str">str</span> | <span title="os.PathLike">PathLike</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Note</summary>
  <p>The transform is saved as 'transform.pkl' in the specified directory.
cloudpickle is used to handle complex objects like lambdas and closures.</p>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/transforms/base.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-631"><span class="k">def</span><span class="w"> </span><span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">directory</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">PathLike</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-632"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Save the transform to a directory using cloudpickle.</span>
</span><span id="__span-0-633">
</span><span id="__span-0-634"><span class="sd">    Args:</span>
</span><span id="__span-0-635"><span class="sd">        directory: Directory path to save the transform.</span>
</span><span id="__span-0-636">
</span><span id="__span-0-637"><span class="sd">    Note:</span>
</span><span id="__span-0-638"><span class="sd">        The transform is saved as &#39;transform.pkl&#39; in the specified directory.</span>
</span><span id="__span-0-639"><span class="sd">        cloudpickle is used to handle complex objects like lambdas and closures.</span>
</span><span id="__span-0-640">
</span><span id="__span-0-641"><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-642">    <span class="n">filepath</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">directory</span><span class="p">)</span> <span class="o">/</span> <span class="s2">&quot;transform.pkl&quot;</span>
</span><span id="__span-0-643">    <span class="k">with</span> <span class="n">filepath</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="__span-0-644">        <span class="n">cloudpickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.transforms.nlp.TokenCharactersIndexer.load" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">load</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#formed.integrations.ml.transforms.nlp.TokenCharactersIndexer.load" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">load</span><span class="p">(</span><span class="n">directory</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Load a transform from a directory.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>directory</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Directory path containing the saved transform.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="str">str</span> | <span title="os.PathLike">PathLike</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="typing.Self">Self</span></code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>The loaded transform instance.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RAISES</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
              <span class="doc-raises-annotation">
                  <code><span title="TypeError">TypeError</span></code>
              </span>
            </td>
            <td class="doc-raises-details">
              <div class="doc-md-description">
                <p>If the loaded object is not an instance of this class.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Note</summary>
  <p>Expects a 'transform.pkl' file in the specified directory.</p>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/transforms/base.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-646"><span class="nd">@classmethod</span>
</span><span id="__span-0-647"><span class="k">def</span><span class="w"> </span><span class="nf">load</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">directory</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">PathLike</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
</span><span id="__span-0-648"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Load a transform from a directory.</span>
</span><span id="__span-0-649">
</span><span id="__span-0-650"><span class="sd">    Args:</span>
</span><span id="__span-0-651"><span class="sd">        directory: Directory path containing the saved transform.</span>
</span><span id="__span-0-652">
</span><span id="__span-0-653"><span class="sd">    Returns:</span>
</span><span id="__span-0-654"><span class="sd">        The loaded transform instance.</span>
</span><span id="__span-0-655">
</span><span id="__span-0-656"><span class="sd">    Raises:</span>
</span><span id="__span-0-657"><span class="sd">        TypeError: If the loaded object is not an instance of this class.</span>
</span><span id="__span-0-658">
</span><span id="__span-0-659"><span class="sd">    Note:</span>
</span><span id="__span-0-660"><span class="sd">        Expects a &#39;transform.pkl&#39; file in the specified directory.</span>
</span><span id="__span-0-661">
</span><span id="__span-0-662"><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-663">    <span class="n">filepath</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">directory</span><span class="p">)</span> <span class="o">/</span> <span class="s2">&quot;transform.pkl&quot;</span>
</span><span id="__span-0-664">    <span class="k">with</span> <span class="n">filepath</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="__span-0-665">        <span class="n">obj</span> <span class="o">=</span> <span class="n">cloudpickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</span><span id="__span-0-666">    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="bp">cls</span><span class="p">):</span>
</span><span id="__span-0-667">        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Loaded object is not an instance of </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-0-668">    <span class="k">return</span> <span class="n">obj</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.transforms.nlp.TokenCharactersIndexer.get_index" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">get_index</span>


<a href="#formed.integrations.ml.transforms.nlp.TokenCharactersIndexer.get_index" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">get_index</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Get the index of a token, using unk_token if not found.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/transforms/nlp.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-235"><span class="k">def</span><span class="w"> </span><span class="nf">get_index</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="__span-0-236"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the index of a token, using unk_token if not found.&quot;&quot;&quot;</span>
</span><span id="__span-0-237">    <span class="k">if</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">vocab</span><span class="p">:</span>
</span><span id="__span-0-238">        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">vocab</span><span class="p">[</span><span class="n">value</span><span class="p">]</span>
</span><span id="__span-0-239">    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">unk_token</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-240">        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">vocab</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">unk_token</span><span class="p">]</span>
</span><span id="__span-0-241">    <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.transforms.nlp.TokenCharactersIndexer.get_value" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">get_value</span>


<a href="#formed.integrations.ml.transforms.nlp.TokenCharactersIndexer.get_value" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">get_value</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Get the token corresponding to an index.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/transforms/nlp.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-243"><span class="k">def</span><span class="w"> </span><span class="nf">get_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="__span-0-244"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the token corresponding to an index.&quot;&quot;&quot;</span>
</span><span id="__span-0-245">    <span class="k">if</span> <span class="n">index</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_inverted_vocab</span><span class="p">:</span>
</span><span id="__span-0-246">        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_inverted_vocab</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
</span><span id="__span-0-247">    <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="formed.integrations.ml.transforms.nlp.Tokenizer" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">Tokenizer</span>


<a href="#formed.integrations.ml.transforms.nlp.Tokenizer" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;DataModule&lt;/span&gt; (&lt;code&gt;formed.integrations.ml.transforms.base.DataModule&lt;/code&gt;)" href="#formed.integrations.ml.transforms.base.DataModule">DataModule</a>[<span title="formed.integrations.ml.types.DataModuleModeT">DataModuleModeT</span>, <span title="typing.Union">Union</span>[<span title="str">str</span>, <span title="collections.abc.Sequence">Sequence</span>[<span title="str">str</span>], <span title="formed.integrations.ml.types.AnalyzedText">AnalyzedText</span>], &#39;Tokenizer[AsInstance]&#39;, &#39;Tokenizer[AsBatch]&#39;]</code>, <code><span title="typing.Generic">Generic</span>[<span title="formed.integrations.ml.types.DataModuleModeT">DataModuleModeT</span>]</code></p>



        <p>Complete tokenization pipeline with multiple representation options.</p>
<p>Tokenizer is a DataModule that provides a unified interface for text tokenization
with support for surface forms, part-of-speech tags, and character-level representations.
It accepts raw text, pre-tokenized sequences, or analyzed text and converts them
to indexed representations suitable for neural models.</p>


<table>
      <thead>
        <tr>
          <th>
            <span class="doc-section-title">
              CLASS TYPE PARAMETER
            </span>
          </th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>DataModuleModeT</code>
            </td>
            <td class="doc-type_param-details">
              <div class="doc-md-description">
                <p>Current mode (AsConverter, AsInstance, or AsBatch)</p>
              </div>
              <p>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">ATTRIBUTE</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-attribute&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-attribute-name&quot;&gt;surfaces&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-class-attribute&quot;&gt;&lt;code&gt;class-attribute&lt;/code&gt;&lt;/small&gt;
      &lt;small class=&quot;doc doc-label doc-label-instance-attribute&quot;&gt;&lt;code&gt;instance-attribute&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;formed.integrations.ml.transforms.nlp.Tokenizer.surfaces&lt;/code&gt;)" href="#formed.integrations.ml.transforms.nlp.Tokenizer.surfaces">surfaces</a></code></td>
            <td class="doc-attribute-details">
              <div class="doc-md-description">
                <p>Required token sequence indexer for surface forms (words).</p>
              </div>
              <p>
                  <span class="doc-attribute-annotation">
                    <b>TYPE:</b>
                      <code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;TokenSequenceIndexer&lt;/span&gt; (&lt;code&gt;formed.integrations.ml.transforms.nlp.TokenSequenceIndexer&lt;/code&gt;)" href="#formed.integrations.ml.transforms.nlp.TokenSequenceIndexer">TokenSequenceIndexer</a></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-attribute&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-attribute-name&quot;&gt;postags&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-class-attribute&quot;&gt;&lt;code&gt;class-attribute&lt;/code&gt;&lt;/small&gt;
      &lt;small class=&quot;doc doc-label doc-label-instance-attribute&quot;&gt;&lt;code&gt;instance-attribute&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;formed.integrations.ml.transforms.nlp.Tokenizer.postags&lt;/code&gt;)" href="#formed.integrations.ml.transforms.nlp.Tokenizer.postags">postags</a></code></td>
            <td class="doc-attribute-details">
              <div class="doc-md-description">
                <p>Optional indexer for part-of-speech tags.</p>
              </div>
              <p>
                  <span class="doc-attribute-annotation">
                    <b>TYPE:</b>
                      <code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;Extra&lt;/span&gt; (&lt;code&gt;formed.integrations.ml.transforms.base.Extra&lt;/code&gt;)" href="#formed.integrations.ml.transforms.base.Extra">Extra</a>[<a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;TokenSequenceIndexer&lt;/span&gt; (&lt;code&gt;formed.integrations.ml.transforms.nlp.TokenSequenceIndexer&lt;/code&gt;)" href="#formed.integrations.ml.transforms.nlp.TokenSequenceIndexer">TokenSequenceIndexer</a>]</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-attribute&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-attribute-name&quot;&gt;characters&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-class-attribute&quot;&gt;&lt;code&gt;class-attribute&lt;/code&gt;&lt;/small&gt;
      &lt;small class=&quot;doc doc-label doc-label-instance-attribute&quot;&gt;&lt;code&gt;instance-attribute&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;formed.integrations.ml.transforms.nlp.Tokenizer.characters&lt;/code&gt;)" href="#formed.integrations.ml.transforms.nlp.Tokenizer.characters">characters</a></code></td>
            <td class="doc-attribute-details">
              <div class="doc-md-description">
                <p>Optional character-level indexer for tokens.</p>
              </div>
              <p>
                  <span class="doc-attribute-annotation">
                    <b>TYPE:</b>
                      <code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;Extra&lt;/span&gt; (&lt;code&gt;formed.integrations.ml.transforms.base.Extra&lt;/code&gt;)" href="#formed.integrations.ml.transforms.base.Extra">Extra</a>[<a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;TokenCharactersIndexer&lt;/span&gt; (&lt;code&gt;formed.integrations.ml.transforms.nlp.TokenCharactersIndexer&lt;/code&gt;)" href="#formed.integrations.ml.transforms.nlp.TokenCharactersIndexer">TokenCharactersIndexer</a>]</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-attribute&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-attribute-name&quot;&gt;analyzer&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-class-attribute&quot;&gt;&lt;code&gt;class-attribute&lt;/code&gt;&lt;/small&gt;
      &lt;small class=&quot;doc doc-label doc-label-instance-attribute&quot;&gt;&lt;code&gt;instance-attribute&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;formed.integrations.ml.transforms.nlp.Tokenizer.analyzer&lt;/code&gt;)" href="#formed.integrations.ml.transforms.nlp.Tokenizer.analyzer">analyzer</a></code></td>
            <td class="doc-attribute-details">
              <div class="doc-md-description">
                <p>Optional custom text analyzer/tokenizer function.</p>
              </div>
              <p>
                  <span class="doc-attribute-annotation">
                    <b>TYPE:</b>
                      <code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;Param&lt;/span&gt; (&lt;code&gt;formed.integrations.ml.transforms.base.Param&lt;/code&gt;)" href="#formed.integrations.ml.transforms.base.Param">Param</a>[<span title="collections.abc.Callable">Callable</span>[[<span title="str">str</span> | <span title="collections.abc.Sequence">Sequence</span>[<span title="str">str</span>] | <span title="formed.integrations.ml.types.AnalyzedText">AnalyzedText</span>], <span title="formed.integrations.ml.types.AnalyzedText">AnalyzedText</span>] | None]</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span id="__span-0-1"><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Basic tokenization</span>
</span><span id="__span-0-2"><span class="gp">&gt;&gt;&gt; </span><span class="n">tokenizer</span> <span class="o">=</span> <span class="n">Tokenizer</span><span class="p">(</span>
</span><span id="__span-0-3"><span class="gp">... </span>    <span class="n">surfaces</span><span class="o">=</span><span class="n">TokenSequenceIndexer</span><span class="p">(</span><span class="n">unk_token</span><span class="o">=</span><span class="s2">&quot;&lt;UNK&gt;&quot;</span><span class="p">)</span>
</span><span id="__span-0-4"><span class="gp">... </span><span class="p">)</span>
</span><span id="__span-0-5"><span class="gp">&gt;&gt;&gt;</span>
</span><span id="__span-0-6"><span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">tokenizer</span><span class="o">.</span><span class="n">train</span><span class="p">():</span>
</span><span id="__span-0-7"><span class="gp">... </span>    <span class="n">instance1</span> <span class="o">=</span> <span class="n">tokenizer</span><span class="o">.</span><span class="n">instance</span><span class="p">(</span><span class="s2">&quot;Hello world!&quot;</span><span class="p">)</span>
</span><span id="__span-0-8"><span class="gp">... </span>    <span class="n">instance2</span> <span class="o">=</span> <span class="n">tokenizer</span><span class="o">.</span><span class="n">instance</span><span class="p">([</span><span class="s2">&quot;Hello&quot;</span><span class="p">,</span> <span class="s2">&quot;world&quot;</span><span class="p">,</span> <span class="s2">&quot;!&quot;</span><span class="p">])</span>
</span><span id="__span-0-9"><span class="gp">&gt;&gt;&gt;</span>
</span><span id="__span-0-10"><span class="gp">&gt;&gt;&gt; </span><span class="n">batch</span> <span class="o">=</span> <span class="n">tokenizer</span><span class="o">.</span><span class="n">batch</span><span class="p">([</span><span class="n">instance1</span><span class="p">,</span> <span class="n">instance2</span><span class="p">])</span>
</span><span id="__span-0-11"><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">batch</span><span class="o">.</span><span class="n">surfaces</span><span class="o">.</span><span class="n">ids</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>  <span class="c1"># (2, max_tokens)</span>
</span><span id="__span-0-12"><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">batch</span><span class="o">.</span><span class="n">surfaces</span><span class="o">.</span><span class="n">mask</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>  <span class="c1"># (2, max_tokens)</span>
</span><span id="__span-0-13"><span class="gp">&gt;&gt;&gt;</span>
</span><span id="__span-0-14"><span class="gp">&gt;&gt;&gt; </span><span class="c1"># With POS tags and characters</span>
</span><span id="__span-0-15"><span class="gp">&gt;&gt;&gt; </span><span class="n">tokenizer</span> <span class="o">=</span> <span class="n">Tokenizer</span><span class="p">(</span>
</span><span id="__span-0-16"><span class="gp">... </span>    <span class="n">surfaces</span><span class="o">=</span><span class="n">TokenSequenceIndexer</span><span class="p">(</span><span class="n">unk_token</span><span class="o">=</span><span class="s2">&quot;&lt;UNK&gt;&quot;</span><span class="p">),</span>
</span><span id="__span-0-17"><span class="gp">... </span>    <span class="n">postags</span><span class="o">=</span><span class="n">TokenSequenceIndexer</span><span class="p">(</span><span class="n">unk_token</span><span class="o">=</span><span class="s2">&quot;&lt;UNK-POS&gt;&quot;</span><span class="p">),</span>
</span><span id="__span-0-18"><span class="gp">... </span>    <span class="n">characters</span><span class="o">=</span><span class="n">TokenCharactersIndexer</span><span class="p">()</span>
</span><span id="__span-0-19"><span class="gp">... </span><span class="p">)</span>
</span><span id="__span-0-20"><span class="gp">&gt;&gt;&gt;</span>
</span><span id="__span-0-21"><span class="gp">&gt;&gt;&gt; </span><span class="n">analyzed</span> <span class="o">=</span> <span class="n">AnalyzedText</span><span class="p">(</span>
</span><span id="__span-0-22"><span class="gp">... </span>    <span class="n">surfaces</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Hello&quot;</span><span class="p">,</span> <span class="s2">&quot;world&quot;</span><span class="p">],</span>
</span><span id="__span-0-23"><span class="gp">... </span>    <span class="n">postags</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;INTJ&quot;</span><span class="p">,</span> <span class="s2">&quot;NOUN&quot;</span><span class="p">]</span>
</span><span id="__span-0-24"><span class="gp">... </span><span class="p">)</span>
</span><span id="__span-0-25"><span class="gp">&gt;&gt;&gt; </span><span class="n">instance</span> <span class="o">=</span> <span class="n">tokenizer</span><span class="o">.</span><span class="n">instance</span><span class="p">(</span><span class="n">analyzed</span><span class="p">)</span>
</span><span id="__span-0-26"><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">instance</span><span class="o">.</span><span class="n">surfaces</span><span class="p">)</span>  <span class="c1"># Indexed tokens</span>
</span><span id="__span-0-27"><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">instance</span><span class="o">.</span><span class="n">postags</span><span class="p">)</span>  <span class="c1"># Indexed POS tags</span>
</span><span id="__span-0-28"><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">instance</span><span class="o">.</span><span class="n">characters</span><span class="p">)</span>  <span class="c1"># Character indices</span>
</span></code></pre></div>


<details class="note" open>
  <summary>Note</summary>
  <ul>
<li>Default analyzer uses punkt tokenization for raw strings</li>
<li>Accepts string, token list, or AnalyzedText as input</li>
<li>Extra fields (postags, characters) can be None</li>
<li>All indexers share the same training context</li>
</ul>
</details>










<div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="formed.integrations.ml.transforms.nlp.Tokenizer.surfaces" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">surfaces</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#formed.integrations.ml.transforms.nlp.Tokenizer.surfaces" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="n">surfaces</span> <span class="o">=</span> <span class="n"><span title="dataclasses.field">field</span></span><span class="p">(</span><span class="n"><span title="dataclasses.field(default_factory)">default_factory</span></span><span class="o">=</span><span class="n"><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;TokenSequenceIndexer&lt;/span&gt; (&lt;code&gt;formed.integrations.ml.transforms.nlp.TokenSequenceIndexer&lt;/code&gt;)" href="#formed.integrations.ml.transforms.nlp.TokenSequenceIndexer">TokenSequenceIndexer</a></span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="formed.integrations.ml.transforms.nlp.Tokenizer.postags" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">postags</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#formed.integrations.ml.transforms.nlp.Tokenizer.postags" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="n">postags</span> <span class="o">=</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-method&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-function-name&quot;&gt;default&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-classmethod&quot;&gt;&lt;code&gt;classmethod&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;formed.integrations.ml.transforms.base.Extra.default&lt;/code&gt;)" href="#formed.integrations.ml.transforms.base.Extra.default">default</a></span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="formed.integrations.ml.transforms.nlp.Tokenizer.characters" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">characters</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#formed.integrations.ml.transforms.nlp.Tokenizer.characters" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="n">characters</span> <span class="o">=</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-method&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-function-name&quot;&gt;default&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-classmethod&quot;&gt;&lt;code&gt;classmethod&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;formed.integrations.ml.transforms.base.Extra.default&lt;/code&gt;)" href="#formed.integrations.ml.transforms.base.Extra.default">default</a></span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="formed.integrations.ml.transforms.nlp.Tokenizer.text_vector" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">text_vector</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#formed.integrations.ml.transforms.nlp.Tokenizer.text_vector" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="n">text_vector</span> <span class="o">=</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-method&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-function-name&quot;&gt;default&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-classmethod&quot;&gt;&lt;code&gt;classmethod&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;formed.integrations.ml.transforms.base.Extra.default&lt;/code&gt;)" href="#formed.integrations.ml.transforms.base.Extra.default">default</a></span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="formed.integrations.ml.transforms.nlp.Tokenizer.token_vectors" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">token_vectors</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#formed.integrations.ml.transforms.nlp.Tokenizer.token_vectors" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="n">token_vectors</span> <span class="o">=</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-method&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-function-name&quot;&gt;default&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-classmethod&quot;&gt;&lt;code&gt;classmethod&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;formed.integrations.ml.transforms.base.Extra.default&lt;/code&gt;)" href="#formed.integrations.ml.transforms.base.Extra.default">default</a></span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="formed.integrations.ml.transforms.nlp.Tokenizer.analyzer" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">analyzer</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#formed.integrations.ml.transforms.nlp.Tokenizer.analyzer" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="n">analyzer</span> <span class="o">=</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-method&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-function-name&quot;&gt;default&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-classmethod&quot;&gt;&lt;code&gt;classmethod&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;formed.integrations.ml.transforms.base.Param.default&lt;/code&gt;)" href="#formed.integrations.ml.transforms.base.Param.default">default</a></span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="formed.integrations.ml.transforms.nlp.Tokenizer.accessor" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">accessor</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#formed.integrations.ml.transforms.nlp.Tokenizer.accessor" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="n">accessor</span> <span class="o">=</span> <span class="kc">None</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>




<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.transforms.nlp.Tokenizer.instance" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">instance</span>


<a href="#formed.integrations.ml.transforms.nlp.Tokenizer.instance" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">instance</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/transforms/nlp.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-471"><span class="k">def</span><span class="w"> </span><span class="nf">instance</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="s2">&quot;Tokenizer[AsConverter]&quot;</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="n">AnalyzedText</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Tokenizer[AsInstance]&quot;</span><span class="p">:</span>
</span><span id="__span-0-472">    <span class="n">analyzer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">analyzer</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_default_analyzer</span>
</span><span id="__span-0-473">    <span class="k">return</span> <span class="n">cast</span><span class="p">(</span><span class="n">DataModule</span><span class="p">[</span><span class="n">AsConverter</span><span class="p">],</span> <span class="nb">super</span><span class="p">())</span><span class="o">.</span><span class="n">instance</span><span class="p">(</span><span class="n">analyzer</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.transforms.nlp.Tokenizer.batch" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">batch</span>


<a href="#formed.integrations.ml.transforms.nlp.Tokenizer.batch" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">batch</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Collate multiple instances into a batched representation.</p>
<p>Takes a sequence of raw data or instances and creates a <code>DataModule</code> in
<code>AsBatch</code> mode. Each transform field's <code>batch()</code> method is called to collate
the corresponding field values.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>instances</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Sequence of raw data or <code>DataModule</code> instances.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="collections.abc.Sequence">Sequence</span>[<span title="formed.integrations.ml.transforms.base._T">_T</span> | <span title="formed.integrations.ml.transforms.base._InstanceT">_InstanceT</span>]</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="formed.integrations.ml.transforms.base._BatchT">_BatchT</span></code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>A <code>DataModule</code> in <code>AsBatch</code> mode with batched tensor fields.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span id="__span-0-1"><span class="gp">&gt;&gt;&gt; </span><span class="n">dm</span> <span class="o">=</span> <span class="n">TextDataModule</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="n">Tokenizer</span><span class="p">(),</span> <span class="n">label</span><span class="o">=</span><span class="n">LabelIndexer</span><span class="p">())</span>
</span><span id="__span-0-2"><span class="gp">&gt;&gt;&gt; </span><span class="n">instances</span> <span class="o">=</span> <span class="p">[</span><span class="n">dm</span><span class="o">.</span><span class="n">instance</span><span class="p">(</span><span class="n">ex</span><span class="p">)</span> <span class="k">for</span> <span class="n">ex</span> <span class="ow">in</span> <span class="n">examples</span><span class="p">]</span>
</span><span id="__span-0-3"><span class="gp">&gt;&gt;&gt; </span><span class="n">batch</span> <span class="o">=</span> <span class="n">dm</span><span class="o">.</span><span class="n">batch</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
</span><span id="__span-0-4"><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">batch</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">surfaces</span><span class="o">.</span><span class="n">ids</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>  <span class="c1"># (batch_size, seq_length)</span>
</span><span id="__span-0-5"><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">batch</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>  <span class="c1"># (batch_size,)</span>
</span><span id="__span-0-6"><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">batch</span><span class="p">))</span>  <span class="c1"># batch_size</span>
</span></code></pre></div>


<details class="note" open>
  <summary>Note</summary>
  <ul>
<li>Can only be called in <code>AsConverter</code> mode</li>
<li>Automatically converts raw data to instances if needed</li>
<li>Returns a new <code>DataModule</code> with <code>mode=AsBatch</code></li>
<li>Extra fields are <code>None</code> if all instances have None for that field</li>
</ul>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/transforms/base.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">896</span>
<span class="normal">897</span>
<span class="normal">898</span>
<span class="normal">899</span>
<span class="normal">900</span>
<span class="normal">901</span>
<span class="normal">902</span>
<span class="normal">903</span>
<span class="normal">904</span>
<span class="normal">905</span>
<span class="normal">906</span>
<span class="normal">907</span>
<span class="normal">908</span>
<span class="normal">909</span>
<span class="normal">910</span>
<span class="normal">911</span>
<span class="normal">912</span>
<span class="normal">913</span>
<span class="normal">914</span>
<span class="normal">915</span>
<span class="normal">916</span>
<span class="normal">917</span>
<span class="normal">918</span>
<span class="normal">919</span>
<span class="normal">920</span>
<span class="normal">921</span>
<span class="normal">922</span>
<span class="normal">923</span>
<span class="normal">924</span>
<span class="normal">925</span>
<span class="normal">926</span>
<span class="normal">927</span>
<span class="normal">928</span>
<span class="normal">929</span>
<span class="normal">930</span>
<span class="normal">931</span>
<span class="normal">932</span>
<span class="normal">933</span>
<span class="normal">934</span>
<span class="normal">935</span>
<span class="normal">936</span>
<span class="normal">937</span>
<span class="normal">938</span>
<span class="normal">939</span>
<span class="normal">940</span>
<span class="normal">941</span>
<span class="normal">942</span>
<span class="normal">943</span>
<span class="normal">944</span>
<span class="normal">945</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-896"><span class="k">def</span><span class="w"> </span><span class="nf">batch</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="s2">&quot;DataModule[AsConverter]&quot;</span><span class="p">,</span> <span class="n">instances</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">_T</span> <span class="o">|</span> <span class="n">_InstanceT</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">_BatchT</span><span class="p">:</span>
</span><span id="__span-0-897"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Collate multiple instances into a batched representation.</span>
</span><span id="__span-0-898">
</span><span id="__span-0-899"><span class="sd">    Takes a sequence of raw data or instances and creates a `DataModule` in</span>
</span><span id="__span-0-900"><span class="sd">    `AsBatch` mode. Each transform field&#39;s `batch()` method is called to collate</span>
</span><span id="__span-0-901"><span class="sd">    the corresponding field values.</span>
</span><span id="__span-0-902">
</span><span id="__span-0-903"><span class="sd">    Args:</span>
</span><span id="__span-0-904"><span class="sd">        instances: Sequence of raw data or `DataModule` instances.</span>
</span><span id="__span-0-905">
</span><span id="__span-0-906"><span class="sd">    Returns:</span>
</span><span id="__span-0-907"><span class="sd">        A `DataModule` in `AsBatch` mode with batched tensor fields.</span>
</span><span id="__span-0-908">
</span><span id="__span-0-909"><span class="sd">    Examples:</span>
</span><span id="__span-0-910"><span class="sd">        &gt;&gt;&gt; dm = TextDataModule(text=Tokenizer(), label=LabelIndexer())</span>
</span><span id="__span-0-911"><span class="sd">        &gt;&gt;&gt; instances = [dm.instance(ex) for ex in examples]</span>
</span><span id="__span-0-912"><span class="sd">        &gt;&gt;&gt; batch = dm.batch(instances)</span>
</span><span id="__span-0-913"><span class="sd">        &gt;&gt;&gt; print(batch.text.surfaces.ids.shape)  # (batch_size, seq_length)</span>
</span><span id="__span-0-914"><span class="sd">        &gt;&gt;&gt; print(batch.label.shape)  # (batch_size,)</span>
</span><span id="__span-0-915"><span class="sd">        &gt;&gt;&gt; print(len(batch))  # batch_size</span>
</span><span id="__span-0-916">
</span><span id="__span-0-917"><span class="sd">    Note:</span>
</span><span id="__span-0-918"><span class="sd">        - Can only be called in `AsConverter` mode</span>
</span><span id="__span-0-919"><span class="sd">        - Automatically converts raw data to instances if needed</span>
</span><span id="__span-0-920"><span class="sd">        - Returns a new `DataModule` with `mode=AsBatch`</span>
</span><span id="__span-0-921"><span class="sd">        - Extra fields are `None` if all instances have None for that field</span>
</span><span id="__span-0-922">
</span><span id="__span-0-923"><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-924">    <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">__mode__</span> <span class="ow">in</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">DataModuleMode</span><span class="o">.</span><span class="n">AS_CONVERTER</span><span class="p">),</span> <span class="p">(</span>
</span><span id="__span-0-925">        <span class="s2">&quot;DataModule must be in converter mode to create a batch&quot;</span>
</span><span id="__span-0-926">    <span class="p">)</span>
</span><span id="__span-0-927">
</span><span id="__span-0-928">    <span class="n">instances</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">DataModule</span><span class="p">)</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">instance</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">]</span>
</span><span id="__span-0-929">    <span class="n">fields</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="__span-0-930">    <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">transform</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__field_transforms__</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="__span-0-931">        <span class="n">can_be_optional</span> <span class="o">=</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="n">__get_extra_fields__</span><span class="p">()</span>
</span><span id="__span-0-932">        <span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="nb">getattr</span><span class="p">(</span><span class="n">instance</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span> <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">]</span>
</span><span id="__span-0-933">        <span class="k">if</span> <span class="n">can_be_optional</span> <span class="ow">and</span> <span class="nb">all</span><span class="p">(</span><span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">values</span><span class="p">):</span>
</span><span id="__span-0-934">            <span class="n">fields</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="__span-0-935">        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-936">            <span class="n">fields</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">batch</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
</span><span id="__span-0-937">    <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="n">__get_param_fields__</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="__span-0-938">        <span class="k">if</span> <span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">fields</span><span class="p">:</span>
</span><span id="__span-0-939">            <span class="n">fields</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">_UNAVAILABLE</span>
</span><span id="__span-0-940">
</span><span id="__span-0-941">    <span class="n">batch</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="n">_BatchT</span><span class="p">,</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">fields</span><span class="p">))</span>
</span><span id="__span-0-942">    <span class="nb">setattr</span><span class="p">(</span><span class="n">batch</span><span class="p">,</span> <span class="s2">&quot;__mode__&quot;</span><span class="p">,</span> <span class="n">DataModuleMode</span><span class="o">.</span><span class="n">AS_BATCH</span><span class="p">)</span>
</span><span id="__span-0-943">
</span><span id="__span-0-944">    <span class="n">batch</span><span class="o">.</span><span class="n">_batch_size</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
</span><span id="__span-0-945">    <span class="k">return</span> <span class="n">batch</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.transforms.nlp.Tokenizer.train" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">train</span>


<a href="#formed.integrations.ml.transforms.nlp.Tokenizer.train" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">train</span><span class="p">()</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Context manager to enable training mode for all field transforms.</p>
<p>This propagates training mode to all BaseTransform fields, allowing them
to build state (e.g., vocabularies) from training data.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">YIELDS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-yields-annotation">
                    <code>None</code>
                </span>
            </td>
            <td class="doc-yields-details">
              <div class="doc-md-description">
                <p>None</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span id="__span-0-1"><span class="gp">&gt;&gt;&gt; </span><span class="n">dm</span> <span class="o">=</span> <span class="n">TextDataModule</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="n">Tokenizer</span><span class="p">(),</span> <span class="n">label</span><span class="o">=</span><span class="n">LabelIndexer</span><span class="p">())</span>
</span><span id="__span-0-2"><span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">dm</span><span class="o">.</span><span class="n">train</span><span class="p">():</span>
</span><span id="__span-0-3"><span class="gp">... </span>    <span class="n">instances</span> <span class="o">=</span> <span class="p">[</span><span class="n">dm</span><span class="o">.</span><span class="n">instance</span><span class="p">(</span><span class="n">example</span><span class="p">)</span> <span class="k">for</span> <span class="n">example</span> <span class="ow">in</span> <span class="n">train_data</span><span class="p">]</span>
</span><span id="__span-0-4"><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Vocabularies are now built and frozen</span>
</span></code></pre></div>


<details class="note" open>
  <summary>Note</summary>
  <p>Can only be called in AsConverter mode.</p>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/transforms/base.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span>
<span class="normal">827</span>
<span class="normal">828</span>
<span class="normal">829</span>
<span class="normal">830</span>
<span class="normal">831</span>
<span class="normal">832</span>
<span class="normal">833</span>
<span class="normal">834</span>
<span class="normal">835</span>
<span class="normal">836</span>
<span class="normal">837</span>
<span class="normal">838</span>
<span class="normal">839</span>
<span class="normal">840</span>
<span class="normal">841</span>
<span class="normal">842</span>
<span class="normal">843</span>
<span class="normal">844</span>
<span class="normal">845</span>
<span class="normal">846</span>
<span class="normal">847</span>
<span class="normal">848</span>
<span class="normal">849</span>
<span class="normal">850</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-824"><span class="nd">@contextmanager</span>
</span><span id="__span-0-825"><span class="k">def</span><span class="w"> </span><span class="nf">train</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="kc">None</span><span class="p">]:</span>
</span><span id="__span-0-826"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Context manager to enable training mode for all field transforms.</span>
</span><span id="__span-0-827">
</span><span id="__span-0-828"><span class="sd">    This propagates training mode to all BaseTransform fields, allowing them</span>
</span><span id="__span-0-829"><span class="sd">    to build state (e.g., vocabularies) from training data.</span>
</span><span id="__span-0-830">
</span><span id="__span-0-831"><span class="sd">    Yields:</span>
</span><span id="__span-0-832"><span class="sd">        None</span>
</span><span id="__span-0-833">
</span><span id="__span-0-834"><span class="sd">    Examples:</span>
</span><span id="__span-0-835"><span class="sd">        &gt;&gt;&gt; dm = TextDataModule(text=Tokenizer(), label=LabelIndexer())</span>
</span><span id="__span-0-836"><span class="sd">        &gt;&gt;&gt; with dm.train():</span>
</span><span id="__span-0-837"><span class="sd">        ...     instances = [dm.instance(example) for example in train_data]</span>
</span><span id="__span-0-838"><span class="sd">        &gt;&gt;&gt; # Vocabularies are now built and frozen</span>
</span><span id="__span-0-839">
</span><span id="__span-0-840"><span class="sd">    Note:</span>
</span><span id="__span-0-841"><span class="sd">        Can only be called in AsConverter mode.</span>
</span><span id="__span-0-842">
</span><span id="__span-0-843"><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-844">    <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">__mode__</span> <span class="ow">in</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">DataModuleMode</span><span class="o">.</span><span class="n">AS_CONVERTER</span><span class="p">),</span> <span class="p">(</span>
</span><span id="__span-0-845">        <span class="s2">&quot;DataModule must be in converter mode to enter training mode&quot;</span>
</span><span id="__span-0-846">    <span class="p">)</span>
</span><span id="__span-0-847">    <span class="k">with</span> <span class="n">ExitStack</span><span class="p">()</span> <span class="k">as</span> <span class="n">stack</span><span class="p">:</span>
</span><span id="__span-0-848">        <span class="k">for</span> <span class="n">transform</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__field_transforms__</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
</span><span id="__span-0-849">            <span class="n">stack</span><span class="o">.</span><span class="n">enter_context</span><span class="p">(</span><span class="n">transform</span><span class="o">.</span><span class="n">train</span><span class="p">())</span>
</span><span id="__span-0-850">        <span class="k">yield</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.transforms.nlp.Tokenizer.save" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">save</span>


<a href="#formed.integrations.ml.transforms.nlp.Tokenizer.save" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">save</span><span class="p">(</span><span class="n">directory</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Save the transform to a directory using cloudpickle.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>directory</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Directory path to save the transform.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="str">str</span> | <span title="os.PathLike">PathLike</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Note</summary>
  <p>The transform is saved as 'transform.pkl' in the specified directory.
cloudpickle is used to handle complex objects like lambdas and closures.</p>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/transforms/base.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-631"><span class="k">def</span><span class="w"> </span><span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">directory</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">PathLike</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-632"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Save the transform to a directory using cloudpickle.</span>
</span><span id="__span-0-633">
</span><span id="__span-0-634"><span class="sd">    Args:</span>
</span><span id="__span-0-635"><span class="sd">        directory: Directory path to save the transform.</span>
</span><span id="__span-0-636">
</span><span id="__span-0-637"><span class="sd">    Note:</span>
</span><span id="__span-0-638"><span class="sd">        The transform is saved as &#39;transform.pkl&#39; in the specified directory.</span>
</span><span id="__span-0-639"><span class="sd">        cloudpickle is used to handle complex objects like lambdas and closures.</span>
</span><span id="__span-0-640">
</span><span id="__span-0-641"><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-642">    <span class="n">filepath</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">directory</span><span class="p">)</span> <span class="o">/</span> <span class="s2">&quot;transform.pkl&quot;</span>
</span><span id="__span-0-643">    <span class="k">with</span> <span class="n">filepath</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="__span-0-644">        <span class="n">cloudpickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.transforms.nlp.Tokenizer.load" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">load</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#formed.integrations.ml.transforms.nlp.Tokenizer.load" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">load</span><span class="p">(</span><span class="n">directory</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Load a transform from a directory.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>directory</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Directory path containing the saved transform.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="str">str</span> | <span title="os.PathLike">PathLike</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="typing.Self">Self</span></code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>The loaded transform instance.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RAISES</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
              <span class="doc-raises-annotation">
                  <code><span title="TypeError">TypeError</span></code>
              </span>
            </td>
            <td class="doc-raises-details">
              <div class="doc-md-description">
                <p>If the loaded object is not an instance of this class.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Note</summary>
  <p>Expects a 'transform.pkl' file in the specified directory.</p>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/transforms/base.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-646"><span class="nd">@classmethod</span>
</span><span id="__span-0-647"><span class="k">def</span><span class="w"> </span><span class="nf">load</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">directory</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">PathLike</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
</span><span id="__span-0-648"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Load a transform from a directory.</span>
</span><span id="__span-0-649">
</span><span id="__span-0-650"><span class="sd">    Args:</span>
</span><span id="__span-0-651"><span class="sd">        directory: Directory path containing the saved transform.</span>
</span><span id="__span-0-652">
</span><span id="__span-0-653"><span class="sd">    Returns:</span>
</span><span id="__span-0-654"><span class="sd">        The loaded transform instance.</span>
</span><span id="__span-0-655">
</span><span id="__span-0-656"><span class="sd">    Raises:</span>
</span><span id="__span-0-657"><span class="sd">        TypeError: If the loaded object is not an instance of this class.</span>
</span><span id="__span-0-658">
</span><span id="__span-0-659"><span class="sd">    Note:</span>
</span><span id="__span-0-660"><span class="sd">        Expects a &#39;transform.pkl&#39; file in the specified directory.</span>
</span><span id="__span-0-661">
</span><span id="__span-0-662"><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-663">    <span class="n">filepath</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">directory</span><span class="p">)</span> <span class="o">/</span> <span class="s2">&quot;transform.pkl&quot;</span>
</span><span id="__span-0-664">    <span class="k">with</span> <span class="n">filepath</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="__span-0-665">        <span class="n">obj</span> <span class="o">=</span> <span class="n">cloudpickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</span><span id="__span-0-666">    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="bp">cls</span><span class="p">):</span>
</span><span id="__span-0-667">        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Loaded object is not an instance of </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-0-668">    <span class="k">return</span> <span class="n">obj</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="formed.integrations.ml.workflow" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">formed.integrations.ml.workflow</span>


<a href="#formed.integrations.ml.workflow" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents first">

        <p>Workflow steps for machine learning data module integration.</p>
<p>This module provides workflow steps for training data modules and generating
instances for machine learning tasks.</p>


<details class="available-steps" open>
  <summary>Available Steps</summary>
  <ul>
<li><code>ml::train_datamodule</code>: Train a data module on a dataset.</li>
<li><code>ml::train_datamodule_with_instances</code>: Train a data module and collect generated instances.</li>
<li><code>ml::generate_instances</code>: Generate instances from a dataset using a data module.</li>
<li><code>ml::generate_instances_without_caching</code>: Generate instances without caching (same as <code>ml::generate_instances</code> but uncached).</li>
</ul>
</details>









<div class="doc doc-children">









<div class="doc doc-object doc-class">



<h3 id="formed.integrations.ml.workflow.DataModuleAndInstances" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">DataModuleAndInstances</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

<a href="#formed.integrations.ml.workflow.DataModuleAndInstances" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">DataModuleAndInstances</span><span class="p">(</span><span class="n">datamodule</span><span class="p">,</span> <span class="n">instances</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="typing.Generic">Generic</span>[<span title="formed.integrations.ml.workflow._InputT">_InputT</span>, <span title="formed.integrations.ml.workflow._InstanceT">_InstanceT</span>]</code></p>













<div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="formed.integrations.ml.workflow.DataModuleAndInstances.datamodule" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">datamodule</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#formed.integrations.ml.workflow.DataModuleAndInstances.datamodule" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="n">datamodule</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="formed.integrations.ml.workflow.DataModuleAndInstances.instances" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">instances</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#formed.integrations.ml.workflow.DataModuleAndInstances.instances" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="n">instances</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>






  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="formed.integrations.ml.workflow.DataModuleAndInstancesFormat" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">DataModuleAndInstancesFormat</span>


<a href="#formed.integrations.ml.workflow.DataModuleAndInstancesFormat" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;Format&lt;/span&gt; (&lt;code&gt;formed.workflow.format.Format&lt;/code&gt;)" href="../../workflow/#formed.workflow.format.Format">Format</a>[<a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;DataModuleAndInstances&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;formed.integrations.ml.workflow.DataModuleAndInstances&lt;/code&gt;)" href="#formed.integrations.ml.workflow.DataModuleAndInstances">DataModuleAndInstances</a>[<span title="formed.integrations.ml.workflow._InputT">_InputT</span>, <span title="formed.integrations.ml.workflow._InstanceT">_InstanceT</span>]]</code>, <code><span title="typing.Generic">Generic</span>[<span title="formed.integrations.ml.workflow._InputT">_InputT</span>, <span title="formed.integrations.ml.workflow._InstanceT">_InstanceT</span>]</code></p>













<div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="formed.integrations.ml.workflow.DataModuleAndInstancesFormat.identifier" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">identifier</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#formed.integrations.ml.workflow.DataModuleAndInstancesFormat.identifier" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="n">identifier</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Get the unique identifier for this format.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="str">str</span></code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>Format identifier string.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>




<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.workflow.DataModuleAndInstancesFormat.write" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">write</span>


<a href="#formed.integrations.ml.workflow.DataModuleAndInstancesFormat.write" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">write</span><span class="p">(</span><span class="n">artifact</span><span class="p">,</span> <span class="n">directory</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/workflow.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-47"><span class="k">def</span><span class="w"> </span><span class="nf">write</span><span class="p">(</span>
</span><span id="__span-0-48">    <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-49">    <span class="n">artifact</span><span class="p">:</span> <span class="n">DataModuleAndInstances</span><span class="p">[</span><span class="n">_InputT</span><span class="p">,</span> <span class="n">_InstanceT</span><span class="p">],</span>
</span><span id="__span-0-50">    <span class="n">directory</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span>
</span><span id="__span-0-51"><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-52">    <span class="n">instances_path</span> <span class="o">=</span> <span class="n">directory</span> <span class="o">/</span> <span class="s2">&quot;instances&quot;</span>
</span><span id="__span-0-53">    <span class="n">datamodule_path</span> <span class="o">=</span> <span class="n">directory</span> <span class="o">/</span> <span class="s2">&quot;datamodule&quot;</span>
</span><span id="__span-0-54">
</span><span id="__span-0-55">    <span class="n">instances_path</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-0-56">    <span class="n">datamodule_path</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-0-57">
</span><span id="__span-0-58">    <span class="bp">self</span><span class="o">.</span><span class="n">_INSTANCES_FORMAT</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">artifact</span><span class="o">.</span><span class="n">instances</span><span class="p">,</span> <span class="n">instances_path</span><span class="p">)</span>
</span><span id="__span-0-59">    <span class="bp">self</span><span class="o">.</span><span class="n">_DATAMODULE_FORMAT</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">artifact</span><span class="o">.</span><span class="n">datamodule</span><span class="p">,</span> <span class="n">datamodule_path</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.workflow.DataModuleAndInstancesFormat.read" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">read</span>


<a href="#formed.integrations.ml.workflow.DataModuleAndInstancesFormat.read" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">read</span><span class="p">(</span><span class="n">directory</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/workflow.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-61"><span class="k">def</span><span class="w"> </span><span class="nf">read</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">directory</span><span class="p">:</span> <span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataModuleAndInstances</span><span class="p">[</span><span class="n">_InputT</span><span class="p">,</span> <span class="n">_InstanceT</span><span class="p">]:</span>
</span><span id="__span-0-62">    <span class="n">instances_path</span> <span class="o">=</span> <span class="n">directory</span> <span class="o">/</span> <span class="s2">&quot;instances&quot;</span>
</span><span id="__span-0-63">    <span class="n">datamodule_path</span> <span class="o">=</span> <span class="n">directory</span> <span class="o">/</span> <span class="s2">&quot;datamodule&quot;</span>
</span><span id="__span-0-64">
</span><span id="__span-0-65">    <span class="n">instances</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_INSTANCES_FORMAT</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">instances_path</span><span class="p">)</span>
</span><span id="__span-0-66">    <span class="n">datamodule</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_DATAMODULE_FORMAT</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">datamodule_path</span><span class="p">)</span>
</span><span id="__span-0-67">
</span><span id="__span-0-68">    <span class="k">return</span> <span class="n">DataModuleAndInstances</span><span class="p">(</span><span class="n">datamodule</span><span class="o">=</span><span class="n">datamodule</span><span class="p">,</span> <span class="n">instances</span><span class="o">=</span><span class="n">instances</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="formed.integrations.ml.workflow.DataModuleAndInstancesFormat.is_default_of" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">is_default_of</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#formed.integrations.ml.workflow.DataModuleAndInstancesFormat.is_default_of" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">is_default_of</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Check if this format is the default for the given object type.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>obj</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Object to check.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="typing.Any">Any</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="bool">bool</span></code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>True if this format should be used by default for this type.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/workflow/format.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-101"><span class="nd">@classmethod</span>
</span><span id="__span-0-102"><span class="k">def</span><span class="w"> </span><span class="nf">is_default_of</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">obj</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="__span-0-103"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Check if this format is the default for the given object type.</span>
</span><span id="__span-0-104">
</span><span id="__span-0-105"><span class="sd">    Args:</span>
</span><span id="__span-0-106"><span class="sd">        obj: Object to check.</span>
</span><span id="__span-0-107">
</span><span id="__span-0-108"><span class="sd">    Returns:</span>
</span><span id="__span-0-109"><span class="sd">        True if this format should be used by default for this type.</span>
</span><span id="__span-0-110">
</span><span id="__span-0-111"><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-112">    <span class="k">return</span> <span class="kc">False</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h3 id="formed.integrations.ml.workflow.train_datamodule" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">train_datamodule</span>


<a href="#formed.integrations.ml.workflow.train_datamodule" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">train_datamodule</span><span class="p">(</span><span class="n">datamodule</span><span class="p">,</span> <span class="n">dataset</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Train a data module on a dataset.</p>
<p>This step trains a DataModule on the provided dataset, allowing it to
learn transformations and build vocabularies.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>datamodule</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>DataModule to train.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;DataModule&lt;/span&gt; (&lt;code&gt;formed.integrations.ml.transforms.DataModule&lt;/code&gt;)" href="#formed.integrations.ml.transforms.base.DataModule">DataModule</a>[<span title="formed.integrations.ml.types.AsConverter">AsConverter</span>, <span title="formed.integrations.ml.workflow._InputT">_InputT</span>]</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dataset</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Training dataset.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="collections.abc.Iterable">Iterable</span>[<span title="formed.integrations.ml.workflow._InputT">_InputT</span>]</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;DataModule&lt;/span&gt; (&lt;code&gt;formed.integrations.ml.transforms.DataModule&lt;/code&gt;)" href="#formed.integrations.ml.transforms.base.DataModule">DataModule</a>[<span title="formed.integrations.ml.types.AsConverter">AsConverter</span>, <span title="formed.integrations.ml.workflow._InputT">_InputT</span>]</code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>Trained DataModule.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/workflow.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-71"><span class="nd">@step</span><span class="p">(</span><span class="s2">&quot;ml::train_datamodule&quot;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;json&quot;</span><span class="p">)</span>
</span><span id="__span-0-72"><span class="k">def</span><span class="w"> </span><span class="nf">train_datamodule</span><span class="p">(</span>
</span><span id="__span-0-73">    <span class="n">datamodule</span><span class="p">:</span> <span class="n">DataModule</span><span class="p">[</span><span class="n">AsConverter</span><span class="p">,</span> <span class="n">_InputT</span><span class="p">],</span>
</span><span id="__span-0-74">    <span class="n">dataset</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">_InputT</span><span class="p">],</span>
</span><span id="__span-0-75"><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataModule</span><span class="p">[</span><span class="n">AsConverter</span><span class="p">,</span> <span class="n">_InputT</span><span class="p">]:</span>
</span><span id="__span-0-76"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Train a data module on a dataset.</span>
</span><span id="__span-0-77">
</span><span id="__span-0-78"><span class="sd">    This step trains a DataModule on the provided dataset, allowing it to</span>
</span><span id="__span-0-79"><span class="sd">    learn transformations and build vocabularies.</span>
</span><span id="__span-0-80">
</span><span id="__span-0-81"><span class="sd">    Args:</span>
</span><span id="__span-0-82"><span class="sd">        datamodule: DataModule to train.</span>
</span><span id="__span-0-83"><span class="sd">        dataset: Training dataset.</span>
</span><span id="__span-0-84">
</span><span id="__span-0-85"><span class="sd">    Returns:</span>
</span><span id="__span-0-86"><span class="sd">        Trained DataModule.</span>
</span><span id="__span-0-87"><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-88">    <span class="k">with</span> <span class="n">datamodule</span><span class="o">.</span><span class="n">train</span><span class="p">(),</span> <span class="n">progress</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="s2">&quot;Training datamodule&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">dataset</span><span class="p">:</span>
</span><span id="__span-0-89">        <span class="k">for</span> <span class="n">example</span> <span class="ow">in</span> <span class="n">dataset</span><span class="p">:</span>
</span><span id="__span-0-90">            <span class="n">datamodule</span><span class="p">(</span><span class="n">example</span><span class="p">)</span>
</span><span id="__span-0-91">    <span class="k">return</span> <span class="n">datamodule</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="formed.integrations.ml.workflow.train_datamodule_with_instances" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">train_datamodule_with_instances</span>


<a href="#formed.integrations.ml.workflow.train_datamodule_with_instances" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">train_datamodule_with_instances</span><span class="p">(</span><span class="n">datamodule</span><span class="p">,</span> <span class="n">dataset</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Train a data module and collect generated instances.</p>
<p>This step trains a DataModule while collecting all instances generated
during training, returning both the trained module and instances.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>datamodule</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>DataModule to train.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;DataModule&lt;/span&gt; (&lt;code&gt;formed.integrations.ml.transforms.DataModule&lt;/code&gt;)" href="#formed.integrations.ml.transforms.base.DataModule">DataModule</a>[<span title="formed.integrations.ml.types.AsConverter">AsConverter</span>, <span title="formed.integrations.ml.workflow._InputT">_InputT</span>, <span title="formed.integrations.ml.workflow._InstanceT">_InstanceT</span>]</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dataset</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Training dataset.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="collections.abc.Iterable">Iterable</span>[<span title="formed.integrations.ml.workflow._InputT">_InputT</span>]</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;DataModuleAndInstances&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;formed.integrations.ml.workflow.DataModuleAndInstances&lt;/code&gt;)" href="#formed.integrations.ml.workflow.DataModuleAndInstances">DataModuleAndInstances</a>[<span title="formed.integrations.ml.workflow._InputT">_InputT</span>, <span title="formed.integrations.ml.workflow._InstanceT">_InstanceT</span>]</code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>DataModuleAndInstances containing the trained module and generated instances.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/workflow.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-94"><span class="nd">@step</span><span class="p">(</span><span class="s2">&quot;ml::train_datamodule_with_instances&quot;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="n">DataModuleAndInstancesFormat</span><span class="p">())</span>
</span><span id="__span-0-95"><span class="k">def</span><span class="w"> </span><span class="nf">train_datamodule_with_instances</span><span class="p">(</span>
</span><span id="__span-0-96">    <span class="n">datamodule</span><span class="p">:</span> <span class="n">DataModule</span><span class="p">[</span><span class="n">AsConverter</span><span class="p">,</span> <span class="n">_InputT</span><span class="p">,</span> <span class="n">_InstanceT</span><span class="p">],</span>
</span><span id="__span-0-97">    <span class="n">dataset</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">_InputT</span><span class="p">],</span>
</span><span id="__span-0-98"><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataModuleAndInstances</span><span class="p">[</span><span class="n">_InputT</span><span class="p">,</span> <span class="n">_InstanceT</span><span class="p">]:</span>
</span><span id="__span-0-99"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Train a data module and collect generated instances.</span>
</span><span id="__span-0-100">
</span><span id="__span-0-101"><span class="sd">    This step trains a DataModule while collecting all instances generated</span>
</span><span id="__span-0-102"><span class="sd">    during training, returning both the trained module and instances.</span>
</span><span id="__span-0-103">
</span><span id="__span-0-104"><span class="sd">    Args:</span>
</span><span id="__span-0-105"><span class="sd">        datamodule: DataModule to train.</span>
</span><span id="__span-0-106"><span class="sd">        dataset: Training dataset.</span>
</span><span id="__span-0-107">
</span><span id="__span-0-108"><span class="sd">    Returns:</span>
</span><span id="__span-0-109"><span class="sd">        DataModuleAndInstances containing the trained module and generated instances.</span>
</span><span id="__span-0-110"><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-111">
</span><span id="__span-0-112">    <span class="k">def</span><span class="w"> </span><span class="nf">generate_instances</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">_InstanceT</span><span class="p">]:</span>
</span><span id="__span-0-113">        <span class="k">nonlocal</span> <span class="n">datamodule</span><span class="p">,</span> <span class="n">dataset</span>
</span><span id="__span-0-114">
</span><span id="__span-0-115">        <span class="k">with</span> <span class="n">datamodule</span><span class="o">.</span><span class="n">train</span><span class="p">(),</span> <span class="n">progress</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="s2">&quot;Training datamodule&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">dataset</span><span class="p">:</span>
</span><span id="__span-0-116">            <span class="k">for</span> <span class="n">example</span> <span class="ow">in</span> <span class="n">dataset</span><span class="p">:</span>
</span><span id="__span-0-117">                <span class="n">instance</span> <span class="o">=</span> <span class="n">datamodule</span><span class="p">(</span><span class="n">example</span><span class="p">)</span>
</span><span id="__span-0-118">                <span class="k">assert</span> <span class="n">instance</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</span><span id="__span-0-119">                <span class="k">yield</span> <span class="n">instance</span>
</span><span id="__span-0-120">
</span><span id="__span-0-121">    <span class="k">return</span> <span class="n">DataModuleAndInstances</span><span class="p">(</span><span class="n">datamodule</span><span class="o">=</span><span class="n">datamodule</span><span class="p">,</span> <span class="n">instances</span><span class="o">=</span><span class="n">generate_instances</span><span class="p">())</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="formed.integrations.ml.workflow.generate_instances" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">generate_instances</span>


<a href="#formed.integrations.ml.workflow.generate_instances" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><span class="nf">generate_instances</span><span class="p">(</span><span class="n">datamodule</span><span class="p">,</span> <span class="n">dataset</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Generate instances from a dataset using a data module.</p>
<p>This step applies a DataModule to each example in the dataset,
generating processed instances.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>datamodule</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>DataModule to use for instance generation.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;DataModule&lt;/span&gt; (&lt;code&gt;formed.integrations.ml.transforms.DataModule&lt;/code&gt;)" href="#formed.integrations.ml.transforms.base.DataModule">DataModule</a>[<span title="formed.integrations.ml.types.AsConverter">AsConverter</span>, <span title="formed.integrations.ml.workflow._InputT">_InputT</span>, <span title="formed.integrations.ml.workflow._InstanceT">_InstanceT</span>]</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dataset</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Input dataset.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="collections.abc.Iterable">Iterable</span>[<span title="formed.integrations.ml.workflow._InputT">_InputT</span>]</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="formed.common.dataset.Dataset">Dataset</span>[<span title="formed.integrations.ml.workflow._InstanceT">_InstanceT</span>]</code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>Dataset of generated instances.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/formed/integrations/ml/workflow.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-124"><span class="nd">@step</span><span class="p">(</span><span class="s2">&quot;ml::generate_instances&quot;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;dataset&quot;</span><span class="p">)</span>
</span><span id="__span-0-125"><span class="nd">@step</span><span class="p">(</span><span class="s2">&quot;ml::generate_instances_without_caching&quot;</span><span class="p">,</span> <span class="n">cacheable</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="__span-0-126"><span class="k">def</span><span class="w"> </span><span class="nf">generate_instances</span><span class="p">(</span>
</span><span id="__span-0-127">    <span class="n">datamodule</span><span class="p">:</span> <span class="n">DataModule</span><span class="p">[</span><span class="n">AsConverter</span><span class="p">,</span> <span class="n">_InputT</span><span class="p">,</span> <span class="n">_InstanceT</span><span class="p">],</span>
</span><span id="__span-0-128">    <span class="n">dataset</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">_InputT</span><span class="p">],</span>
</span><span id="__span-0-129"><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dataset</span><span class="p">[</span><span class="n">_InstanceT</span><span class="p">]:</span>
</span><span id="__span-0-130"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Generate instances from a dataset using a data module.</span>
</span><span id="__span-0-131">
</span><span id="__span-0-132"><span class="sd">    This step applies a DataModule to each example in the dataset,</span>
</span><span id="__span-0-133"><span class="sd">    generating processed instances.</span>
</span><span id="__span-0-134">
</span><span id="__span-0-135"><span class="sd">    Args:</span>
</span><span id="__span-0-136"><span class="sd">        datamodule: DataModule to use for instance generation.</span>
</span><span id="__span-0-137"><span class="sd">        dataset: Input dataset.</span>
</span><span id="__span-0-138">
</span><span id="__span-0-139"><span class="sd">    Returns:</span>
</span><span id="__span-0-140"><span class="sd">        Dataset of generated instances.</span>
</span><span id="__span-0-141"><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-142">
</span><span id="__span-0-143">    <span class="k">def</span><span class="w"> </span><span class="nf">generator</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">_InstanceT</span><span class="p">]:</span>
</span><span id="__span-0-144">        <span class="k">nonlocal</span> <span class="n">datamodule</span><span class="p">,</span> <span class="n">dataset</span>
</span><span id="__span-0-145">        <span class="k">with</span> <span class="n">progress</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="s2">&quot;Generating instances&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">dataset</span><span class="p">:</span>
</span><span id="__span-0-146">            <span class="k">for</span> <span class="n">example</span> <span class="ow">in</span> <span class="n">dataset</span><span class="p">:</span>
</span><span id="__span-0-147">                <span class="n">instance</span> <span class="o">=</span> <span class="n">datamodule</span><span class="p">(</span><span class="n">example</span><span class="p">)</span>
</span><span id="__span-0-148">                <span class="k">assert</span> <span class="n">instance</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</span><span id="__span-0-149">                <span class="k">yield</span> <span class="n">instance</span>
</span><span id="__span-0-150">
</span><span id="__span-0-151">    <span class="k">return</span> <span class="n">Dataset</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">(</span><span class="n">generator</span><span class="p">())</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../../..", "features": ["content.code.copy", "content.tabs.link", "content.tooltips", "navigation.tabs", "navigation.tabs.sticky", "search.highlight", "toc.follow"], "search": "../../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
    
  </body>
</html>